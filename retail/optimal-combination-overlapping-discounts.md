---
title: "Determine la combinación óptima de superponer descuentos"
description: "Cuando los descuentos se superponen, debe determinar la combinación de superponer los descuentos que generarán el total más bajo de la transacción o el descuento total más alto. Cuando el importe de descuento varía en función del precio de los productos que se han comprado, por ejemplo de la compra “común 1, recoger el 1 por ciento” X () BOGO de descuento al por menor, este proceso realiza una aplicación la optimización combinatoria."
author: kfend
manager: AnnBe
ms.date: 04/04/2017
ms.topic: article
ms.prod: 
ms.service: Dynamics365Operations
ms.technology: 
audience: Application User, IT Pro
ms.reviewer: kfend
ms.search.scope: AX 7.0.0, Operations, Core
ms.custom: 89643
ms.assetid: 09843c9a-3e19-4e4a-a8ce-80650f2095f9
ms.search.region: global
ms.search.industry: Retail
ms.author: kfend
ms.search.validFrom: 2016-05-31
ms.dyn365.ops.version: AX 7.0.1
translationtype: Human Translation
ms.sourcegitcommit: 0c6a7bdc4ba82dd57ab3e395e6dfb0ae4de31fc4
ms.openlocfilehash: 31e5104045ed5b8fbfa3677a7f5702d551de4231
ms.lasthandoff: 03/31/2017


---

# <a name="determine-the-optimal-combination-of-overlapping-discounts"></a>Determine la combinación óptima de superponer descuentos

Cuando los descuentos se superponen, debe determinar la combinación de superponer los descuentos que generarán el total más bajo de la transacción o el descuento total más alto. Cuando el importe de descuento varía en función del precio de los productos que se han comprado, por ejemplo de la compra “común 1, recoger el 1 por ciento” X () BOGO de descuento al por menor, este proceso realiza una aplicación la optimización combinatoria.

Este artículo se aplica a Microsoft Dynamics AX 2012 R3 con 3105973 KB (liberado el 2 de noviembre de 2015) o posterior, y que se debe liberar de febrero de 2016 de Microsoft Dynamics AX. Para determinar la combinación que superponía descuentos para aplicar en el tiempo, y para continuar proporcionando la funcionalidad de descuento rica que está disponible en Microsoft Dynamics AX for Retail, hemos introducido un método para los descuentos que solapaban que aplicaban. Denominamos este nuevo método ** clasificación de valor marginal **. Se usa la clasificación de valor marginal cuando el tiempo necesario para evaluar las combinaciones posibles de superponer descuentos supera un umbral configurable ** en los parámetros de ventas ** la página en Dynamics AX. En el método de la clasificación de valor marginal, un valor se calcula para cada descuento que se superpone usando el valor del descuento en los productos compartidos. Los descuentos superpuestos se aplican relativo del valor más alto relativo al valor más bajo. Para obtener más información sobre el nuevo método, consulte la sección “valor marginal”, más adelante en este artículo. Clasificación de valor marginal no se usa cuando los importes de descuento para un producto no se ven afectados por otro producto en la transacción. Por ejemplo, este método no se usa para dos descuentos simples, o para un descuento simple y un único descuento de cantidad de producto.

## <a name="discount-examples"></a>Entre el descuento
En Dynamics AX, puede crear un número ilimitado de descuentos al por menor en un conjunto de existencias de productos. Sin embargo, dado que no hay límite, pueden producirse problemas de rendimiento cuando intenta para calcular los descuentos que se deben usar en los diversos productos. Los ejemplos siguientes muestran este problema con más detalle. En el ejemplo 1, comenzamos con dos productos y dos descuentos que se superponen. A continuación, en el ejemplo 2, mostramos cómo el problema se desarrolla mientras se agregan más productos.

### <a name="example-1-two-products-and-two-discounts"></a>Ejemplo 1: Dos productos y dos descuentos

En este ejemplo, dos productos se requieren para tener derecho a cada descuento, los descuentos y no se pueden combinar. Los descuentos en este ejemplo son ** el mejor precio ** descuentos. Ambos productos pueden usar ambos descuentos. Aquí hay los dos descuentos. [![que se superpone con la combinación de descuento 01] (. /media/overlapping-discount-combo-01.jpg])(. /media/overlapping-discount-combo-01.jpg) Para los dos productos, Preferentemente de estos dos descuentos depende de los precios de los dos productos. Cuando el precio de ambos productos es igual o casi igual, el descuento es 1 mejores resultados. Cuando el precio de un producto es significativamente menos que el precio de otro producto, el descuento es 2 mejores resultados. A continuación se indica la regla matemática para evaluar estos dos descuentos respecto a la otra: [![que se superpone con la combinación de descuento 02] (. /media/overlapping-discount-combo-02.jpg])(. Nota de /media/overlapping-discount-combo-02.jpg) cuando el precio del producto 1 es igual a dos tercios de precio del producto 2, los dos descuentos es igual. En este ejemplo, el porcentaje de descuento efectivo para el descuento 1 varía de algún por ciento (cuando los precios de los dos productos están separados lejano) a un máximo de 25 por ciento (cuando los dos productos tienen el mismo precio). El porcentaje de descuento efectivo para el descuento 2 se fija. Siempre es el 20 por ciento. Dado que el porcentaje de descuento efectivo para el descuento 1 tiene un intervalo que puede ser superior a o menos que el descuento 2, Preferentemente descuento depende de los precios de los dos productos que se deben descontados. En este ejemplo, el cálculo se completa rápidamente, ya que sólo dos descuentos se aplican en sólo dos productos. Sólo hay dos combinaciones posibles: una aplicación de la solicitud de descuento 1 o uno de descuento 2. No hay permutaciones a calcular. El valor de cada descuento se calcula mediante ambos productos, y se usa el mejor descuento.

### <a name="example-2-four-products-and-two-discounts"></a>Ejemplo 2: Cuatro productos y dos descuentos

A continuación, utilizaremos cuatro productos y los mismos dos descuentos. Los cuatro productos pueden usar ambos descuentos. Existen doce combinaciones posibles. Al final, dos descuentos se aplicarán a la transacción en una de tres combinaciones: dos usos del descuento 1, dos usos de la aplicación de descuento 2, o uno de la solicitud de descuento 1 y una de descuento 2. Para mostrar las combinaciones posibles, miraremos a dos los distintos conjuntos de cuatro productos con diferentes precios:

-   Los cuatro productos tienen el mismo precio, $15.00. En este caso, la mejor combinación del descuento es dos usos del descuento 1. Dos productos se completa, precio y dos se el 50 por ciento libre. El total descontado de la transacción es $45 (15 + 15 + 7.50 + 7.50), que es $15 (el 25 por ciento) del total de undiscounted de. El descuento es 2 ($12 sólo el 20 por ciento).
-   Dos productos se $20 cada uno, un producto es $15, y un producto es €. En este caso, la mejor combinación de descuento es una aplicación de la solicitud de descuento 2 y una de descuento 1. En las siguientes tablas se muestran los descuentos.

Para leer las tablas, utilice un producto de una fila y un producto de una columna. Por ejemplo, en la tabla para el descuento 1, cuando se combina los dos $20 productos, se bajo de $10. En la tabla para el descuento 2, cuando se combina el producto $15 y el producto €, se $4 de baja. [![que se superpone con la combinación de descuento 03] (. /media/overlapping-discount-combo-03.jpg])(. /media/overlapping-discount-combo-03.jpg), Primero encontramos el descuento mayor que está disponible desde dos productos mediante cualquier descuento. Las dos tablas muestran el importe de descuento para todas las combinaciones de los dos productos. Las partes sombreado de las tablas representan los casos en los que un producto se consigo empareja mismo, que no podemos hacer, o un emparejamiento de reserva dos productos que genere el mismo importe de descuento y puede ignorar. Mirando las tablas, puede ver dicho descuento 1 para los dos $20 artículos es el descuento mayor que está disponible para los descuentos en los cuatro productos. El descuento (queda resaltado en verde en la primera tabla.) Dicho permite sólo el producto $15 y el producto €. Mirando las dos tablas de nuevo, puede ver dicho, para estos dos productos, el descuento 1 proporciona un descuento $2.50, mientras que el descuento 2 proporciona un descuento $4. Por lo tanto, seleccione el descuento 2. El descuento total se $14. Para crear la discusión más fácil visualizar, aquí es dos tablas adicionales que muestran el porcentaje de descuento efectivo para todas las combinaciones posibles de dos producto para el descuento 1 y el descuento 2. Únicamente la mitad de la lista de combinaciones se incluye, ya que, para estos dos descuentos, el orden en el que los dos productos se colocan en el descuento no importar. El descuento efectivo más alto (el 25 por ciento) queda resaltado en verde, y el descuento efectivo inferior (el 10 por ciento) queda resaltado en rojo. [![que se superpone con la combinación de descuento 04] (. /media/overlapping-discount-combo-04.jpg])(. /media/overlapping-discount-combo-04.jpg) ** nota: ** Cuando los precios varían, y compiten dos o más descuentos, la única forma de garantizar la mejor combinación de descuentos consiste en evaluar ambos descuentos y compararlos.

## <a name="total-possible-combinations"></a>Posibles combinaciones totales
Esta sección continúa el ejemplo de la sección anterior. Agregaremos más productos y otro descuento, y consultamos cuántas combinaciones deben calcularse y ser comparadas. En la tabla siguiente se muestra el número de combinaciones posibles de descuento como la cantidad de producto incrementa. En la siguiente tabla se muestran ambos lo que sucede cuando hay dos descuentos que se superponen, como en el ejemplo anterior, y si hay tres descuentos que se superponen. El número de combinaciones posibles de descuento que se deben evaluadas pronto supera lo que incluso puede calcular y comparar un equipo rápido rápidamente en lugar para ser aceptable para las transacciones comerciales. [![que se superpone con la combinación de descuento 05] (. /media/overlapping-discount-combo-05.jpg])(. /media/overlapping-discount-combo-05.jpg) Incluso cuando se aplican las cantidades mayores o más descuentos que se superponen, el número total de combinaciones posibles de descuento especifica rápidamente millones, y el tiempo necesario para evaluar y seleccione la combinación mejor rápidamente sea sensible. Algunas optimizaciones se han terminado en el motor de precio al por menor reducir el número total de combinaciones que deban evaluarse. Sin embargo, dado que el número que se superpone con descuentos y los importes de una transacción no están restringidos, un gran número de combinaciones que tendrán ser siempre evaluadas siempre que aquí se superponen descuentos. Este problema es el problema con las direcciones del método de la clasificación de valor marginales.

## <a name="marginal-value-method"></a>Método del valor marginal
Para resolver la aplicación exponencialmente un número que aumenta de combinaciones que se deben evaluadas, existe una optimización que calcula el valor por producto compartido de cada descuento en el conjunto de productos a los que dos o más descuentos se pueden aplicar. Referimos a este valor como ** marginal ** valor del descuento para los productos compartidos. El valor marginal es el valor medio de aumento del producto en el importe de descuento total cuando los productos compartidos se incluyen en cada descuento. El valor marginal se calcula tomando el importe de descuento total (DTotal), restando el importe de descuento sin los productos (compartidos DMinus compartido\\ ), y dividiendo esa diferencia por el número de productos (compartidos ProductsShared). [![que se superpone con la combinación de descuento 06] (. /media/overlapping-discount-combo-06.jpg])(. /media/overlapping-discount-combo-06.jpg) Después de que el valor marginal de cada descuento en un conjunto compartido de productos se calcule, los descuentos se aplican a los productos compartidos en orden, exhaustivo, marginal del valor más alto al valor marginal más bajo. Para este método, todas las posibilidades restantes de descuento no se comparan cada vez tras que se aplique una única instancia de un descuento. En su lugar, los descuentos que se superponen se comparan una vez y después se aplican en pedido. No se realiza ninguna comparaciones adicionales. Puede configurar el umbral para cambiar el método de valor marginal de descuento ** ** la ficha ** los parámetros de ventas ** de la página. El tiempo aceptable de calcular el descuento total varía a través de sectores minoristas. Sin embargo, este tiempo baja generalmente en el intervalo de diez de milisegundos a un segundo.


