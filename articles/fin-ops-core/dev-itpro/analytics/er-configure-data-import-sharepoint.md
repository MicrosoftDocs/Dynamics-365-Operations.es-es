---
title: Configurar la importación de datos de SharePoint
description: En este tema se explica cómo importar datos de Microsoft SharePoint.
author: NickSelin
manager: AnnBe
ms.date: 11/29/2018
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.search.scope: Core, Operations
ms.custom: 220314
ms.assetid: 2685df16-5ec8-4fd7-9495-c0f653e82567
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2018-04-01
ms.dyn365.ops.version: Release 8.0
ms.openlocfilehash: c11123c0d53fcf4ba67e83fe64d2d6e692d5b6f1
ms.sourcegitcommit: fbc106af09bdadb860677f590464fb93223cbf65
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 11/06/2019
ms.locfileid: "2771361"
---
# <a name="configure-data-import-from-sharepoint"></a><span data-ttu-id="4de86-103">Configurar la importación de datos de SharePoint</span><span class="sxs-lookup"><span data-stu-id="4de86-103">Configure data import from SharePoint</span></span>

[!include[banner](../includes/banner.md)]

<span data-ttu-id="4de86-104">Para importar datos de un archivo entrante mediante el marco de informes electrónicos (ER), debe configurar un formato de ER que admita la importación y luego ejecutar una asignación del modelo del tipo **A destino** que utilice el formato como un origen de datos.</span><span class="sxs-lookup"><span data-stu-id="4de86-104">To import data from an incoming file by using the Electronic reporting (ER) framework, you must configure an ER format that supports the import and then run a model mapping of the **To destination** type that uses that format as a data source.</span></span> <span data-ttu-id="4de86-105">Para importar datos, debe navegar hasta el archivo que desee importar.</span><span class="sxs-lookup"><span data-stu-id="4de86-105">To import data, you must navigate to the file that you want to import.</span></span> <span data-ttu-id="4de86-106">El usuario puede seleccionar manualmente el archivo entrante.</span><span class="sxs-lookup"><span data-stu-id="4de86-106">The incoming file can be manually selected by user.</span></span> <span data-ttu-id="4de86-107">Con la nueva capacidad de ER de admitir la importación de datos de Microsoft SharePoint, este proceso se puede configurar de manera automática.</span><span class="sxs-lookup"><span data-stu-id="4de86-107">With the new ER capability to support importing data from Microsoft SharePoint, this process can be configured as unattended.</span></span> <span data-ttu-id="4de86-108">Puede usar las configuraciones de ER para realizar la importación de datos de los archivos que se almacenan en las carpetas de Microsoft SharePoint.</span><span class="sxs-lookup"><span data-stu-id="4de86-108">You can use ER configurations to perform data import from files that are stored in Microsoft SharePoint folders.</span></span> <span data-ttu-id="4de86-109">Este tema explica cómo completar la importación desde SharePoint.</span><span class="sxs-lookup"><span data-stu-id="4de86-109">This topic explains how to complete the import from SharePoint.</span></span> <span data-ttu-id="4de86-110">Los ejemplos utilizan transacciones del proveedor como datos empresariales.</span><span class="sxs-lookup"><span data-stu-id="4de86-110">The examples use vendor transactions as business data.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="4de86-111">Requisitos previos</span><span class="sxs-lookup"><span data-stu-id="4de86-111">Prerequisites</span></span>
<span data-ttu-id="4de86-112">Para completar los ejemplos de este tema, debe tener el acceso siguiente:</span><span class="sxs-lookup"><span data-stu-id="4de86-112">To complete the examples in this topic, you must have the following access:</span></span>

- <span data-ttu-id="4de86-113">Acceda a uno de los roles siguientes:</span><span class="sxs-lookup"><span data-stu-id="4de86-113">Access one of the following roles:</span></span>

    - <span data-ttu-id="4de86-114">Desarrollador de informes electrónicos</span><span class="sxs-lookup"><span data-stu-id="4de86-114">Electronic reporting developer</span></span>
    - <span data-ttu-id="4de86-115">Consultor funcional de informes electrónicos</span><span class="sxs-lookup"><span data-stu-id="4de86-115">Electronic reporting functional consultant</span></span>
    - <span data-ttu-id="4de86-116">Administrador del sistema</span><span class="sxs-lookup"><span data-stu-id="4de86-116">System administrator</span></span>

- <span data-ttu-id="4de86-117">Acceda a la instancia de Microsoft SharePoint Server que está configurada para su uso con la aplicación.</span><span class="sxs-lookup"><span data-stu-id="4de86-117">Access to the instance of Microsoft SharePoint Server that is configured for use with the application.</span></span>
- <span data-ttu-id="4de86-118">Configuraciones del formato y el modelo de ER para pagos 1099.</span><span class="sxs-lookup"><span data-stu-id="4de86-118">ER format and model configurations for 1099 payments.</span></span>

### <a name="create-required-er-configurations"></a><span data-ttu-id="4de86-119">Crear las configuraciones de ER necesarias</span><span class="sxs-lookup"><span data-stu-id="4de86-119">Create required ER configurations</span></span>
<span data-ttu-id="4de86-120">Reproduzca las guías de tareas **Datos de importación de ER de un archivo de Microsoft Excel**, que forman parte del proceso empresarial **7.5.4.3 Adquirir o desarrollar componentes de soluciones y servicios de TI (10677)**.</span><span class="sxs-lookup"><span data-stu-id="4de86-120">Play the **ER Import data from a Microsoft Excel file** task guides, which are part of the **7.5.4.3 Acquire/Develop IT service/solution components (10677)** business process.</span></span> <span data-ttu-id="4de86-121">Estas guías de tareas le guiarán por el proceso de diseño y uso de configuraciones de ER para importar de forma interactiva transacciones del proveedor desde archivos de Microsoft Excel.</span><span class="sxs-lookup"><span data-stu-id="4de86-121">These task guides walk you through the process of designing and using ER configurations to interactively import vendor transactions from Microsoft Excel files.</span></span> <span data-ttu-id="4de86-122">Para obtener más información, consulte [Analizar documentos de entrada en formato Excel](parse-incoming-documents-excel.md).</span><span class="sxs-lookup"><span data-stu-id="4de86-122">For more information, see [Parse incoming documents in Excel format](parse-incoming-documents-excel.md).</span></span> <span data-ttu-id="4de86-123">Cuando haya completado las guías de la tarea, tendrá la siguiente configuración.</span><span class="sxs-lookup"><span data-stu-id="4de86-123">After you have completed the task guides, you will have the following set up.</span></span>

#### <a name="er-configurations"></a><span data-ttu-id="4de86-124">Configuraciones ER</span><span class="sxs-lookup"><span data-stu-id="4de86-124">ER configurations</span></span>

- <span data-ttu-id="4de86-125">Configuración del modelo de ER, **Modelo de pagos 1099**</span><span class="sxs-lookup"><span data-stu-id="4de86-125">ER model configuration, **1099 Payments model**</span></span>
- <span data-ttu-id="4de86-126">Configuración del formato de ER, **Formato para importar transacciones de los proveedores desde Excel**</span><span class="sxs-lookup"><span data-stu-id="4de86-126">ER format configuration, **Format for importing vendors' transactions from Excel**</span></span>

![Configuraciones de ER para importar datos de SharePoint](./media/GERImportFromSharePoint-01-Configurations.PNG)

#### <a name="sample-of-the-incoming-file-for-data-import"></a><span data-ttu-id="4de86-128">Ejemplo del archivo entrante para la importación de datos</span><span class="sxs-lookup"><span data-stu-id="4de86-128">Sample of the incoming file for data import</span></span>

- <span data-ttu-id="4de86-129">Archivo de Excel **1099import-data.xlsx**, con las transacciones del proveedor que deben importarse.</span><span class="sxs-lookup"><span data-stu-id="4de86-129">Excel file **1099import-data.xlsx**, with vendor transactions that should be imported.</span></span>

![Ejemplo de archivo de Microsoft Excel para importar desde SharePoint](./media/GERImportFromSharePoint-02-Excel.PNG)
    
> [!NOTE]
> <span data-ttu-id="4de86-131">El formato para importar transacciones del proveedor se selecciona como la asignación del modelo predeterminado.</span><span class="sxs-lookup"><span data-stu-id="4de86-131">The format for importing vendor transactions is selected as the default model mapping.</span></span> <span data-ttu-id="4de86-132">Por lo tanto, si ejecuta una asignación del modelo del **Modelo de pagos 1099**, y esta asignación del modelo es del tipo **A destino**, la asignación del modelo ejecuta este formato para importar datos desde archivos externos.</span><span class="sxs-lookup"><span data-stu-id="4de86-132">Therefore, if you run a model mapping of the **1099 Payments model**, and that model mapping is of the **To destination** type, the model mapping runs this format to import data from external files.</span></span> <span data-ttu-id="4de86-133">A continuación, emplea esos datos para actualizar tablas de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="4de86-133">It then uses that data to update application tables.</span></span>

## <a name="configure-access-to-sharepoint-for-file-storage"></a><span data-ttu-id="4de86-134">Configurar el acceso a SharePoint para el almacenamiento de archivos</span><span class="sxs-lookup"><span data-stu-id="4de86-134">Configure access to SharePoint for file storage</span></span>
<span data-ttu-id="4de86-135">Para almacenar archivos electrónicos de informes en una ubicación de SharePoint, debe configurar el acceso a la instancia de SharePoint Server que usará la empresa actual.</span><span class="sxs-lookup"><span data-stu-id="4de86-135">To store electronic report files in a SharePoint location, you must configure access to the SharePoint Server instance that will be used by the current company.</span></span> <span data-ttu-id="4de86-136">En este ejemplo, la empresa es USMF.</span><span class="sxs-lookup"><span data-stu-id="4de86-136">In this example, the company is USMF.</span></span> <span data-ttu-id="4de86-137">Para obtener instrucciones, consulte [Configurar el almacenamiento de SharePoint](../../fin-ops/organization-administration/configure-document-management.md#configure-sharepoint-storage).</span><span class="sxs-lookup"><span data-stu-id="4de86-137">For instructions, see [Configure SharePoint storage](../../fin-ops/organization-administration/configure-document-management.md#configure-sharepoint-storage).</span></span>

1. <span data-ttu-id="4de86-138">Complete los pasos indicados en [Configurar el almacenamiento de SharePoint](../../fin-ops/organization-administration/configure-document-management.md#configure-sharepoint-storage).</span><span class="sxs-lookup"><span data-stu-id="4de86-138">Complete the steps in [Configure SharePoint storage](../../fin-ops/organization-administration/configure-document-management.md#configure-sharepoint-storage).</span></span>
2. <span data-ttu-id="4de86-139">Abra el sitio de SharePoint configurado.</span><span class="sxs-lookup"><span data-stu-id="4de86-139">Open the configured SharePoint site.</span></span>
3. <span data-ttu-id="4de86-140">Cree las carpetas siguientes en las que los archivos electrónicos entrantes de informe de errores se pueden almacenar:</span><span class="sxs-lookup"><span data-stu-id="4de86-140">Create the following folders where incoming electronic reporting files can be stored:</span></span>

     - <span data-ttu-id="4de86-141">Origen de la importación de los archivos (principal) (ejemplo que se muestra en captura de pantalla de abajo)</span><span class="sxs-lookup"><span data-stu-id="4de86-141">Files import source (main) (Example shown in screenshot below)</span></span>
     - <span data-ttu-id="4de86-142">Origen de la importación de los archivos (alternativa)</span><span class="sxs-lookup"><span data-stu-id="4de86-142">Files import source (alternative)</span></span>

    ![Origen de la importación de los archivos (principal)](./media/GERImportFromSharePoint-04-SharePointFolder1.png)

4. <span data-ttu-id="4de86-144">(Opcional) Cree las carpetas siguientes en las que los archivos se pueden almacenar después de la importación.</span><span class="sxs-lookup"><span data-stu-id="4de86-144">(Optional) Create the following folders where the files can be stored after import.</span></span> 

    - <span data-ttu-id="4de86-145">Carpeta de archivos archivados - esta carpeta sería para los archivos importados correctamente.</span><span class="sxs-lookup"><span data-stu-id="4de86-145">Files archive folder - This folder would be for successfully imported files.</span></span>
    - <span data-ttu-id="4de86-146">Carpeta de archivos con advertencia - esta carpeta sería para los archivos importados con una advertencia.</span><span class="sxs-lookup"><span data-stu-id="4de86-146">Files warning folder - This folder would be for files that were imported with a warning.</span></span>
    - <span data-ttu-id="4de86-147">Carpeta de archivos con error - esta carpeta sería para los archivos importados con error.</span><span class="sxs-lookup"><span data-stu-id="4de86-147">Files error folder - This folder would be for files that failed to import.</span></span>

4. <span data-ttu-id="4de86-148">Vaya a **Administración de la organización > Gestión de documentos > Tipos de documento**.</span><span class="sxs-lookup"><span data-stu-id="4de86-148">Go to **Organization administration > Document management > Document types**.</span></span>
5. <span data-ttu-id="4de86-149">Cree los siguientes tipos de documentos que se usarán para obtener acceso a las carpetas de SharePoint que acaba de crear.</span><span class="sxs-lookup"><span data-stu-id="4de86-149">Create the following document types that will be used to access the SharePoint folders that you just created.</span></span> <span data-ttu-id="4de86-150">Para obtener instrucciones, consulte [Configurar tipos de documentos](../../fin-ops/organization-administration/configure-document-management.md#configure-document-types).</span><span class="sxs-lookup"><span data-stu-id="4de86-150">For instructions, see [Configure document types](../../fin-ops/organization-administration/configure-document-management.md#configure-document-types).</span></span>

|<span data-ttu-id="4de86-151">Tipo de documento</span><span class="sxs-lookup"><span data-stu-id="4de86-151">Document type</span></span>       | <span data-ttu-id="4de86-152">Grupo</span><span class="sxs-lookup"><span data-stu-id="4de86-152">Group</span></span>              | <span data-ttu-id="4de86-153">Ubicación</span><span class="sxs-lookup"><span data-stu-id="4de86-153">Location</span></span>      | <span data-ttu-id="4de86-154">Carpeta SharePoint</span><span class="sxs-lookup"><span data-stu-id="4de86-154">SharePoint folder</span></span>      |
|--------------------|--------------------|---------------|------------------------|
|<span data-ttu-id="4de86-155">SP principal</span><span class="sxs-lookup"><span data-stu-id="4de86-155">SP Main</span></span>             |<span data-ttu-id="4de86-156">Archivo</span><span class="sxs-lookup"><span data-stu-id="4de86-156">File</span></span>                |<span data-ttu-id="4de86-157">SharePoint</span><span class="sxs-lookup"><span data-stu-id="4de86-157">SharePoint</span></span>     |<span data-ttu-id="4de86-158">Origen de la importación de los archivos (principal)</span><span class="sxs-lookup"><span data-stu-id="4de86-158">Files import source (main)</span></span>|
|<span data-ttu-id="4de86-159">SP alternativo</span><span class="sxs-lookup"><span data-stu-id="4de86-159">SP Alternative</span></span>             |<span data-ttu-id="4de86-160">Archivo</span><span class="sxs-lookup"><span data-stu-id="4de86-160">File</span></span>                |<span data-ttu-id="4de86-161">SharePoint</span><span class="sxs-lookup"><span data-stu-id="4de86-161">SharePoint</span></span>     |<span data-ttu-id="4de86-162">Origen de la importación de los archivos (alternativa)</span><span class="sxs-lookup"><span data-stu-id="4de86-162">Files import source (alternative)</span></span>|
|<span data-ttu-id="4de86-163">Archivo SP</span><span class="sxs-lookup"><span data-stu-id="4de86-163">SP Archive</span></span>             |<span data-ttu-id="4de86-164">Archivo</span><span class="sxs-lookup"><span data-stu-id="4de86-164">File</span></span>                |<span data-ttu-id="4de86-165">SharePoint</span><span class="sxs-lookup"><span data-stu-id="4de86-165">SharePoint</span></span>     |<span data-ttu-id="4de86-166">Carpeta de archivos archivados</span><span class="sxs-lookup"><span data-stu-id="4de86-166">Files archive folder</span></span>|
|<span data-ttu-id="4de86-167">Advertencia de SP</span><span class="sxs-lookup"><span data-stu-id="4de86-167">SP Warning</span></span>             |<span data-ttu-id="4de86-168">Archivo</span><span class="sxs-lookup"><span data-stu-id="4de86-168">File</span></span>                |<span data-ttu-id="4de86-169">SharePoint</span><span class="sxs-lookup"><span data-stu-id="4de86-169">SharePoint</span></span>     |<span data-ttu-id="4de86-170">Carpeta de archivos con advertencias</span><span class="sxs-lookup"><span data-stu-id="4de86-170">Files warning folder</span></span>|
|<span data-ttu-id="4de86-171">Error de SP</span><span class="sxs-lookup"><span data-stu-id="4de86-171">SP Error</span></span>             |<span data-ttu-id="4de86-172">Archivo</span><span class="sxs-lookup"><span data-stu-id="4de86-172">File</span></span>                |<span data-ttu-id="4de86-173">SharePoint</span><span class="sxs-lookup"><span data-stu-id="4de86-173">SharePoint</span></span>     |<span data-ttu-id="4de86-174">Carpeta de archivos con errores</span><span class="sxs-lookup"><span data-stu-id="4de86-174">Files error folder</span></span>|

![Configuración de SharePoint – nuevo tipo de documento](./media/GERImportFromSharePoint-06-SharePointDocumentTypesSetup.png)

## <a name="configure-er-sources-for-the-er-format"></a><span data-ttu-id="4de86-176">Configurar fuentes de ER para el formato de ER</span><span class="sxs-lookup"><span data-stu-id="4de86-176">Configure ER sources for the ER format</span></span>
1. <span data-ttu-id="4de86-177">Haga clic en **Administración de la organización** \> **Informes electrónicos** \> **Trabajos de informes electrónicos**.</span><span class="sxs-lookup"><span data-stu-id="4de86-177">Click **Organization administration** \> **Electronic reporting** \> **Electronic reporting source**.</span></span>
2. <span data-ttu-id="4de86-178">En la página **Origen de informes electrónicos**, configure los archivos de origen para la importación de datos mediante el formato de ER configurado.</span><span class="sxs-lookup"><span data-stu-id="4de86-178">On the **Electronic reporting source** page, configure the source files for data import by using the configured ER format.</span></span>
3. <span data-ttu-id="4de86-179">Defina una máscara de nombre de archivo, de manera que solo se importen los archivos con la extensión .xlsx.</span><span class="sxs-lookup"><span data-stu-id="4de86-179">Define a file name mask, so that only files with the .xlsx extension are imported.</span></span> <span data-ttu-id="4de86-180">La máscara de nombre de archivo es opcional y se utiliza solo cuando se ha definido.</span><span class="sxs-lookup"><span data-stu-id="4de86-180">The file name mask is optional and is used only when it has been defined.</span></span> <span data-ttu-id="4de86-181">Solo puede definir una máscara para cada formato de ER.</span><span class="sxs-lookup"><span data-stu-id="4de86-181">You can define only one mask for each ER format.</span></span>
4. <span data-ttu-id="4de86-182">Cambie **Ordenar archivos antes de importar** a **No ordenar**, si hay muchos archivos para importar y el orden de la importación no es importante.</span><span class="sxs-lookup"><span data-stu-id="4de86-182">Change **Sort files before import** to **Do not sort**, if there are a lot of files for import and the import order is not important</span></span>
5. <span data-ttu-id="4de86-183">Seleccione todas las carpetas de SharePoint que creó anteriormente.</span><span class="sxs-lookup"><span data-stu-id="4de86-183">Select all SharePoint folders that you created earlier.</span></span>

    <span data-ttu-id="4de86-184">[![Configuración de origen de archivos de ER](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)</span><span class="sxs-lookup"><span data-stu-id="4de86-184">[![ER files source setting](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)</span></span>

> [!NOTE]
> - <span data-ttu-id="4de86-185">El *origen* de ER se define individualmente para cada empresa de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="4de86-185">The ER *source* is defined for each application company individually.</span></span> <span data-ttu-id="4de86-186">En cambio, las *configuraciones* de ER se comparten entre las empresas.</span><span class="sxs-lookup"><span data-stu-id="4de86-186">By contrast, ER *configurations* are shared across companies.</span></span>
> - <span data-ttu-id="4de86-187">Cuando elimina una configuración de origen de ER para un formato de ER, también se eliminan todos los estados de los archivos conectados por confirmación (véase más abajo).</span><span class="sxs-lookup"><span data-stu-id="4de86-187">When you delete an ER source setting for an ER format, all connected file states (see below) are also deleted by confirmation.</span></span>

## <a name="review-the-files-states-for-the-er-format"></a><span data-ttu-id="4de86-188">Revise los estados de los archivos para el formato de ER</span><span class="sxs-lookup"><span data-stu-id="4de86-188">Review the files states for the ER format</span></span>
1. <span data-ttu-id="4de86-189">En la página **Origen de informes electrónicos**, seleccione **Estados de archivo para los orígenes** para revisar el contenido de los orígenes de archivo configurados para el formato de ER actual.</span><span class="sxs-lookup"><span data-stu-id="4de86-189">On the **Electronic reporting source** page, select **File states for the sources** to review the content of the configured file sources for the current ER format.</span></span>
2. <span data-ttu-id="4de86-190">En la sección **Archivos**, revise la lista de archivos.</span><span class="sxs-lookup"><span data-stu-id="4de86-190">In the **Files** section, review the list of files.</span></span> <span data-ttu-id="4de86-191">Esta lista muestra lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="4de86-191">This list presents the following:</span></span>

    - <span data-ttu-id="4de86-192">Archivos de origen que son aplicables, en función de la máscara de nombre de archivo (si se define una máscara de nombre de archivo) y que están listos para la importación de datos.</span><span class="sxs-lookup"><span data-stu-id="4de86-192">Source files that are applicable, based on the file name mask (if a file name mask is defined), and that are ready for data import.</span></span> <span data-ttu-id="4de86-193">Para estos archivos, la sección **Registro de los orígenes para el formato de importación** está en blanco.</span><span class="sxs-lookup"><span data-stu-id="4de86-193">For these files, the **Sources log for the import format** section is blank.</span></span>
    - <span data-ttu-id="4de86-194">Archivos importados anteriormente.</span><span class="sxs-lookup"><span data-stu-id="4de86-194">Previously imported files.</span></span> <span data-ttu-id="4de86-195">Para cada uno de estos archivos, en la sección **Registro de los orígenes para el formato de importación**, puede revisar el historial de importación de este archivo.</span><span class="sxs-lookup"><span data-stu-id="4de86-195">For each of these files, in the **Sources log for the import format** section, you can review the history of import of this file.</span></span>

<span data-ttu-id="4de86-196">También puede abrir la página **Estados de archivo para los orígenes** seleccionando **Administración de la organización** \> **Informes electrónicos** \> **Estados de archivo para los orígenes**.</span><span class="sxs-lookup"><span data-stu-id="4de86-196">You can also open the **File states for the sources** page by selecting **Organization administration** \> **Electronic reporting** \> **File states for the sources**.</span></span> <span data-ttu-id="4de86-197">En este caso, la página ofrece información sobre los orígenes de archivo para todos los formatos de ER para los que se han configurado los orígenes de archivo en la empresa en la que está registrado actualmente.</span><span class="sxs-lookup"><span data-stu-id="4de86-197">In this case, the page provides information about file sources for all ER formats that file sources have been configured for in the company that you're currently signed in to.</span></span>

## <a name="import-data-from-excel-files-that-are-in-a-sharepoint-folder"></a><span data-ttu-id="4de86-198">Importar datos de los archivos Excel que están en una carpeta de SharePoint</span><span class="sxs-lookup"><span data-stu-id="4de86-198">Import data from Excel files that are in a SharePoint folder</span></span>
1. <span data-ttu-id="4de86-199">En SharePoint, cargue el archivo de Microsoft Excel **1099import-data.xlsx** que contiene transacciones de proveedores en la carpeta de SharePoint **Origen de la importación de los archivos (principal)** que creó anteriormente.</span><span class="sxs-lookup"><span data-stu-id="4de86-199">In SharePoint, upload the Microsoft Excel file **1099import-data.xlsx** that contains vendor transactions to the **Files import source (main)** SharePoint folder that you created earlier.</span></span>

    <span data-ttu-id="4de86-200">[![SharePoint contenido – archivo Microsoft Excel para importar](./media/GERImportFromSharePoint-08-UploadFile.png)](./media/GERImportFromSharePoint-08-UploadFile.png)</span><span class="sxs-lookup"><span data-stu-id="4de86-200">[![SharePoint content – Microsoft Excel file for importing](./media/GERImportFromSharePoint-08-UploadFile.png)](./media/GERImportFromSharePoint-08-UploadFile.png)</span></span>

2. <span data-ttu-id="4de86-201">En la página **Estados de archivo para los orígenes**, seleccione **Actualizar** para actualizar la página.</span><span class="sxs-lookup"><span data-stu-id="4de86-201">On the **File states for the sources** page, select **Refresh** to refresh the page.</span></span> <span data-ttu-id="4de86-202">Tenga en cuenta que el archivo de Excel que se cargó en SharePoint  aparecía en esta página con el estado **Preparado**.</span><span class="sxs-lookup"><span data-stu-id="4de86-202">Note that the Excel file that was uploaded to SharePoint appeared on this page with the status **Ready**.</span></span> <span data-ttu-id="4de86-203">Actualmente se admiten los siguientes estados:</span><span class="sxs-lookup"><span data-stu-id="4de86-203">The following statuses are currently supported:</span></span>

    - <span data-ttu-id="4de86-204">**Preparado** - Asignado automáticamente para cada nuevo archivo en una carpeta de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="4de86-204">**Ready** – Assigned automatically for each new file in a SharePoint folder.</span></span> <span data-ttu-id="4de86-205">Este estado significa que el archivo está listo para la importación.</span><span class="sxs-lookup"><span data-stu-id="4de86-205">This status means that the file is ready for import.</span></span>
    - <span data-ttu-id="4de86-206">**Importando** - Asignado automáticamente por un informe de ER cuando el archivo se bloquea mediante el proceso de importación para evitar su uso por otros procesos (si muchos de ellos se están ejecutando simultáneamente).</span><span class="sxs-lookup"><span data-stu-id="4de86-206">**Importing** – Assigned automatically by an ER report when the file will be locked by the import process to prevent its usage by other processes (if many of them are running simultaneously).</span></span>
    - <span data-ttu-id="4de86-207">**Importado** - Asignado automáticamente por un informe de ER cuando la importación del archivo se completa correctamente.</span><span class="sxs-lookup"><span data-stu-id="4de86-207">**Imported** – Assigned automatically by an ER report when the file import is successfully completed.</span></span> <span data-ttu-id="4de86-208">Este estado significa que el archivo importado se ha eliminado desde el origen de archivos configurado (carpeta de SharePoint).</span><span class="sxs-lookup"><span data-stu-id="4de86-208">This status means that the imported file has been deleted from the configured files source (SharePoint folder).</span></span>
    - <span data-ttu-id="4de86-209">**Fallido** - Asignado automáticamente por un informe de ER cuando la importación del archivo se completa con errores o excepciones.</span><span class="sxs-lookup"><span data-stu-id="4de86-209">**Failed** – Assigned automatically by an ER report when the file import completed with errors or exceptions.</span></span>
    - <span data-ttu-id="4de86-210">**En espera** - Asignado manualmente por el usuario en esta página.</span><span class="sxs-lookup"><span data-stu-id="4de86-210">**On hold** – Assigned manually by user on this page.</span></span> <span data-ttu-id="4de86-211">Este estado significa que el archivo no se importará por ahora.</span><span class="sxs-lookup"><span data-stu-id="4de86-211">This status means that the file will not be imported for now.</span></span> <span data-ttu-id="4de86-212">Este estado se puede utilizar para posponer la importación de algunos archivos.</span><span class="sxs-lookup"><span data-stu-id="4de86-212">This status can be used to postpone the import of some files.</span></span>

    <span data-ttu-id="4de86-213">[![Página de estados de archivo de ER para los orígenes seleccionados](./media/GERImportFromSharePoint-09-FileStatesForm.png)](./media/GERImportFromSharePoint-09-FileStatesForm.png)</span><span class="sxs-lookup"><span data-stu-id="4de86-213">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-09-FileStatesForm.png)](./media/GERImportFromSharePoint-09-FileStatesForm.png)</span></span>

## <a name="import-data-from-sharepoint-files"></a><span data-ttu-id="4de86-214">Importar datos desde archivos SharePoint</span><span class="sxs-lookup"><span data-stu-id="4de86-214">Import data from SharePoint files</span></span>
1. <span data-ttu-id="4de86-215">Abra el árbol de configuraciones de ER, seleccione el **Modelo de sueldo 1099** y amplíe la lista de componentes del modelo de ER.</span><span class="sxs-lookup"><span data-stu-id="4de86-215">Open the ER configurations tree, select the **1099 Payment model**, and expand the list of ER model components.</span></span>
2. <span data-ttu-id="4de86-216">Seleccione el nombre de la asignación de modelo para abrir la lista de asignaciones de modelo de la configuración seleccionada del modelo de ER.</span><span class="sxs-lookup"><span data-stu-id="4de86-216">Select the name of the model mapping to open the list of model mappings of the selected ER model configuration.</span></span>

    <span data-ttu-id="4de86-217">[![Página de estados de archivo de ER para los orígenes seleccionados](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="4de86-217">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)</span></span>

3. <span data-ttu-id="4de86-218">Seleccione **Ejecutar** para ejecutar la asignación de modelo seleccionado.</span><span class="sxs-lookup"><span data-stu-id="4de86-218">Select **Run** to run the selected model mapping.</span></span> <span data-ttu-id="4de86-219">Puesto que configuró los orígenes de archivo para el formato de ER, puede cambiar la configuración de la opción **Origen de archivo** si es preciso.</span><span class="sxs-lookup"><span data-stu-id="4de86-219">Because you configured file sources for the ER format, you can change the setting of the **File source** option, if needed.</span></span> <span data-ttu-id="4de86-220">Si conserva el configuración de esta opción, los archivos .xslx se importan desde los orígenes configurados (las carpetas de SharePoint, en este ejemplo).</span><span class="sxs-lookup"><span data-stu-id="4de86-220">If you keep the setting of this option, the .xslx files are imported from the configured sources (the SharePoint folders, in this example).</span></span>

    <span data-ttu-id="4de86-221">En este ejemplo, está importando un único archivo.</span><span class="sxs-lookup"><span data-stu-id="4de86-221">In this example, you're importing only one file.</span></span> <span data-ttu-id="4de86-222">Sin embargo, si hay varios archivos, se seleccionan para importarlos en el orden en el que se han agregado a la carpeta de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="4de86-222">However, if there are multiple files, they are selected for importing in the order in which they were added to the SharePoint folder.</span></span> <span data-ttu-id="4de86-223">Cada ejecución de un formato de ER se importa un único archivo seleccionado.</span><span class="sxs-lookup"><span data-stu-id="4de86-223">Every run of an ER format imports a single selected file.</span></span>

    <span data-ttu-id="4de86-224">[![Ejecutar asignación de modelo de ER](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="4de86-224">[![Run ER model mapping](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)</span></span>

4. <span data-ttu-id="4de86-225">La asignación de modelo puede ejecutarse automáticamente en modo de lote.</span><span class="sxs-lookup"><span data-stu-id="4de86-225">The model mapping can run unattended in batch mode.</span></span> <span data-ttu-id="4de86-226">En este caso, cada vez que un lote ejecuta este formato de ER, se importa un único archivo desde las fuentes de archivo configuradas.</span><span class="sxs-lookup"><span data-stu-id="4de86-226">In this case, every time that a batch runs this ER format, a single file is imported from the configured file sources.</span></span>

    <span data-ttu-id="4de86-227">Cuando se importa un archivo con éxito de la carpeta de SharePoint, se elimina de esa carpeta y se pasa a la carpeta para los archivos importados con éxito o a la carpeta de los archivos importados con avisos.</span><span class="sxs-lookup"><span data-stu-id="4de86-227">When a file is successfully imported from the SharePoint folder, it's deleted from that folder and moved to folder for successful imported files or to the folder to imported files with warnings.</span></span> <span data-ttu-id="4de86-228">Si no se mueve a la carpeta para los archivos fallidos o permanece en esta carpeta si la carpeta para los archivos fallidos no se ha configurado.</span><span class="sxs-lookup"><span data-stu-id="4de86-228">Otherwise it's moved to folder for failed files or stays in this folder if the folder for failed files isn't set up.</span></span> 

5. <span data-ttu-id="4de86-229">Introduzca el Id. de asiento, como **V-00001** y, a continuación, seleccione **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="4de86-229">Enter the voucher ID, such as **V-00001**, and then select **OK**.</span></span>

    <span data-ttu-id="4de86-230">[![Ejecutar asignación de modelo de ER](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)</span><span class="sxs-lookup"><span data-stu-id="4de86-230">[![Run ER model mapping](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)</span></span>

6. <span data-ttu-id="4de86-231">En la página **Estados de archivo para los orígenes**, seleccione **Actualizar** para actualizar la página.</span><span class="sxs-lookup"><span data-stu-id="4de86-231">On the **File states for the sources** page, select **Refresh** to refresh the page.</span></span>

    <span data-ttu-id="4de86-232">[![Página de estados de archivo de ER para los orígenes seleccionados](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)</span><span class="sxs-lookup"><span data-stu-id="4de86-232">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)</span></span>

7. <span data-ttu-id="4de86-233">En la sección **Archivos**, revise la lista de archivos.</span><span class="sxs-lookup"><span data-stu-id="4de86-233">In the **Files** section, review the list of files.</span></span> <span data-ttu-id="4de86-234">La sección **Registro de los orígenes para el formato de importación** proporciona el historial de importación del archivo de Excel.</span><span class="sxs-lookup"><span data-stu-id="4de86-234">The **Sources log for the import format** section provides the history of the Excel file import.</span></span> <span data-ttu-id="4de86-235">Dado que este archivo se importó correctamente, se marca como **Eliminado** en la carpeta de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="4de86-235">Because this file was successfully imported, it's marked as **Deleted** in the SharePoint folder.</span></span>
8. <span data-ttu-id="4de86-236">Revise la carpeta de SharePoint **Origen de la importación de los archivos (principal)**.</span><span class="sxs-lookup"><span data-stu-id="4de86-236">Review the **Files import source (main)** SharePoint folder.</span></span> <span data-ttu-id="4de86-237">Los archivos de Excel que se importaron correctamente se han eliminado de esta carpeta.</span><span class="sxs-lookup"><span data-stu-id="4de86-237">The Excel files that were successfully imported have been deleted from this folder.</span></span>
9. <span data-ttu-id="4de86-238">Seleccione **Proveedores** \> **Tareas periódicas** \> **Impuesto 1099** \> **Liquidación del proveedor por 1099s**.</span><span class="sxs-lookup"><span data-stu-id="4de86-238">Select **Accounts payable** \> **Periodic tasks** \> **Tax 1099** \> **Vendor settlement for 1099s**.</span></span>
10. <span data-ttu-id="4de86-239">En los campos **Fecha inicial** y **Fecha final**, introduzca los valores adecuados.</span><span class="sxs-lookup"><span data-stu-id="4de86-239">In the **From date** and **To date** fields, enter appropriate values.</span></span> <span data-ttu-id="4de86-240">A continuación, seleccione **Transacciones 1099 manuales**.</span><span class="sxs-lookup"><span data-stu-id="4de86-240">Then select **Manual 1099 transactions**.</span></span>

    <span data-ttu-id="4de86-241">Las transacciones del proveedor que se importaron de los archivos de Excel en SharePoint para el asiento **V-00001** están presentes en la página.</span><span class="sxs-lookup"><span data-stu-id="4de86-241">The vendor transactions that were imported from the Excel files on SharePoint for voucher **V-00001**, are presented on the page.</span></span>

    <span data-ttu-id="4de86-242">[![Página de transacciones del proveedor 1099](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)</span><span class="sxs-lookup"><span data-stu-id="4de86-242">[![1099 vendor transactions page](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)</span></span>

## <a name="prepare-an-excel-file-for-import"></a><span data-ttu-id="4de86-243">Preparar un archivo de Excel para importación</span><span class="sxs-lookup"><span data-stu-id="4de86-243">Prepare an Excel file for import</span></span>
1. <span data-ttu-id="4de86-244">Abra el archivo de Excel que utilizó anteriormente.</span><span class="sxs-lookup"><span data-stu-id="4de86-244">Open the Excel file that you previously used.</span></span> <span data-ttu-id="4de86-245">En la fila 3 columna 1, agregue un código de proveedor que no exista en la aplicación.</span><span class="sxs-lookup"><span data-stu-id="4de86-245">In row 3 column 1, add a vendor code that doesn't exist in the application.</span></span> <span data-ttu-id="4de86-246">Agregue más información del proveedor falsa a la fila.</span><span class="sxs-lookup"><span data-stu-id="4de86-246">Add additional false vendor information to the row.</span></span>

    <span data-ttu-id="4de86-247">[![Ejemplo de archivo de Microsoft Excel para importar desde SharePoint](./media/GERImportFromSharePoint-15-Excel.PNG)](./media/GERImportFromSharePoint-15-Excel.PNG)</span><span class="sxs-lookup"><span data-stu-id="4de86-247">[![Sample Microsoft Excel file for importing from SharePoint](./media/GERImportFromSharePoint-15-Excel.PNG)](./media/GERImportFromSharePoint-15-Excel.PNG)</span></span>

2. <span data-ttu-id="4de86-248">Cargue el archivo de Excel actualizado que contenga transacciones de proveedores en la carpeta de SharePoint **Origen de la importación de los archivos (principal)**.</span><span class="sxs-lookup"><span data-stu-id="4de86-248">Upload the updated Excel file that contains vendors transactions to the **Files import source (main)** SharePoint folder.</span></span>
3. <span data-ttu-id="4de86-249">Abra el árbol de configuraciones de ER, seleccione el **Modelo de sueldo 1099** y amplíe la lista de componentes del modelo de ER.</span><span class="sxs-lookup"><span data-stu-id="4de86-249">Open the ER configurations tree, select the **1099 Payment model**, and expand the list of ER model components.</span></span>
4. <span data-ttu-id="4de86-250">Seleccione el nombre de la asignación de modelo para actualizar la asignación de modelo de manera que el código de proveedor incorrecto se considere un error durante el proceso de importación de datos.</span><span class="sxs-lookup"><span data-stu-id="4de86-250">Select the name of the model mapping to update the model mapping so that the incorrect vendor code is considered an error during the data import process.</span></span>
5. <span data-ttu-id="4de86-251">Seleccione **Diseñador**.</span><span class="sxs-lookup"><span data-stu-id="4de86-251">Select **Designer**.</span></span>
6. <span data-ttu-id="4de86-252">En la pestaña **Validaciones**, debe cambiar la acción de posvalidación para la regla de validación que se configuró para evaluar si la cuenta de proveedor que se importa existe en la aplicación.</span><span class="sxs-lookup"><span data-stu-id="4de86-252">On the **Validations** tab, you must change the post-validation action for the validation rule that was configured to evaluate whether the vendor account that is imported exists in the application.</span></span> <span data-ttu-id="4de86-253">Actualice el valor del campo **Acción de posvalidación** a **Detener ejecución**, guarde los cambios y cierre la página.</span><span class="sxs-lookup"><span data-stu-id="4de86-253">Update the value of the **Post-validation action** field to **Stop execution**, save your changes, and close the page.</span></span>

    <span data-ttu-id="4de86-254">[![Página de diseñador de asignación de modelos de ER](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="4de86-254">[![ER model mapping designer page](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)</span></span>

7. <span data-ttu-id="4de86-255">Guarde sus cambios y cierre el diseñador de asignación de modelos de ER.</span><span class="sxs-lookup"><span data-stu-id="4de86-255">Save your changes, and close the ER model mapping designer.</span></span>
8. <span data-ttu-id="4de86-256">Seleccione **Ejecutar** para ejecutar la asignación de modelo de ER modificado.</span><span class="sxs-lookup"><span data-stu-id="4de86-256">Select **Run** to run the modified ER model mapping.</span></span>
9. <span data-ttu-id="4de86-257">Introduzca el Id. de asiento, como **V-00002** y, a continuación, seleccione **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="4de86-257">Enter the voucher ID, such as **V-00002**, and then select **OK**.</span></span>

    <span data-ttu-id="4de86-258">Tenga en cuenta que el registro de información contiene una notificación que informa de que hay un archivo en la carpeta de SharePoint que contiene una cuenta de proveedor incorrecta y no se puede importar.</span><span class="sxs-lookup"><span data-stu-id="4de86-258">Note that the Infolog contains a notification that there's a file in the SharePoint folder that contains incorrect vendor account and can’t be imported.</span></span>

    <span data-ttu-id="4de86-259">[![Ejecutar asignación de modelo de ER](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)</span><span class="sxs-lookup"><span data-stu-id="4de86-259">[![Run ER model mapping](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)</span></span>

10. <span data-ttu-id="4de86-260">En la página **Estados de archivo para los orígenes**, seleccione **Actualizar** y, a continuación, en la sección **Archivos**, revise la lista de archivos.</span><span class="sxs-lookup"><span data-stu-id="4de86-260">On the **File states for the sources** page, select **Refresh**, and then, in the **Files** section, review the list of files.</span></span>

    <span data-ttu-id="4de86-261">[![Página de estados de archivo de ER para los orígenes seleccionados](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)</span><span class="sxs-lookup"><span data-stu-id="4de86-261">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)</span></span>

   <span data-ttu-id="4de86-262">La sección **Registro de los orígenes para el formato de importación** indica que el proceso de importación ha fallado y que el archivo se encuentra todavía en la carpeta de SharePoint de archivos con error (la casilla **Eliminado** no está seleccionada).</span><span class="sxs-lookup"><span data-stu-id="4de86-262">The **Sources log for the import format** section indicates that the import process failed and that the file is in the Files error SharePoint folder (the **Is deleted** check box is not selected).</span></span> <span data-ttu-id="4de86-263">Si arregla este archivo en SharePoint agregando el código de proveedor correspondiente y después lo mueve a la carpeta (principal) de SharePoint del origen de la importación de los archivos, puede importar el archivo de nuevo.</span><span class="sxs-lookup"><span data-stu-id="4de86-263">If you fix this file on SharePoint by adding the proper vendor code and then move it to the Files import source (main) SharePoint folder, you can import the file again.</span></span>

11. <span data-ttu-id="4de86-264">Seleccione **Proveedores** \> **Tareas periódicas** \> **Impuesto 1099** \> **Liquidación del proveedor para 1099**, introduzca los valores adecuados en los campos **Fecha inicial** y **Fecha final** y, a continuación, seleccione **Transacciones 1099 manuales**.</span><span class="sxs-lookup"><span data-stu-id="4de86-264">Select **Accounts payable** \> **Periodic tasks** \> **Tax 1099** \> **Vendor settlement for 1099s**, enter appropriate values in the **From date** and **To date** fields, and then select **Manual 1099 transactions**.</span></span>

    <span data-ttu-id="4de86-265">Solo están disponibles las transacciones para el asiento V-00001.</span><span class="sxs-lookup"><span data-stu-id="4de86-265">Only transactions for voucher V-00001 are available.</span></span> <span data-ttu-id="4de86-266">No están disponibles las transacciones para el asiento V-00002 aunque se ha encontrado el error para la última transacción importada en el archivo de Excel.</span><span class="sxs-lookup"><span data-stu-id="4de86-266">No transactions for voucher V-00002 are available even though the error for the last imported transaction has been found in the Excel file.</span></span>
