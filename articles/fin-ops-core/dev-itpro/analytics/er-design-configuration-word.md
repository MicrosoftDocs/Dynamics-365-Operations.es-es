---
title: Diseñar una nueva configuración de ER para generar informes en formato Word
description: Este tema explica cómo los usuarios pueden configurar un nuevo formato de informes electrónicos (ER) para generar informes como documentos de Microsoft Word.
author: NickSelin
manager: AnnBe
ms.date: 12/17/2020
ms.topic: business-process
ms.prod: ''
ms.service: dynamics-ax-applications
ms.technology: ''
ms.search.form: ERWorkspace, ERSolutionTable, EROperationDesigner,  LedgerJournalTable, LedgerJournalTransVendPaym
audience: Application User
ms.reviewer: kfend
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2020-01-01
ms.dyn365.ops.version: Version 10.0.6
ms.openlocfilehash: 535e46eb033bf2796ab8e4b0d2e29767ad0a8cdf
ms.sourcegitcommit: 5192cfaedfd861faea63d8954d7bcc500608a225
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 01/30/2021
ms.locfileid: "5094163"
---
# <a name="design-a-new-er-configuration-to-generate-reports-in-word-format"></a><span data-ttu-id="032b4-103">Diseñar una nueva configuración de ER para generar informes en formato Word</span><span class="sxs-lookup"><span data-stu-id="032b4-103">Design a new ER configuration to generate reports in Word format</span></span>

[!include [banner](../includes/banner.md)]

<span data-ttu-id="032b4-104">Para generar informes como documentos de Microsoft Word, debe diseñar una plantilla para los informes utilizando, por ejemplo, la aplicación de escritorio Word.</span><span class="sxs-lookup"><span data-stu-id="032b4-104">To generate reports as Microsoft Word documents, you must design a template for the reports by using, for example, the Word desktop application.</span></span> <span data-ttu-id="032b4-105">La siguiente ilustración muestra la plantilla de ejemplo para el informe de control que se puede generar para mostrar detalles de los pagos procesados a proveedores.</span><span class="sxs-lookup"><span data-stu-id="032b4-105">The following illustration shows the sample template for the control report that can be generated to show details of processed vendor payments.</span></span>

![Plantilla de ejemplo para el informe de control en la aplicación de escritorio de Word](./media/er-design-configuration-word-image1.png)

<span data-ttu-id="032b4-107">Para utilizar un documento de Word como plantilla para informes en formato Word, puede configurar una nueva [solución](er-quick-start1-new-solution.md) de [informes electrónicos (ER)](general-electronic-reporting.md).</span><span class="sxs-lookup"><span data-stu-id="032b4-107">To use a Word document as a template for reports in Word format, you can configure a new [Electronic reporting (ER)](general-electronic-reporting.md) [solution](er-quick-start1-new-solution.md).</span></span> <span data-ttu-id="032b4-108">Esta solución debe incluir una [configuración](general-electronic-reporting.md#Configuration) de ER que contenga un componente de [formato](general-electronic-reporting.md#FormatComponentOutbound) ER.</span><span class="sxs-lookup"><span data-stu-id="032b4-108">This solution must include an ER [configuration](general-electronic-reporting.md#Configuration) that contains an ER [format](general-electronic-reporting.md#FormatComponentOutbound) component.</span></span>

> [!NOTE]
> <span data-ttu-id="032b4-109">Cuando crea una nueva configuración de formato ER para generar informes en formato Word, debe seleccionar **Word** como el tipo de formato el cuadro de diálogo desplegable **Crear configuración** o dejar el campo **Tipo de formato** en blanco.</span><span class="sxs-lookup"><span data-stu-id="032b4-109">When you create a new ER format configuration to generate reports in Word format, you must either select **Word** as the format type in the **Create configuration** drop-down dialog box or leave the **Format type** field blank.</span></span>

![Crear una configuración de formato en la página Configuraciones](./media/er-design-configuration-word-image2.gif)

<span data-ttu-id="032b4-111">El componente de formato ER de la solución debe contener el elemento de formato **Excel\\Archivo**, y ese elemento de formato debe estar vinculado al documento de Word que se utilizará como plantilla para los informes generados en runtime.</span><span class="sxs-lookup"><span data-stu-id="032b4-111">The ER format component of the solution must contain the **Excel\\File** format element, and that format element must be linked to the Word document that will be used as the template for generated reports at runtime.</span></span> <span data-ttu-id="032b4-112">Para configurar el componente de formato ER, debe abrir el la versión de [borrador](general-electronic-reporting.md#component-versioning) de la configuración ER creada en el diseñador de formato ER.</span><span class="sxs-lookup"><span data-stu-id="032b4-112">To configure the ER format component, you must open the [draft](general-electronic-reporting.md#component-versioning) version of the created ER configuration in the ER format designer.</span></span> <span data-ttu-id="032b4-113">Después, agregue el elemento **Excel\\Archivo**, adjunte su plantilla de Word al formato ER editable y vincule esa plantilla al elemento **Excel\\Archivo** que agregó.</span><span class="sxs-lookup"><span data-stu-id="032b4-113">Then add the **Excel\\File** element, attach your Word template to the editable ER format, and link that template to the **Excel\\File** element that you added.</span></span>

> [!NOTE]
> <span data-ttu-id="032b4-114">Cuando adjunte una plantilla manualmente, debe usar un [tipo de documento](https://docs.microsoft.com/dynamics365/fin-ops-core/fin-ops/organization-administration/configure-document-management#configure-document-types) que se haya [configurado](electronic-reporting-er-configure-parameters.md#parameters-to-manage-documents) previamente para almacenar las plantillas de formatos ER.</span><span class="sxs-lookup"><span data-stu-id="032b4-114">When you attach a template, you must use a [document type](https://docs.microsoft.com/dynamics365/fin-ops-core/fin-ops/organization-administration/configure-document-management#configure-document-types) that has previously been [configured](electronic-reporting-er-configure-parameters.md#parameters-to-manage-documents) in the ER parameters to store templates of ER formats.</span></span>

![Adjuntar una plantilla en la página del diseñador de formato](./media/er-design-configuration-word-image3.gif)

<span data-ttu-id="032b4-116">Puede agregar los elementos anidados **Excel\\Rango** y **Excel\\Celda** para el elemento **Excel\\Archivo** para especificar la estructura de los datos que se introducirán en los informes generados en runtime.</span><span class="sxs-lookup"><span data-stu-id="032b4-116">You can add **Excel\\Range** and **Excel\\Cell** nested elements for the **Excel\\File** element to specify the structure of data that will be entered in generated reports at runtime.</span></span> <span data-ttu-id="032b4-117">Después, debe vincular esos elementos a los orígenes de datos del formato ER editable para especificar los datos reales que se introducirán en los informes generados en runtime.</span><span class="sxs-lookup"><span data-stu-id="032b4-117">You must then bind those elements to data sources of the editable ER format to specify the actual data that will be entered in generated reports at runtime.</span></span>

![Agregar elementos anidados en la página del diseñador de formato](./media/er-design-configuration-word-image4.gif)

<span data-ttu-id="032b4-119">Cuando guarda sus cambios en el formato ER a la hora de diseñar, la estructura jerárquica del formato se almacena en la plantilla de Word adjunta como un [elemento XML personalizado](https://docs.microsoft.com/visualstudio/vsto/custom-xml-parts-overview?view=vs-2019) que se llama **Informe**.</span><span class="sxs-lookup"><span data-stu-id="032b4-119">When you save your changes to the ER format at design time, the hierarchical format structure is stored in the attached Word template as a [custom XML part](https://docs.microsoft.com/visualstudio/vsto/custom-xml-parts-overview?view=vs-2019) that is named **Report**.</span></span> <span data-ttu-id="032b4-120">Debe acceder a la plantilla modificada, descargarla de Finance, almacenarla localmente y abrirla en la aplicación de escritorio de Word.</span><span class="sxs-lookup"><span data-stu-id="032b4-120">You must access the modified template, download it from Finance, store it locally, and open it in the Word desktop application.</span></span> <span data-ttu-id="032b4-121">La siguiente ilustración muestra la plantilla de ejemplo almacenada localmente para el informe de control que contiene el elemento XML personalizado **Informe**.</span><span class="sxs-lookup"><span data-stu-id="032b4-121">The following illustration shows the locally stored sample template for the control report that contains the **Report** custom XML part.</span></span>

![Obtener una vista previa de la plantilla de informe de ejemplo en la aplicación de escritorio de Word](./media/er-design-configuration-word-image5.gif)

<span data-ttu-id="032b4-123">Cuando los enlaces de los elementos de formato **Excel\\Rango** y **Excel\\Celda** se ejecutan en runtime, los datos que entrega cada enlace entran en el documento de Word generado como un campo individual del elemento XML personalizado **Informe**.</span><span class="sxs-lookup"><span data-stu-id="032b4-123">When bindings of **Excel\\Range** and **Excel\\Cell** format elements are run at runtime, the data that every binding delivers comes into the generated Word document as an individual field of the **Report** custom XML part.</span></span> <span data-ttu-id="032b4-124">Para introducir los valores de los campos del elemento XML personalizado en un documento generado, debe agregar los [controles de contenido](https://docs.microsoft.com/office/client-developer/word/content-controls-in-word) de Word apropiados a su plantilla de Word para que sirvan como marcadores de posición para los datos que se completarán en runtime.</span><span class="sxs-lookup"><span data-stu-id="032b4-124">To enter the values from the fields of the custom XML part in a generated document, you must add the appropriate Word [content controls](https://docs.microsoft.com/office/client-developer/word/content-controls-in-word) to your Word template to serve as placeholders for data that will be filled in at runtime.</span></span> <span data-ttu-id="032b4-125">Para especificar cómo se completan los controles de contenido, asigne cada control de contenido al campo apropiado del elemento XML personalizado **Informe**.</span><span class="sxs-lookup"><span data-stu-id="032b4-125">To specify how content controls are filled in, map every content control to the appropriate field of the **Report** custom XML part.</span></span>

![Agregar y asignar controles de contenido en la aplicación de escritorio de Word](./media/er-design-configuration-word-image6.gif)

<span data-ttu-id="032b4-127">Debe reemplazar la plantilla de Word original del formato ER editable con la plantilla modificada que ahora contiene controles de contenido de Word que se asignaron a los campos del elemento XML personalizado **Informe**.</span><span class="sxs-lookup"><span data-stu-id="032b4-127">You must then replace the original Word template of the editable ER format with the modified template that now contains Word content controls that were mapped to the fields of the **Report** custom XML part.</span></span>

![Sustituir la plantilla en la página del diseñador de formato](./media/er-design-configuration-word-image7.gif)

<span data-ttu-id="032b4-129">Cuando ejecuta el formato ER configurado, la plantilla de Word adjunta se utiliza para generar un nuevo informe.</span><span class="sxs-lookup"><span data-stu-id="032b4-129">When you run the configured ER format, the attached Word template is used to generate a new report.</span></span> <span data-ttu-id="032b4-130">Los datos reales se almacenan en el informe de Word como un elemento XML personalizado que se denomina **Informe**.</span><span class="sxs-lookup"><span data-stu-id="032b4-130">The actual data is stored in the Word report as a custom XML part that is named **Report**.</span></span> <span data-ttu-id="032b4-131">Cuando se abre el informe generado, los controles de contenido de Word se completan con datos del elemento XML personalizado **Informe**.</span><span class="sxs-lookup"><span data-stu-id="032b4-131">When the generated report is opened, the Word content controls are filled in with data from the **Report** custom XML part.</span></span>

## <a name="frequently-asked-questions"></a><span data-ttu-id="032b4-132">Preguntas frecuentes</span><span class="sxs-lookup"><span data-stu-id="032b4-132">Frequently asked questions</span></span>

<span data-ttu-id="032b4-133">**Pregunta:** He configurado un formato ER para imprimir un documento de Word que contiene la dirección de una empresa.</span><span class="sxs-lookup"><span data-stu-id="032b4-133">**Question:** I configured an ER format to print a Word document that contains a company address.</span></span> <span data-ttu-id="032b4-134">En la plantilla de Word para este formato ER, he insertado un control de contenido de texto enriquecido para presentar la dirección de una empresa.</span><span class="sxs-lookup"><span data-stu-id="032b4-134">In the Word template for this ER format, I inserted a rich text content control to present a company address.</span></span> <span data-ttu-id="032b4-135">En Finance, introduje la dirección de la empresa como texto de varias líneas y seleccioné **Introducir** para agregar un retorno de carro para cada línea que introduje.</span><span class="sxs-lookup"><span data-stu-id="032b4-135">In Finance, I entered the company address as multiline text and selected **Enter** to add a carriage return for every line that I entered.</span></span> <span data-ttu-id="032b4-136">Por lo tanto, espero que la dirección de la empresa aparezca como texto de varias líneas en los documentos generados.</span><span class="sxs-lookup"><span data-stu-id="032b4-136">Therefore, I expect the company address to appear as multiline text in generated documents.</span></span> <span data-ttu-id="032b4-137">Sin embargo, la dirección aparece como una sola línea de texto que contiene símbolos especiales en lugar de retornos de carro.</span><span class="sxs-lookup"><span data-stu-id="032b4-137">However, the address appears as a single line of text that contains special symbols instead of carriage returns.</span></span> <span data-ttu-id="032b4-138">¿Qué error hay en mi configuración?</span><span class="sxs-lookup"><span data-stu-id="032b4-138">What is wrong with my settings?</span></span>

<span data-ttu-id="032b4-139">**Respuesta:** En lugar de utilizar un control de contenido de texto enriquecido, debe utilizar un control de contenido de texto sin formato y seleccionar la casilla **Permitir retornos de carro (varios párrafos)** en las propiedades del control.</span><span class="sxs-lookup"><span data-stu-id="032b4-139">**Answer:** Instead of using a rich text content control, you must use a plain text content control and select the **Allow carriage returns (multiple paragraphs)** check box in the control's properties.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="032b4-140">Recursos adicionales</span><span class="sxs-lookup"><span data-stu-id="032b4-140">Additional resources</span></span>

- [<span data-ttu-id="032b4-141">Reutilizar las configuraciones de ER con plantillas de Excel para generar informes en formato Word</span><span class="sxs-lookup"><span data-stu-id="032b4-141">Reuse ER configurations with Excel templates to generate reports in Word format</span></span>](./tasks/er-design-configuration-word-2016-11.md)
- [<span data-ttu-id="032b4-142">Insertar imágenes y formas en los documentos generados con ER</span><span class="sxs-lookup"><span data-stu-id="032b4-142">Embed images and shapes in documents that you generate by using ER</span></span>](electronic-reporting-embed-images-shapes.md#embed-an-image-in-a-word-document)
