---
title: Crear una cuenta de almacenamiento en Azure y un almacén de claves
description: Este tema explica cómo crear una cuenta de almacenamiento de Azure y un almacén de claves.
author: gionoder
manager: AnnBe
ms.date: 09/22/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
ms.search.form: ''
audience: Application User
ms.reviewer: kfend
ms.search.scope: Core, Operations
ms.custom: 97423
ms.assetid: ''
ms.search.region: Global
ms.author: janeaug
ms.search.validFrom: 2020-07-08
ms.dyn365.ops.version: AX 10.0.12
ms.openlocfilehash: 5a883011bbff6d82504497d739c07f1ada9e5f69
ms.sourcegitcommit: d6250ee5ced43be39e789324a895fd1c07178935
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 10/19/2020
ms.locfileid: "4039778"
---
# <a name="create-an-azure-storage-account-and-a-key-vault"></a><span data-ttu-id="bd4b4-103">Crear una cuenta de almacenamiento en Azure y un almacén de claves</span><span class="sxs-lookup"><span data-stu-id="bd4b4-103">Create an Azure storage account and a key vault</span></span>

[!include [banner](../includes/banner.md)]



<span data-ttu-id="bd4b4-104">El servicio adicional de facturación electrónica asume la responsabilidad de almacenar todos sus datos comerciales en los recursos de Microsoft Azure que son propiedad de su empresa.</span><span class="sxs-lookup"><span data-stu-id="bd4b4-104">The Electronic invoicing add-on service takes responsibility for storing all your business data in the Microsoft Azure resources that are owned by your company.</span></span> <span data-ttu-id="bd4b4-105">Para asegurarse de que el servicio funcione correctamente y de que solo el complemento acceda a todos los datos comerciales necesarios y generados por el complemento de facturación electrónica, debe crear dos recursos principales de Azure:</span><span class="sxs-lookup"><span data-stu-id="bd4b4-105">To ensure that the service works correctly, and that all the business data that is needed for and generated by the Electronic invoicing add-on is accessed only by the add-on, you must create two main Azure resources:</span></span>

- <span data-ttu-id="bd4b4-106">Una cuenta de almacenamiento de Azure (Blob Storage) para almacenar facturas electrónicas</span><span class="sxs-lookup"><span data-stu-id="bd4b4-106">An Azure storage account (Blob storage) to store electronic invoices</span></span>
- <span data-ttu-id="bd4b4-107">Un almacén de claves de Azure para almacenar certificados y el identificador uniforme de recursos (URI) de la cuenta de almacenamiento</span><span class="sxs-lookup"><span data-stu-id="bd4b4-107">An Azure key vault to store certificates and the Uniform Resource Identifier (URI) of the storage account</span></span>

> [!NOTE]
> <span data-ttu-id="bd4b4-108">Se debe asignar un recurso de almacén de claves dedicado y un almacenamiento de blobs del cliente específicamente para su uso con el complemento de facturación electrónica.</span><span class="sxs-lookup"><span data-stu-id="bd4b4-108">A dedicated key vault resource and customer Blob storage must be allocated specifically for use with the Electronic invoicing add-on.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="bd4b4-109">Requisitos previos</span><span class="sxs-lookup"><span data-stu-id="bd4b4-109">Prerequisites</span></span>

<span data-ttu-id="bd4b4-110">Antes de que pueda completar los pasos de este tema, debe asegurarse de que se han completado las tareas siguientes:</span><span class="sxs-lookup"><span data-stu-id="bd4b4-110">Before you can complete the steps in this topic, you must make sure that the following tasks have been completed:</span></span>

- <span data-ttu-id="bd4b4-111">Crear un recurso de almacén de claves en Azure.</span><span class="sxs-lookup"><span data-stu-id="bd4b4-111">Create a key vault resource in Azure.</span></span> <span data-ttu-id="bd4b4-112">Para obtener información, vea [Acerca de Azure Key Vault](https://docs.microsoft.com/azure/key-vault/general/overview).</span><span class="sxs-lookup"><span data-stu-id="bd4b4-112">For more information, see [About Azure Key Vault](https://docs.microsoft.com/azure/key-vault/general/overview).</span></span>
- <span data-ttu-id="bd4b4-113">Cree una cuenta de Azure Storage (Blob Storage).</span><span class="sxs-lookup"><span data-stu-id="bd4b4-113">Create an Azure storage account (Blob storage).</span></span> <span data-ttu-id="bd4b4-114">Para más información, vea [Mantenimiento de la cuenta de Azure Storage](https://docs.microsoft.com/azure/storage/blobs/).</span><span class="sxs-lookup"><span data-stu-id="bd4b4-114">For more information, see [Maintaining Azure Storage Account](https://docs.microsoft.com/azure/storage/blobs/).</span></span>

## <a name="overview"></a><span data-ttu-id="bd4b4-115">Información general</span><span class="sxs-lookup"><span data-stu-id="bd4b4-115">Overview</span></span>

<span data-ttu-id="bd4b4-116">En este tema, completará dos pasos principales:</span><span class="sxs-lookup"><span data-stu-id="bd4b4-116">In this topic, you will complete two main steps:</span></span>

- <span data-ttu-id="bd4b4-117">Configure la cuenta de almacenamiento de Azure para obtener el URI de la cuenta de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="bd4b4-117">Set up the Azure storage account to get the storage account URI.</span></span>
- <span data-ttu-id="bd4b4-118">Configure el almacén de claves para almacenar el URI de la cuenta de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="bd4b4-118">Set up the key vault to store the storage account URI.</span></span>

## <a name="set-up-the-azure-storage-account-to-get-the-storage-account-uri"></a><span data-ttu-id="bd4b4-119">Configure la cuenta de almacenamiento de Azure para obtener el URI de la cuenta de almacenamiento</span><span class="sxs-lookup"><span data-stu-id="bd4b4-119">Set up the Azure storage account to get the storage account URI</span></span>

1. <span data-ttu-id="bd4b4-120">Abra la cuenta de almacenamiento que planea usar con el complemento de facturación electrónica.</span><span class="sxs-lookup"><span data-stu-id="bd4b4-120">Open the storage account that you plan to use with the Electronic invoicing add-on.</span></span>
2. <span data-ttu-id="bd4b4-121">Ir **Servicio blob** \> **Contenedores** y cree un nuevo contenedor.</span><span class="sxs-lookup"><span data-stu-id="bd4b4-121">Go to **Blob service** \> **Containers** , and create a new container.</span></span>
3. <span data-ttu-id="bd4b4-122">Introduzca un nombre para el contenedor y establezca el campo **Nivel de acceso público** en **Privado (sin acceso anónimo)**.</span><span class="sxs-lookup"><span data-stu-id="bd4b4-122">Enter a name for the container, and set the **Public access level** field to **Private (no anonymous access)**.</span></span>
4. <span data-ttu-id="bd4b4-123">Abra el contenedor y vaya a **Configuraciones \> Directiva de acceso**.</span><span class="sxs-lookup"><span data-stu-id="bd4b4-123">Open the container, and go to **Settings \> Access policy**.</span></span>
5. <span data-ttu-id="bd4b4-124">Seleccione **Agregar política** para agregar una política de acceso almacenada.</span><span class="sxs-lookup"><span data-stu-id="bd4b4-124">Select **Add policy** to add a stored access policy.</span></span>
6. <span data-ttu-id="bd4b4-125">Seleccione los campos **Identificador** y **Permisos** según corresponda.</span><span class="sxs-lookup"><span data-stu-id="bd4b4-125">Set the **Identifier** and **Permissions** fields as appropriate.</span></span> <span data-ttu-id="bd4b4-126">En el campo **Permisos** , debe seleccionar todos los permisos.</span><span class="sxs-lookup"><span data-stu-id="bd4b4-126">In the **Permissions** field, you should select all permissions.</span></span>

    ![Otorgar permiso de almacenamiento de blobs](media/e-Invoicing-services-create-azure-resources-grant-blob-permissions.png)

7. <span data-ttu-id="bd4b4-128">Ingrese las fechas de inicio y vencimiento.</span><span class="sxs-lookup"><span data-stu-id="bd4b4-128">Enter the start and expiry dates.</span></span> <span data-ttu-id="bd4b4-129">La fecha de caducidad debería ser futura.</span><span class="sxs-lookup"><span data-stu-id="bd4b4-129">The expiry date should be in future.</span></span>
8. <span data-ttu-id="bd4b4-130">Seleccione **Aceptar** para guardar la política y luego guardar los cambios en el contenedor.</span><span class="sxs-lookup"><span data-stu-id="bd4b4-130">Select **OK** to save the policy, and then save your changes to the container.</span></span>
9. <span data-ttu-id="bd4b4-131">Regrese a la cuenta de almacenamiento y abra **Explorador de almacenamiento (vista previa)**.</span><span class="sxs-lookup"><span data-stu-id="bd4b4-131">Return to the storage account, and open **Storage Explorer (preview)**.</span></span>
10. <span data-ttu-id="bd4b4-132">Haga clic con el botón derecho en el contenedor y luego seleccione **Obtener firma de acceso compartido**.</span><span class="sxs-lookup"><span data-stu-id="bd4b4-132">Right-click the container, and then select **Get Shared Access Signature**.</span></span>
11. <span data-ttu-id="bd4b4-133">En el cuadro de diálogo **Firma de acceso compartido** , copie y almacene el valor en el campo **URI**.</span><span class="sxs-lookup"><span data-stu-id="bd4b4-133">In the **Shared Access Signature** dialog box, copy and store the value in the **URI** field.</span></span> <span data-ttu-id="bd4b4-134">Este valor se utilizará en el siguiente procedimiento y se denominará *URI de firma de acceso compartido*.</span><span class="sxs-lookup"><span data-stu-id="bd4b4-134">This value will be used in the next procedure and will be referred to as the *shared access signature URI*.</span></span>

    ![Seleccionar y copiar el valor de URI](media/e-Invoicing-services-create-azure-resources-select-and-copy-uri.png)

## <a name="set-up-the-key-vault-to-store-the-storage-account-uri"></a><span data-ttu-id="bd4b4-136">Configure el almacén de claves para almacenar el URI de la cuenta de almacenamiento</span><span class="sxs-lookup"><span data-stu-id="bd4b4-136">Set up the key vault to store the storage account URI</span></span>

1. <span data-ttu-id="bd4b4-137">Abra el almacén de claves que tiene intención de usar con el complemento de facturación electrónica.</span><span class="sxs-lookup"><span data-stu-id="bd4b4-137">Open the key vault that you intend to use with the Electronic invoicing add-on.</span></span>
2. <span data-ttu-id="bd4b4-138">Ir **Configuraciones** \> **Misterios** y luego seleccione **Generar/Importar** para crear un nuevo secreto.</span><span class="sxs-lookup"><span data-stu-id="bd4b4-138">Go to **Settings** \> **Secrets** , and then select **Generate/Import** to create a new secret.</span></span>
3. <span data-ttu-id="bd4b4-139">En la página **Crea un secreto** , en el campo **Opciones de carga** , seleccione **Manual**.</span><span class="sxs-lookup"><span data-stu-id="bd4b4-139">On the **Create a secret** page, in the **Upload options** field, select **Manual**.</span></span>
4. <span data-ttu-id="bd4b4-140">Permite escribir el nombre del secreto.</span><span class="sxs-lookup"><span data-stu-id="bd4b4-140">Enter the name of the secret.</span></span> <span data-ttu-id="bd4b4-141">Este nombre se utilizará durante la configuración del servicio en el Servicio de configuración reguladora (RCS) y se denominará el *nombre secreto del almacén de claves*.</span><span class="sxs-lookup"><span data-stu-id="bd4b4-141">This name will be used during setup of the service in Regulatory Configuration Service (RCS) and will be referred to as the *key vault secret name*.</span></span>
5. <span data-ttu-id="bd4b4-142">En el campo **Valor** , seleccione **URI de firma de acceso compartido** y luego seleccione **Crear**.</span><span class="sxs-lookup"><span data-stu-id="bd4b4-142">In the **Value** field, select **Shared Access Signature URI** , and then select **Create**.</span></span>
6. <span data-ttu-id="bd4b4-143">Configure la política de acceso para otorgar al complemento de facturación electrónica el nivel correcto de acceso seguro al secreto que creó.</span><span class="sxs-lookup"><span data-stu-id="bd4b4-143">Set up the access policy to grant the Electronic invoicing add-on the correct level of secure access to the secret you created.</span></span> <span data-ttu-id="bd4b4-144">Ir **Configuraciones \> Política de acceso** y seleccione **Agregar política de acceso**.</span><span class="sxs-lookup"><span data-stu-id="bd4b4-144">Go to **Settings \> Access policy** , and select **Add Access Policy**.</span></span>
7. <span data-ttu-id="bd4b4-145">Establezca los permisos secretos para las operaciones **Obtener** y **Lista**.</span><span class="sxs-lookup"><span data-stu-id="bd4b4-145">Set the secret permissions for the **Get** and **List** operations.</span></span>

    ![Otorgar acceso al servicio](media/e-Invoicing-services-create-azure-resources-grant-service-access.png)

8. <span data-ttu-id="bd4b4-147">Establezca los permisos de certificado para las operaciones **Obtener** y **Lista**.</span><span class="sxs-lookup"><span data-stu-id="bd4b4-147">Set the certificate permissions for **Get** and **List** operations.</span></span>

    ![Otorgar permiso de certificado](media/e-Invoicing-services-create-azure-resources-grant-certificate-permission.png)

9. <span data-ttu-id="bd4b4-149">En el cuadro de diálogo **Principal** , seleccione el principal agregando **Complemento de facturación electrónica**.</span><span class="sxs-lookup"><span data-stu-id="bd4b4-149">In the **Principal** dialog box, select the principal by adding **Electronic invoicing add-on**.</span></span>
10. <span data-ttu-id="bd4b4-150">Seleccione **Agregar** y luego seleccione **Guardar cambios de Key Vault**.</span><span class="sxs-lookup"><span data-stu-id="bd4b4-150">Select **Add** , and then select **Save Key Vault changes**.</span></span>
11. <span data-ttu-id="bd4b4-151">En la página **Visión de conjunto** , copie el valor **Nombre DNS** para el almacén de claves.</span><span class="sxs-lookup"><span data-stu-id="bd4b4-151">On the **Overview** page, copy the **DNS name** value for the key vault.</span></span> <span data-ttu-id="bd4b4-152">Este valor se utilizará durante la configuración del servicio en RCS y se denominará *URI del almacén de claves*.</span><span class="sxs-lookup"><span data-stu-id="bd4b4-152">This value will be used during setup of the service in RCS and will be referred as the *key vault URI*.</span></span>
