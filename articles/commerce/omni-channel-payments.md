---
title: Información general de pagos omnicanal
description: Este tema proporciona una visión general de los pagos de omnicanal en Dynamics 365 Commerce.
author: rubendel
manager: AnnBe
ms.date: 09/17/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-365-retail
ms.technology: ''
audience: Application user
ms.reviewer: josaw
ms.custom: 141393
ms.assetid: ''
ms.search.region: Global
ms.search.industry: Retail
ms.author: rubendel
ms.search.validFrom: 2019-01-01
ms.dyn365.ops.version: AX 8.1.3
ms.openlocfilehash: 6ecfd518298021e08cf73934b450d175cf699a46
ms.sourcegitcommit: 38d40c331c8894acb7b119c5073e3088b54776c1
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 01/15/2021
ms.locfileid: "4985870"
---
# <a name="omni-channel-payments-overview"></a><span data-ttu-id="c539d-103">Información general de pagos omnicanal</span><span class="sxs-lookup"><span data-stu-id="c539d-103">Omni-channel payments overview</span></span>

[!include [banner](../includes/banner.md)]

<span data-ttu-id="c539d-104">Este tema proporciona una visión general de los pagos de omnicanal en Dynamics 365 Commerce.</span><span class="sxs-lookup"><span data-stu-id="c539d-104">This topic provides an overview of omni-channel payments in Dynamics 365 Commerce.</span></span> <span data-ttu-id="c539d-105">Incluye una lista completa de escenarios admitidos, información sobre funcionalidad, configuración, soluciones de problemas y las descripciones de problemas habituales.</span><span class="sxs-lookup"><span data-stu-id="c539d-105">It includes a comprehensive list of supported scenarios, information about functionality, setup, and troubleshooting, and descriptions of some typical issues.</span></span>

## <a name="key-terms"></a><span data-ttu-id="c539d-106">Términos clave</span><span class="sxs-lookup"><span data-stu-id="c539d-106">Key terms</span></span>

| <span data-ttu-id="c539d-107">Condición</span><span class="sxs-lookup"><span data-stu-id="c539d-107">Term</span></span> | <span data-ttu-id="c539d-108">Descripción</span><span class="sxs-lookup"><span data-stu-id="c539d-108">Description</span></span> |
|---|---|
| <span data-ttu-id="c539d-109">Token</span><span class="sxs-lookup"><span data-stu-id="c539d-109">Token</span></span> | <span data-ttu-id="c539d-110">Una cadena de datos que un procesador de pago proporciona como referencia.</span><span class="sxs-lookup"><span data-stu-id="c539d-110">A string of data that a payment processor provides as a reference.</span></span> <span data-ttu-id="c539d-111">Los tokens pueden representar los números de la tarjeta de pago, las autorizaciones de pago y las capturas anteriores del pago.</span><span class="sxs-lookup"><span data-stu-id="c539d-111">Tokens can represent payment card numbers, payment authorizations, and previous payment captures.</span></span> <span data-ttu-id="c539d-112">Los tokens son importantes pues ayudan a mantener datos confidenciales fuera del sistema de punto de venta (POS).</span><span class="sxs-lookup"><span data-stu-id="c539d-112">Tokens are important because they help keep sensitive data out of the point of sale (POS) system.</span></span> <span data-ttu-id="c539d-113">A veces también se conocen como *referencias*.</span><span class="sxs-lookup"><span data-stu-id="c539d-113">They are sometimes also referred to as *references*.</span></span> |
| <span data-ttu-id="c539d-114">Token de tarjeta</span><span class="sxs-lookup"><span data-stu-id="c539d-114">Card token</span></span> | <span data-ttu-id="c539d-115">Un token que un procesador de pago proporciona para el almacenamiento en el sistema POS.</span><span class="sxs-lookup"><span data-stu-id="c539d-115">A token that a payment processor provides for storage in the POS system.</span></span> <span data-ttu-id="c539d-116">Un token de tarjeta solo puede usarlo el comerciante que lo recibe.</span><span class="sxs-lookup"><span data-stu-id="c539d-116">A card token can be used only by the merchant who receives it.</span></span> <span data-ttu-id="c539d-117">Los tokens de tarjeta a veces también se conocen como *referencias de tarjeta*.</span><span class="sxs-lookup"><span data-stu-id="c539d-117">Card tokens are sometimes also referred to as *card references*.</span></span> |
| <span data-ttu-id="c539d-118">Token de autorización (auth)</span><span class="sxs-lookup"><span data-stu-id="c539d-118">Authorization (auth) token</span></span> | <span data-ttu-id="c539d-119">Identificador único que un proceso de pago proporciona como parte de la respuesta que envía a un sistema POS después de que el sistema POS haga una solicitud de autorización.</span><span class="sxs-lookup"><span data-stu-id="c539d-119">A unique ID that a payment process provides as part of the response that it sends to a POS system after the POS system makes an authorization request.</span></span> <span data-ttu-id="c539d-120">Un token de autorización se puede usar más adelante si llaman al procesador para realizar acciones como invertir o anular la autorización.</span><span class="sxs-lookup"><span data-stu-id="c539d-120">An authorization token can be used later if the processor is called to perform actions such as reversing or voiding the authorization.</span></span> <span data-ttu-id="c539d-121">Sin embargo, se usa más a menudo para capturar fondos al completar un pedido o finalizar una transacción.</span><span class="sxs-lookup"><span data-stu-id="c539d-121">However, it's most often used to capture funds when an order is fulfilled or a transaction is finalized.</span></span> <span data-ttu-id="c539d-122">Los tokens de autorización a veces también se conocen como *referencias de autorización*.</span><span class="sxs-lookup"><span data-stu-id="c539d-122">Authorization tokens are sometimes also referred to as *authorization references*.</span></span> |
| <span data-ttu-id="c539d-123">Token de captura</span><span class="sxs-lookup"><span data-stu-id="c539d-123">Capture token</span></span> | <span data-ttu-id="c539d-124">Una referencia que un procesador de pago proporciona a un sistema POS cuando finaliza o se obtiene un pago.</span><span class="sxs-lookup"><span data-stu-id="c539d-124">A reference that a payment processor provides to a POS system when a payment is finalized or captured.</span></span> <span data-ttu-id="c539d-125">El token de la captura se puede utilizar para hacer referencia a la captura de pago en operaciones posteriores, como solicitudes de devolución.</span><span class="sxs-lookup"><span data-stu-id="c539d-125">The capture token can then be used to reference the payment capture in subsequent operations, such as refund requests.</span></span> | 
| <span data-ttu-id="c539d-126">Tarjeta no presente</span><span class="sxs-lookup"><span data-stu-id="c539d-126">Card not present</span></span> | <span data-ttu-id="c539d-127">Un término que hace referencia a las transacciones de pago en que una tarjeta física no se muestra.</span><span class="sxs-lookup"><span data-stu-id="c539d-127">A term that refers to payment transactions where a physical card isn't presented.</span></span> <span data-ttu-id="c539d-128">Por ejemplo, estas transacciones se pueden aparecer en comercio electrónico o escenarios de centro de llamadas.</span><span class="sxs-lookup"><span data-stu-id="c539d-128">For example, these transactions can occur in e-commerce or call center scenarios.</span></span> <span data-ttu-id="c539d-129">Para estas transacciones, la información relacionada pago- se especifica manualmente en una página Web de comercio electrónico en un flujo de centro de llamadas o en el POS o terminal de pago.</span><span class="sxs-lookup"><span data-stu-id="c539d-129">For these transactions, the payment-related information is manually entered on an e-commerce website, in a call center flow, or on the POS or payment terminal.</span></span> |
| <span data-ttu-id="c539d-130">Tarjeta presente</span><span class="sxs-lookup"><span data-stu-id="c539d-130">Card present</span></span> | <span data-ttu-id="c539d-131">Un término que hace referencia a las transacciones de pago en una tarjeta física se mostrará y se usa en un terminal de pago que está conectado al sistema Microsoft Dynamics 365 POS.</span><span class="sxs-lookup"><span data-stu-id="c539d-131">A term that refers to payment transactions where a physical card is presented and used on a payment terminal that is connected to the Microsoft Dynamics 365 POS system.</span></span> |

## <a name="overview"></a><span data-ttu-id="c539d-132">Información general</span><span class="sxs-lookup"><span data-stu-id="c539d-132">Overview</span></span>

<span data-ttu-id="c539d-133">El término *pagos de omnicanal* describe la capacidad de crear un pedido en un canal y de satisfacerla en otro canal.</span><span class="sxs-lookup"><span data-stu-id="c539d-133">In general, the term *omni-channel payments* describes the ability to create an order in one channel and fulfill it in another channel.</span></span> <span data-ttu-id="c539d-134">La clave de compatibilidad de pago de omnicanal es mantener los detalles del pago así como el resto de los detalles de pedido y, a continuación usar esos detalles del pago cuando el pedido se recupere o se procesa en otro canal.</span><span class="sxs-lookup"><span data-stu-id="c539d-134">The key to omni-channel payment support is preserving payment details together with the rest of the order details, and then using those payment details when the order is recalled or processed in another channel.</span></span> <span data-ttu-id="c539d-135">Un ejemplo clásico es el escenario "Comprar en línea, recoger en la tienda".</span><span class="sxs-lookup"><span data-stu-id="c539d-135">A classic example is the "Buy online, pick up in store" scenario.</span></span> <span data-ttu-id="c539d-136">En esta situación se agregan los detalles del pago cuando el pedido se crea en línea.</span><span class="sxs-lookup"><span data-stu-id="c539d-136">In this scenario, the payment details are added when the order is created online.</span></span> <span data-ttu-id="c539d-137">A continuación se devuelven al sistema PDV para cargar la tarjeta de pago del cliente en el momento de recogida.</span><span class="sxs-lookup"><span data-stu-id="c539d-137">They are then recalled at the POS to charge the customer's payment card at the time of pickup.</span></span> 

<span data-ttu-id="c539d-138">Todas las situaciones que se describen en este tema se pueden implementar mediante el kit de desarrollo de software estándar (SDK) de los pagos que se ofrece con Commerce.</span><span class="sxs-lookup"><span data-stu-id="c539d-138">All the scenarios that are described in this topic can be implemented by using the standard Payments software development kit (SDK) that is provided with Commerce.</span></span> <span data-ttu-id="c539d-139">El [Conector de pago de Dynamics 365 para Adyen](https://docs.microsoft.com/dynamics365/unified-operations/retail/dev-itpro/adyen-connector?tabs=8-1-3) ofrece una implementación del componente estándar de cada escenario que se describe aquí.</span><span class="sxs-lookup"><span data-stu-id="c539d-139">The [Dynamics 365 Payment Connector for Adyen](https://docs.microsoft.com/dynamics365/unified-operations/retail/dev-itpro/adyen-connector?tabs=8-1-3) provides an out-of-box implementation of every scenario that is described here.</span></span> 

### <a name="prerequisites"></a><span data-ttu-id="c539d-140">Requisitos previos</span><span class="sxs-lookup"><span data-stu-id="c539d-140">Prerequisites</span></span>

<span data-ttu-id="c539d-141">Cada escenario que se describe en este tema requiere un conector de pago que admita pagos de omnicanal.</span><span class="sxs-lookup"><span data-stu-id="c539d-141">Every scenario that is described in this topic requires a payment connector that supports omni-channel payments.</span></span> <span data-ttu-id="c539d-142">El conector de Adyen también está listo para usarse, ya que admite escenarios que estará disponible con los pagos SDK.</span><span class="sxs-lookup"><span data-stu-id="c539d-142">The out-of-box Adyen connector can also be used, because it supports the scenarios that are made available through the Payments SDK.</span></span> <span data-ttu-id="c539d-143">Para obtener más información sobre la implementación los conectores de pago, y sobre la SDK de Retail en general, visite [Página principal de Retail para profesionales de TI y desarrolladores](https://docs.microsoft.com/dynamics365/unified-operations/retail/dev-itpro/dev-retail-home-page#payment-connectors).</span><span class="sxs-lookup"><span data-stu-id="c539d-143">For more information about how to implement payment connectors, and about the Retail SDK in general, visit the [Retail for IT pros and developers home page](https://docs.microsoft.com/dynamics365/unified-operations/retail/dev-itpro/dev-retail-home-page#payment-connectors).</span></span>

#### <a name="supported-versions"></a><span data-ttu-id="c539d-144">Versiones admitidas</span><span class="sxs-lookup"><span data-stu-id="c539d-144">Supported versions</span></span>

<span data-ttu-id="c539d-145">Las capacidades de pago de omnicanal que se describen en este tema se publicaron como parte de la versión 8.1.3 de Microsoft Dynamics 365 for Retail.</span><span class="sxs-lookup"><span data-stu-id="c539d-145">The omni-channel payment capabilities that are described in this topic were released as part of Microsoft Dynamics 365 for Retail version 8.1.3.</span></span> 

#### <a name="card-present-and-card-not-present-connectors"></a><span data-ttu-id="c539d-146">Conectores "Tarjeta presente" y "Tarjeta ausente"</span><span class="sxs-lookup"><span data-stu-id="c539d-146">"Card present" and "card not present" connectors</span></span>

<span data-ttu-id="c539d-147">Los pagos SDK dependen de dos conjuntos de interfaces de programación de aplicaciones (APIs) para los pagos.</span><span class="sxs-lookup"><span data-stu-id="c539d-147">The Payments SDK relies on two sets of application programming interfaces (APIs) for payments.</span></span> <span data-ttu-id="c539d-148">El primer conjunto de API se llama **iPaymentProcessor**.</span><span class="sxs-lookup"><span data-stu-id="c539d-148">The first set of APIs is named **iPaymentProcessor**.</span></span> <span data-ttu-id="c539d-149">Se usaba para implementar conectores de pago de "tarjeta ausente” que se pueden usar en los centros de llamadas y con la plataforma de comercio electrónico Microsoft Dynamics.</span><span class="sxs-lookup"><span data-stu-id="c539d-149">It's used to implement "card not present" payment connectors that can be used in call centers and with the Microsoft Dynamics e-Commerce platform.</span></span> <span data-ttu-id="c539d-150">Para obtener más información acerca de la interfaz **iPaymentProcessor**, consulte la documentación [Implementar un conector de pago y un dispositivo de pago](https://download.microsoft.com/download/e/2/7/e2735c65-1e66-4b8d-8a3c-e6ef3a319137/The%20Guide%20to%20Implementing%20Payment%20Connector%20and%20Payment%20Device_update.pdf) que cubre los pagos.</span><span class="sxs-lookup"><span data-stu-id="c539d-150">For more information about the **iPaymentProcessor** interface, see the [Implement a payment connector and a payment device](https://download.microsoft.com/download/e/2/7/e2735c65-1e66-4b8d-8a3c-e6ef3a319137/The%20Guide%20to%20Implementing%20Payment%20Connector%20and%20Payment%20Device_update.pdf) white paper, which covers payments.</span></span> 

<span data-ttu-id="c539d-151">El segundo conjunto de API se llama **iNamedRequestHandler**.</span><span class="sxs-lookup"><span data-stu-id="c539d-151">The second set of APIs is named **iNamedRequestHandler**.</span></span> <span data-ttu-id="c539d-152">Admite la implementación de las integraciones de pagos de "tarjeta presente“que usa un terminal de pago.</span><span class="sxs-lookup"><span data-stu-id="c539d-152">It supports the implementation of "card present" payment integrations that use a payment terminal.</span></span> <span data-ttu-id="c539d-153">Para obtener más información acerca de la interfaz **iNamedRequestHandler**, consulte [Crear una integración de pago para un terminal de pago](https://docs.microsoft.com/dynamics365/unified-operations/retail/dev-itpro/end-to-end-payment-extension).</span><span class="sxs-lookup"><span data-stu-id="c539d-153">For more information about the **iNamedRequestHandler** interface, see [Create a payment integration for a payment terminal](https://docs.microsoft.com/dynamics365/unified-operations/retail/dev-itpro/end-to-end-payment-extension).</span></span> 

### <a name="setup-and-configuration"></a><span data-ttu-id="c539d-154">Establecimiento y configuración</span><span class="sxs-lookup"><span data-stu-id="c539d-154">Setup and configuration</span></span>

<span data-ttu-id="c539d-155">Los siguientes componentes y pasos de configuración son necesarios:</span><span class="sxs-lookup"><span data-stu-id="c539d-155">The following components and setup steps are required:</span></span>

- <span data-ttu-id="c539d-156">**Integración de comercio electrónico:** la integración con Commerce se requiere para admitir los escenarios donde un pedido se origina en un escaparate en línea.</span><span class="sxs-lookup"><span data-stu-id="c539d-156">**eCommerce integration:** An integration with Commerce is required to support scenarios where an order originates in an online storefront.</span></span> <span data-ttu-id="c539d-157">Para obtener más información acerca del SDK del comercio electrónico de Retail, consulte [Kit de desarrollo de software (SDK) de la plataforma de comercio electrónico](https://docs.microsoft.com/dynamics365/unified-operations/retail/dev-itpro/ecommerce-platform-sdk).</span><span class="sxs-lookup"><span data-stu-id="c539d-157">For more information about the Retail e-Commerce SDK, see [e-Commerce platform software development kit (SDK)](https://docs.microsoft.com/dynamics365/unified-operations/retail/dev-itpro/ecommerce-platform-sdk).</span></span> <span data-ttu-id="c539d-158">En un entorno de demostración, el escaparate de referencia admite escenarios de pago de omnicanal.</span><span class="sxs-lookup"><span data-stu-id="c539d-158">In a demo environment, the reference storefront supports omni-channel payment scenarios.</span></span> 
- <span data-ttu-id="c539d-159">**Configuración de los pagos en línea:** la configuración del canal conectado debe incluir un conector de pago que se ha actualizado para admitir pagos de omnicanal.</span><span class="sxs-lookup"><span data-stu-id="c539d-159">**Online payments configuration:** The setup of the online channel must include a payment connector that has been updated to support omni-channel payments.</span></span> <span data-ttu-id="c539d-160">Como alternativa, puede usar el conector de pago tal cual.</span><span class="sxs-lookup"><span data-stu-id="c539d-160">Alternatively, the out-of-box payment connector can be used.</span></span> <span data-ttu-id="c539d-161">Para obtener información sobre cómo configurar el conector de pago Adyen para tiendas en línea, consulte [Conector de pago de Adyen](https://docs.microsoft.com/dynamics365/unified-operations/retail/dev-itpro/adyen-connector?tabs=8-1-3#e-commerce).</span><span class="sxs-lookup"><span data-stu-id="c539d-161">For information about how to configure the Adyen payment connector for online stores, see [Adyen payment connector](https://docs.microsoft.com/dynamics365/unified-operations/retail/dev-itpro/adyen-connector?tabs=8-1-3#e-commerce).</span></span> <span data-ttu-id="c539d-162">Además de los pasos de configuración del comercio electrónico que se describen en este tema, el parámetro **Permitir guardar de la información de pago en comercio electrónico** se debe establecer en **Verdad** en la configuración del conector Adyen.</span><span class="sxs-lookup"><span data-stu-id="c539d-162">In addition to the eCommerce setup steps that are described in that topic, the **Allow saving payment information in e-commerce** parameter must be set to **True** in the settings for the Adyen connector.</span></span> 
- <span data-ttu-id="c539d-163">**Configuración de pagos de omnicanal:** en la oficina administrativa, vaya a **Retail y Commerce \> Configuración de sede \> Parámetros \> Parámetros compartidos de Commerce**.</span><span class="sxs-lookup"><span data-stu-id="c539d-163">**Omni-channel payments configuration:** In the back office, go to **Retail and Commerce \> Headquarters setup \> Parameters \> Commerce shared parameters**.</span></span> <span data-ttu-id="c539d-164">A continuación, en la pestaña **Pagos de omnicanal**, establezca la opción **Usar pagos omnicanal** en **Sí**.</span><span class="sxs-lookup"><span data-stu-id="c539d-164">Then, on the **Omni-channel payments** tab, set the **Use omni-channel payments** option to **Yes**.</span></span> <span data-ttu-id="c539d-165">En las versiones 10.0.12 y posteriores de Commerce, esta configuración está en el espacio de trabajo **Administración de características**.</span><span class="sxs-lookup"><span data-stu-id="c539d-165">In Commerce versions 10.0.12 and later, this setting is in the **Feature Management** workspace.</span></span> <span data-ttu-id="c539d-166">Seleccione la característica **Pagos omnicanal** y haga clic **Habilitar ahora**.</span><span class="sxs-lookup"><span data-stu-id="c539d-166">Select the **Omni-channel payments** feature and click **Enable now**.</span></span> 
- <span data-ttu-id="c539d-167">**Servicios de pago:** el centro de llamadas usa el conector de pago predeterminado en la página **Servicios de pago** para procesar los pagos.</span><span class="sxs-lookup"><span data-stu-id="c539d-167">**Payment services:** The call center uses the default payment connector on the **Payment services** page to process payments.</span></span> <span data-ttu-id="c539d-168">Para admitir escenarios como “Comprar en centro de llamadas, recoger en tienda,” este conector de pago predeterminado debe ser el conector de pago Adyen o un conector de pago que cumple con los requisitos de implementación de los pagos de omnicanal.</span><span class="sxs-lookup"><span data-stu-id="c539d-168">To support scenarios such as "Buy in call center, pick up in store," this default payment connector must be the Adyen payment connector or a payment connector that meets the implementation requirements for omni-channel payments.</span></span>
- <span data-ttu-id="c539d-169">**Servicio EFT:** los pagos a través de un terminal de pago se deben configurar en la ficha desplegable **Servicio EFT** del perfil de hardware.</span><span class="sxs-lookup"><span data-stu-id="c539d-169">**EFT service:** Payments through a payment terminal must be set up on the **EFT service** FastTab of the hardware profile.</span></span> <span data-ttu-id="c539d-170">El connector de Adyen admite escenarios de pagos omnicanal listos para usarse.</span><span class="sxs-lookup"><span data-stu-id="c539d-170">The Adyen connector supports omni-channel payments scenarios out of the box.</span></span> <span data-ttu-id="c539d-171">Otros conectores de pago que admiten la interfaz **iNamedRequestHandler** también pueden usarse si admiten pagos omnicanal.</span><span class="sxs-lookup"><span data-stu-id="c539d-171">Other payment connectors that support the **iNamedRequestHandler** interface can also be used if they support omni-channel payments.</span></span>
- <span data-ttu-id="c539d-172">**Disponibilidad de conector de pago:** cuando se recuperar un pedido, las líneas de la propuesta de pago que se vuelven a llamar junto con la inclusión del pedido el nombre del conector de pago usado para crear las autorizaciones que están asociados a este orden.</span><span class="sxs-lookup"><span data-stu-id="c539d-172">**Payment connector availability:** When an order is recalled, the payment tender lines that are recalled together with the order include the name of the payment connector that was used to create the authorizations that are associated with that order.</span></span> <span data-ttu-id="c539d-173">Cuando se cumple el pedido, el SDK de los pagos intentará usar el mismo conector usado para crear la autorización original.</span><span class="sxs-lookup"><span data-stu-id="c539d-173">When the order is fulfilled, the Payments SDK tries to use the same connector that was used to create the original authorization.</span></span> <span data-ttu-id="c539d-174">Por lo tanto, un conector de pago con las mismas propiedades mercantil debe estar disponible para la captura.</span><span class="sxs-lookup"><span data-stu-id="c539d-174">Therefore, a payment connector that has the same merchant properties must be available for capture.</span></span> 
- <span data-ttu-id="c539d-175">**Tipos de tarjeta:** para que las escenarios de omnicanal funcionen correctamente, cada canal debe tener la misma configuración para los tipos de forma de pago que se pueden usar para el omnicanal.</span><span class="sxs-lookup"><span data-stu-id="c539d-175">**Card types:** For omni-channel scenarios to work properly, each channel must have the same setup for tender types that can be used for omni-channel.</span></span> <span data-ttu-id="c539d-176">Esta configuración incluye identificadores de método de pago y tipo de tarjeta.</span><span class="sxs-lookup"><span data-stu-id="c539d-176">This setup includes payment method IDs and card type IDs.</span></span> <span data-ttu-id="c539d-177">Por ejemplo, si el tipo de forma de pago **Tarjetas** tiene un identificador **2** en la configuración de la tienda en línea, debe tener el mismo identificador en la configuración de la tienda minorista.</span><span class="sxs-lookup"><span data-stu-id="c539d-177">For example, if the **Cards** tender type has an ID of **2** in the online store setup, it should have the same ID in the retail store setup.</span></span> <span data-ttu-id="c539d-178">El mismo requisito se aplica a los identificadores de tipo de tarjeta.</span><span class="sxs-lookup"><span data-stu-id="c539d-178">The same requirement applies to card type IDs.</span></span> <span data-ttu-id="c539d-179">Si el número de tarjeta **12** se establece en **VISA** en la tienda en línea, el mismo identificador se debe configurar para la tienda al por menor.</span><span class="sxs-lookup"><span data-stu-id="c539d-179">If card number **12** is set to **VISA** in the online store, the same ID should be set up for the retail store.</span></span> 
- <span data-ttu-id="c539d-180">Retail Modern POS para Windows o Android con una estación de hardware integrada o</span><span class="sxs-lookup"><span data-stu-id="c539d-180">The Retail Modern POS for Windows or Android with built-in hardware station   -or-</span></span>
- <span data-ttu-id="c539d-181">Modern POS para iOS o Cloud POS con estación de hardware compartida conectada.</span><span class="sxs-lookup"><span data-stu-id="c539d-181">Modern POS for iOS or Cloud POS with connected shared hardware station.</span></span> 

### <a name="basic-principle-supporting-omni-channel-payments"></a><span data-ttu-id="c539d-182">Principio básico que admite pagos de omnicanal</span><span class="sxs-lookup"><span data-stu-id="c539d-182">Basic principle supporting omni-channel payments</span></span>

<span data-ttu-id="c539d-183">Los conectores de pago y los procesadores de pago usan tokens, o referencias, para hacer referencia a las interacciones relacionados con los pagos de tarjeta.</span><span class="sxs-lookup"><span data-stu-id="c539d-183">Payment connectors and payment processors use tokens, or references, to reference interactions that are related to card payments.</span></span> <span data-ttu-id="c539d-184">Por ejemplo, cuando se requiera una autorización de pago, se proporciona una referencia a la autorización.</span><span class="sxs-lookup"><span data-stu-id="c539d-184">For example, when a payment authorization is requested, a reference to that authorization is provided.</span></span> <span data-ttu-id="c539d-185">Por lo tanto, la autorización se puede referenciar más adelante, cuando los fondos se capturan a la hora de cumplimiento.</span><span class="sxs-lookup"><span data-stu-id="c539d-185">Therefore, the authorization can be referenced later, when funds are captured at the time of fulfillment.</span></span> <span data-ttu-id="c539d-186">Esta autorización es exclusiva el comerciante, el conector de pago y el procesador.</span><span class="sxs-lookup"><span data-stu-id="c539d-186">This authorization is unique to the merchant, payment connector, and processor.</span></span> 

<span data-ttu-id="c539d-187">Si un pedido que se creó en línea se está cogiendo en el almacén, los mismos datos de pago para dicho pedido se deben recuperar y utilizar.</span><span class="sxs-lookup"><span data-stu-id="c539d-187">If an order that was created online is being picked up in the store, the same payment details for that order must be recalled and used.</span></span> <span data-ttu-id="c539d-188">Cuando los detalles originales se proporcionan como parte de la solicitud para capturar un pago con la autorización original, el procesador de pago podrá gestionar la solicitud y capturar el pago.</span><span class="sxs-lookup"><span data-stu-id="c539d-188">When the original details are provided as part of the request to capture a payment against the original authorization, the payment processor will be able to handle the request and capture the payment.</span></span> 

<span data-ttu-id="c539d-189">Para hacer referencia correctamente el pedido en línea, el conector de pago de "tarjeta ausente" que admite el mismo procesador debe también estar disponible.</span><span class="sxs-lookup"><span data-stu-id="c539d-189">To correctly reference the online order, a "card not present" payment connector that supports the same processor must also be available.</span></span> <span data-ttu-id="c539d-190">De esta manera, el sistema PDV puede tener un procesador para los pagos "tarjeta presente“, pero puede acceder a otros conectores de pago de modo que pueda cumplir los pedidos creados en otros mediante varios canales procesadores de pago.</span><span class="sxs-lookup"><span data-stu-id="c539d-190">In this way, the POS system can have one processor for "card present" payments, but it can also have access to other payment connectors so that it can fulfill orders that are created in other channels by using different payment processors.</span></span> 

## <a name="supported-scenarios"></a><span data-ttu-id="c539d-191">Escenarios admitidos</span><span class="sxs-lookup"><span data-stu-id="c539d-191">Supported scenarios</span></span>

<span data-ttu-id="c539d-192">Se admiten los siguientes escenarios de pago de omnicanal:</span><span class="sxs-lookup"><span data-stu-id="c539d-192">The following omni-channel payment scenarios are supported:</span></span>

- <span data-ttu-id="c539d-193">Comprar en línea, recoger en la tienda</span><span class="sxs-lookup"><span data-stu-id="c539d-193">Buy online, pick up in store</span></span>
- <span data-ttu-id="c539d-194">Comprar en el centro de llamadas, recoger en la tienda</span><span class="sxs-lookup"><span data-stu-id="c539d-194">Buy in call center, pick up in store</span></span>
- <span data-ttu-id="c539d-195">Comprar en la tienda A, recoger en la tienda B</span><span class="sxs-lookup"><span data-stu-id="c539d-195">Buy in store A, pick up in store B</span></span>
- <span data-ttu-id="c539d-196">Comprar en la tienda A, enviar al cliente</span><span class="sxs-lookup"><span data-stu-id="c539d-196">Buy in store A, ship to customer</span></span>

    > [!NOTE]
    > <span data-ttu-id="c539d-197">Los pagos realizados en el centro de llamadas que se asignan a la función de pago "Normal" deben marcarse como **Pagar por adelantado** = **Sí** para que se reflejen en el importe adeudado al retirar el pedido en el PDV.</span><span class="sxs-lookup"><span data-stu-id="c539d-197">Payments made in the call center that map to the "Normal" payment function must be marked as **Prepay** = **Yes** to be reflected in the amount due when recalling the order in the POS.</span></span> <span data-ttu-id="c539d-198">Los pagos sin prepago de tipo "Normal" no se reconocen cuando se retira el pedido en el PDV.</span><span class="sxs-lookup"><span data-stu-id="c539d-198">Non-prepay payments of type "Normal" are not recognized when the order is recalled in POS.</span></span> 

<span data-ttu-id="c539d-199">Las variaciones de estos casos también se admiten.</span><span class="sxs-lookup"><span data-stu-id="c539d-199">Variations of these scenarios are also supported.</span></span> <span data-ttu-id="c539d-200">Por ejemplo, un pedido en línea puede incluir ambas líneas que se registrarán en el cliente y las líneas que se recogerán en una tienda.</span><span class="sxs-lookup"><span data-stu-id="c539d-200">For example, an online order might include both lines that will be shipped to the customer and lines that will be picked up in a store.</span></span> <span data-ttu-id="c539d-201">Todas las opciones de cumplimiento de pedido se admiten a través de pagos de omnicanal.</span><span class="sxs-lookup"><span data-stu-id="c539d-201">All order fulfillment options are supported via omni-channel payments.</span></span> 

<span data-ttu-id="c539d-202">En las secciones siguientes se describen los pasos para cada escenario y se presenta cómo trabajar con la situación de ejemplo con datos de prueba.</span><span class="sxs-lookup"><span data-stu-id="c539d-202">The following sections describe the steps for each scenario and show how to run the scenario by using demo data.</span></span> 

### <a name="buy-online-pick-up-in-store"></a><span data-ttu-id="c539d-203">Comprar en línea, recoger en la tienda</span><span class="sxs-lookup"><span data-stu-id="c539d-203">Buy online, pick up in store</span></span>

<span data-ttu-id="c539d-204">Antes de empezar, asegúrese de que se cumplan los siguientes requisitos previos:</span><span class="sxs-lookup"><span data-stu-id="c539d-204">Before you start, make sure that the following prerequisites are in place:</span></span>

- <span data-ttu-id="c539d-205">Tiene un escaparate de referencia donde se configura el conector Adyen.</span><span class="sxs-lookup"><span data-stu-id="c539d-205">You have a reference storefront where the Adyen connector is configured.</span></span>
- <span data-ttu-id="c539d-206">La opción **Pagos de omnicanal** en la página **Parámetros compartidos de Commerce** se establece en **Verdadero**.</span><span class="sxs-lookup"><span data-stu-id="c539d-206">The **Omni-channel payments** option on the **Commerce shared parameters** page is set to **True**.</span></span> <span data-ttu-id="c539d-207">En versiones posteriores, esta característica se pasa al espacio de trabajo **Administración de características** donde puede seleccionar la característica **Pagos omnicanal** característica y hacer clic en **Habilitar ahora**.</span><span class="sxs-lookup"><span data-stu-id="c539d-207">In later versions this settng is moved to the **Feature Management** workspace where you can select the **Omni-channel payments** feature and click **Enable now**.</span></span> 
- <span data-ttu-id="c539d-208">El connector de pago de Adyen está configurado para el registro de Houston PDV.</span><span class="sxs-lookup"><span data-stu-id="c539d-208">The Adyen payment connector is configured for the Houston POS register.</span></span>
- <span data-ttu-id="c539d-209">Retail Modern POS para Windows o Android con una estación de hardware integrada o</span><span class="sxs-lookup"><span data-stu-id="c539d-209">The Retail Modern POS for Windows or Android with built-in hardware station   -or-</span></span>
- <span data-ttu-id="c539d-210">Modern POS para iOS o Cloud POS con estación de hardware compartida conectada.</span><span class="sxs-lookup"><span data-stu-id="c539d-210">Modern POS for iOS or Cloud POS with connected shared hardware station.</span></span> 

<span data-ttu-id="c539d-211">Para ejecutar el escenario, siga estos pasos:</span><span class="sxs-lookup"><span data-stu-id="c539d-211">Follow these steps to run the scenario.</span></span>

1. <span data-ttu-id="c539d-212">En el escaparate de referencia, cree un pedido para la recogida en almacén.</span><span class="sxs-lookup"><span data-stu-id="c539d-212">In the reference storefront, create an order for in-store pickup.</span></span> <span data-ttu-id="c539d-213">Asegúrese de seleccionar la tienda **Houston**.</span><span class="sxs-lookup"><span data-stu-id="c539d-213">Be sure to select the **Houston** store.</span></span> 
2. <span data-ttu-id="c539d-214">Pase a través de los pasos de finalización de la compra y pague usando un número de tarjeta de crédito de prueba.</span><span class="sxs-lookup"><span data-stu-id="c539d-214">Go through the checkout steps, and pay by using a test credit card number.</span></span> <span data-ttu-id="c539d-215">Puede encontrar números de tarjeta de crédito de prueba en [Página de números de tarjeta de prueba de Adyen](https://docs.adyen.com/development-resources/test-cards/test-card-numbers/#description).</span><span class="sxs-lookup"><span data-stu-id="c539d-215">You can find test credit card numbers on the [Adyen test card numbers page](https://docs.adyen.com/development-resources/test-cards/test-card-numbers/#description).</span></span>
3. <span data-ttu-id="c539d-216">En Commerce, utilice el trabajo por lotes **Sincronizar los pedidos** y la programación de la distribución **P-001** para crear los pedidos en el área de operaciones.</span><span class="sxs-lookup"><span data-stu-id="c539d-216">In Commerce, use the **Synchronize orders** batch job and the **P-001** distribution schedule to create the orders in the back office.</span></span>
4. <span data-ttu-id="c539d-217">En el PDV, en la página de inicio, seleccione la operación **Pedidos a recoger** para ver los pedidos para recoger en el almacén.</span><span class="sxs-lookup"><span data-stu-id="c539d-217">In the POS, on the welcome page, select the **Orders to pickup** operation to see the orders for in-store pickup.</span></span> 
5. <span data-ttu-id="c539d-218">Seleccione una o más líneas del pedido que se ha creado en el escaparate de referencia y, a continuación seleccione **Recoger**.</span><span class="sxs-lookup"><span data-stu-id="c539d-218">Select one or more lines from the order that was created in the reference storefront, and then select **Pick up**.</span></span>

    <span data-ttu-id="c539d-219">El pedido se recupera de la oficina administrativa.</span><span class="sxs-lookup"><span data-stu-id="c539d-219">The order is retrieved from the back office.</span></span> 

6. <span data-ttu-id="c539d-220">Cuando los detalles de la línea de pedido se recuperan de la oficina y se detecta un pago de tarjeta que se puede usar para el omnicanal, se le informará de que un método de pago está disponible.</span><span class="sxs-lookup"><span data-stu-id="c539d-220">When the order line details are retrieved from the back office, and a card payment that can be used for omni-channel is detected, you're informed that a payment method is available.</span></span>
7. <span data-ttu-id="c539d-221">Seleccione **Usar método de pago disponible** para completar la transacción mediante los detalles de la tarjeta que se especificaron en el escaparate de referencia.</span><span class="sxs-lookup"><span data-stu-id="c539d-221">Select **Use available payment method** to complete the transaction by using the card details that were entered in the reference storefront.</span></span>

    <span data-ttu-id="c539d-222">Las líneas de pedido se cargan en la página de la transacción, y el saldo pendiente es 0 (cero).</span><span class="sxs-lookup"><span data-stu-id="c539d-222">The order lines are loaded on the transaction page, and the balance due is 0 (zero).</span></span> 

8. <span data-ttu-id="c539d-223">Seleccione la pestaña **Pagos** para la línea de pago que se sacó del pedido en línea.</span><span class="sxs-lookup"><span data-stu-id="c539d-223">Select the **Payments** tab to view the tender line that was pulled from the online order.</span></span> 
9. <span data-ttu-id="c539d-224">Seleccione cualquier método de pago para completar la transacción.</span><span class="sxs-lookup"><span data-stu-id="c539d-224">Select any payment method to complete the transaction.</span></span> 

### <a name="buy-in-call-center-pick-up-in-store"></a><span data-ttu-id="c539d-225">Comprar en el centro de llamadas, recoger en la tienda</span><span class="sxs-lookup"><span data-stu-id="c539d-225">Buy in call center, pick up in store</span></span>

1. <span data-ttu-id="c539d-226">En Commerce, en la página **Servicio al cliente**, especifique **Karen Berg** en la barra de búsqueda y, a continuación, seleccione **Buscar**.</span><span class="sxs-lookup"><span data-stu-id="c539d-226">In Commerce, on the **Customer service** page, enter **Karen Berg** in the search bar, and then select **Search**.</span></span> 
3. <span data-ttu-id="c539d-227">Seleccione **Karen Berg** en los resultados de la búsqueda.</span><span class="sxs-lookup"><span data-stu-id="c539d-227">Select **Karen Berg** in the search results.</span></span>
4. <span data-ttu-id="c539d-228">Una vez que Karen se carga sobre la página **Servicio al cliente**, seleccione **Nuevo pedido de ventas**.</span><span class="sxs-lookup"><span data-stu-id="c539d-228">After Karen is loaded onto the **Customer service** page, select **New sales order**.</span></span>
5. <span data-ttu-id="c539d-229">En la nueva página del pedido de ventas, seleccione **Encabezado** para ver el encabezado del pedido.</span><span class="sxs-lookup"><span data-stu-id="c539d-229">On the new sales order page, select **Header** to view the order header.</span></span> 
6. <span data-ttu-id="c539d-230">En la página **Encabezado del pedido**, establezca el sitio en **Central** y el almacén en **Houston**.</span><span class="sxs-lookup"><span data-stu-id="c539d-230">On the **Order header** page, set the site to **Central** and the warehouse to **Houston**.</span></span>
7. <span data-ttu-id="c539d-231">En la pestaña **Entrega**, establezca el campo **Modo de entrega** a **60** para la recogida del cliente.</span><span class="sxs-lookup"><span data-stu-id="c539d-231">On the **Deliver** tab, set the **Mode of delivery** field to **60** for customer pickup.</span></span>
8. <span data-ttu-id="c539d-232">Seleccione **Líneas**, y luego agregue una o más líneas al pedido.</span><span class="sxs-lookup"><span data-stu-id="c539d-232">Select **Lines**, and then add one or more lines to the order.</span></span> 
9. <span data-ttu-id="c539d-233">Seleccione **Completar** para especificar el flujo de la finalización del pedido.</span><span class="sxs-lookup"><span data-stu-id="c539d-233">Select **Complete** to enter the order completion flow.</span></span>
10. <span data-ttu-id="c539d-234">Desplácese hasta la sección de los pagos, seleccione **Agregar** y seleccione una línea que en la que el tipo de método de pago sea **Tarjetas**.</span><span class="sxs-lookup"><span data-stu-id="c539d-234">Scroll down to the payments section, select **Add**, and then select a line where the payment method type is set to **Cards**.</span></span> 
11. <span data-ttu-id="c539d-235">Seleccione el signo más (**+**) para agregar un pago de tarjeta.</span><span class="sxs-lookup"><span data-stu-id="c539d-235">Select the plus sign (**+**) to add a card payment.</span></span> 
12. <span data-ttu-id="c539d-236">Introduzca los detalles de un número de tarjeta de crédito de prueba que puede encontrar en [Página de números de tarjeta de la prueba de Adyen](https://docs.adyen.com/development-resources/test-cards/test-card-numbers/#description) y a continuación seleccione **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="c539d-236">Enter the details for a test credit card number that you found on the [Adyen test card numbers page](https://docs.adyen.com/development-resources/test-cards/test-card-numbers/#description), and then select **OK**.</span></span>

    > [!NOTE]
    > <span data-ttu-id="c539d-237">Si la marca de tarjeta para el número de tarjeta especificado difiere de la marca que se activó cuando el pago se ha iniciado, el pago todavía continuará.</span><span class="sxs-lookup"><span data-stu-id="c539d-237">If the card brand for the card number that you entered differs from the brand that was selected when the payment was initiated, the payment will still go through.</span></span> <span data-ttu-id="c539d-238">Sin embargo, se registrará en las cuentas asignadas a la marca de la tarjeta que seleccionó en el paso 10.</span><span class="sxs-lookup"><span data-stu-id="c539d-238">However, it will be posted to the accounts that are mapped to the card brand that you selected in step 10.</span></span>

12. <span data-ttu-id="c539d-239">Seleccione **Aceptar** de nuevo para cerrar el cuadro **Pagos de la finalización del pedido**.</span><span class="sxs-lookup"><span data-stu-id="c539d-239">Select **OK** again to close the **Order completion payments** dialog box.</span></span>
13. <span data-ttu-id="c539d-240">En la página **Resumen de pedido de ventas**, seleccione **Enviar**.</span><span class="sxs-lookup"><span data-stu-id="c539d-240">On the **Sales order summary** page, select **Submit**.</span></span>
14. <span data-ttu-id="c539d-241">En el PDV, en la página de inicio, seleccione la operación **Pedidos a recoger** para ver los pedidos para recoger en el almacén.</span><span class="sxs-lookup"><span data-stu-id="c539d-241">In the POS, on the welcome page, select the **Orders to pickup** operation to see the orders for in-store pickup.</span></span> 
15. <span data-ttu-id="c539d-242">Seleccione una o más líneas del pedido que se ha creado en el escaparate de referencia y, a continuación seleccione **Recoger**.</span><span class="sxs-lookup"><span data-stu-id="c539d-242">Select one or more lines from the order that was created in the reference storefront, and then select **Pick up**.</span></span>

    <span data-ttu-id="c539d-243">El pedido se recupera de la oficina administrativa.</span><span class="sxs-lookup"><span data-stu-id="c539d-243">The order is retrieved from the back office.</span></span> 

16. <span data-ttu-id="c539d-244">Cuando los detalles de la línea de pedido se recuperan de la oficina y se detecta un pago de tarjeta que se puede usar para el omnicanal, se le informará de que un método de pago está disponible.</span><span class="sxs-lookup"><span data-stu-id="c539d-244">When the order line details are retrieved from the back office, and a card payment that can be used for omni-channel is detected, you're informed that a payment method is available.</span></span>
17. <span data-ttu-id="c539d-245">Seleccione **Usar método de pago disponible** para completar la transacción mediante los detalles de la tarjeta que se especificaron en el escaparate de referencia.</span><span class="sxs-lookup"><span data-stu-id="c539d-245">Select **Use available payment method** to complete the transaction by using the card details that were entered in the reference storefront.</span></span>

    <span data-ttu-id="c539d-246">Las líneas de pedido se cargan en la página de la transacción, y el saldo pendiente es 0 (cero).</span><span class="sxs-lookup"><span data-stu-id="c539d-246">The order lines are loaded on the transaction page, and the balance due is 0 (zero).</span></span>

18. <span data-ttu-id="c539d-247">Seleccione la pestaña **Pagos** para la línea de pago que se sacó del pedido en línea.</span><span class="sxs-lookup"><span data-stu-id="c539d-247">Select the **Payments** tab to view the tender line that was pulled from the online order.</span></span> 
19. <span data-ttu-id="c539d-248">Seleccione cualquier método de pago para completar la transacción.</span><span class="sxs-lookup"><span data-stu-id="c539d-248">Select any payment method to complete the transaction.</span></span> 

### <a name="buy-in-store-a-pick-up-in-store-b"></a><span data-ttu-id="c539d-249">Comprar en la tienda A, recoger en la tienda B</span><span class="sxs-lookup"><span data-stu-id="c539d-249">Buy in store A, pick up in store B</span></span>

1. <span data-ttu-id="c539d-250">Iniciar el sistema PDV para la tienda de Houston.</span><span class="sxs-lookup"><span data-stu-id="c539d-250">Start the POS for the Houston store.</span></span>
2. <span data-ttu-id="c539d-251">En la página **Transacción**, agregue Karen Berg a la transacción mediante el teclado numérico especificando **2001**.</span><span class="sxs-lookup"><span data-stu-id="c539d-251">On the **Transaction** page, add Karen Berg to the transaction by using the number pad to enter **2001**.</span></span>
3. <span data-ttu-id="c539d-252">Agregue una o más líneas a la transacción.</span><span class="sxs-lookup"><span data-stu-id="c539d-252">Add one or more lines to the transaction.</span></span>
4. <span data-ttu-id="c539d-253">Seleccione **Pedidos** para ver opciones de pedido.</span><span class="sxs-lookup"><span data-stu-id="c539d-253">Select **Orders** to see the order options.</span></span>
5. <span data-ttu-id="c539d-254">Seleccione **Recoger todos** y, a continuación, cuando el sistema lo solicite, seleccione **Pedido de cliente**.</span><span class="sxs-lookup"><span data-stu-id="c539d-254">Select **Pick up all**, and then, when you're prompted, select **Customer order**.</span></span>
6. <span data-ttu-id="c539d-255">En la barra de búsqueda, introduzca **Seattle**, y seleccione la tienda de **Seattle** para la recogida.</span><span class="sxs-lookup"><span data-stu-id="c539d-255">In the search bar, enter **Seattle**, and then select the **Seattle** store for pickup.</span></span> 
7. <span data-ttu-id="c539d-256">Seleccione **Aceptar** para aceptar la fecha actual como la fecha de la recogida.</span><span class="sxs-lookup"><span data-stu-id="c539d-256">Select **OK** to accept the current date as the date of pickup.</span></span>
9. <span data-ttu-id="c539d-257">Seleccionar **Pagar con tarjeta** para iniciar el pago.</span><span class="sxs-lookup"><span data-stu-id="c539d-257">Select **Pay card** to initiate the payment.</span></span>
10. <span data-ttu-id="c539d-258">Introduzca la cantidad del pago por tarjeta que se debe depositar.</span><span class="sxs-lookup"><span data-stu-id="c539d-258">Tender the card payment for the amount that is due for the deposit.</span></span> 
11. <span data-ttu-id="c539d-259">Complete el pago de depósito en el terminal de pago.</span><span class="sxs-lookup"><span data-stu-id="c539d-259">Complete the deposit payment on the payment terminal.</span></span> 
12. <span data-ttu-id="c539d-260">Una vez que el depósito se pague, seleccione la opción de usar la misma tarjeta para el cumplimiento, y espere a que el pedido esté completado.</span><span class="sxs-lookup"><span data-stu-id="c539d-260">After the deposit is paid, select the option to use the same card for fulfillment, and wait for the order to be completed.</span></span> 
13. <span data-ttu-id="c539d-261">Iniciar el sistema PDV para la tienda de Seattle.</span><span class="sxs-lookup"><span data-stu-id="c539d-261">Start the POS for the Seattle store.</span></span>
14. <span data-ttu-id="c539d-262">En el PDV, en la página de inicio, seleccione la operación **Pedidos a recoger** para ver los pedidos para recoger en el almacén.</span><span class="sxs-lookup"><span data-stu-id="c539d-262">In the POS, on the welcome page, select the **Orders to pickup** operation to see the orders for in-store pickup.</span></span> 
15. <span data-ttu-id="c539d-263">Seleccione una o más líneas del pedido que se ha creado en el escaparate de referencia y, a continuación seleccione **Recoger**.</span><span class="sxs-lookup"><span data-stu-id="c539d-263">Select one or more lines from the order that was created in the reference storefront, and then select **Pick up**.</span></span>

    <span data-ttu-id="c539d-264">El pedido se recupera de la oficina administrativa.</span><span class="sxs-lookup"><span data-stu-id="c539d-264">The order is retrieved from the back office.</span></span> 

16. <span data-ttu-id="c539d-265">Cuando los detalles de la línea de pedido se recuperan de la oficina y se detecta un pago de tarjeta que se puede usar para el omnicanal, se le informará de que un método de pago está disponible.</span><span class="sxs-lookup"><span data-stu-id="c539d-265">When the order line details are retrieved from the back office, and a card payment that can be used for omni-channel is detected, you're informed that a payment method is available.</span></span>
17. <span data-ttu-id="c539d-266">Seleccione **Usar método de pago disponible** para completar la transacción mediante los detalles de la tarjeta que se especificaron en el escaparate de referencia.</span><span class="sxs-lookup"><span data-stu-id="c539d-266">Select **Use available payment method** to complete the transaction by using the card details that were entered in the reference storefront.</span></span>

    <span data-ttu-id="c539d-267">Las líneas de pedido se cargan en la página de la transacción, y el saldo pendiente es 0 (cero).</span><span class="sxs-lookup"><span data-stu-id="c539d-267">The order lines are loaded on the transaction page, and the balance due is 0 (zero).</span></span>

18. <span data-ttu-id="c539d-268">Seleccione la pestaña **Pagos** para la línea de pago que se sacó del pedido en línea.</span><span class="sxs-lookup"><span data-stu-id="c539d-268">Select the **Payments** tab to view the tender line that was pulled from the online order.</span></span> 
19. <span data-ttu-id="c539d-269">Seleccione cualquier método de pago para completar la transacción.</span><span class="sxs-lookup"><span data-stu-id="c539d-269">Select any payment method to complete the transaction.</span></span> 

### <a name="buy-in-store-a-ship-to-customer"></a><span data-ttu-id="c539d-270">Comprar en la tienda A, enviar al cliente</span><span class="sxs-lookup"><span data-stu-id="c539d-270">Buy in store A, ship to customer</span></span>

1. <span data-ttu-id="c539d-271">Iniciar el sistema PDV para la tienda de Houston.</span><span class="sxs-lookup"><span data-stu-id="c539d-271">Start the POS for the Houston store.</span></span>
2. <span data-ttu-id="c539d-272">En la página **Transacción**, agregue Karen Berg a la transacción mediante el teclado numérico especificando **2001**.</span><span class="sxs-lookup"><span data-stu-id="c539d-272">On the **Transaction** page, add Karen Berg to the transaction by using the number pad to enter **2001**.</span></span>
3. <span data-ttu-id="c539d-273">Agregue una o más líneas a la transacción.</span><span class="sxs-lookup"><span data-stu-id="c539d-273">Add one or more lines to the transaction.</span></span>
4. <span data-ttu-id="c539d-274">Seleccione **Pedidos** para ver opciones de pedido.</span><span class="sxs-lookup"><span data-stu-id="c539d-274">Select **Orders** to see the order options.</span></span>
5. <span data-ttu-id="c539d-275">Seleccione **Enviar todo** y, a continuación, cuando el sistema lo solicite, seleccione **Pedido de cliente**.</span><span class="sxs-lookup"><span data-stu-id="c539d-275">Select **Ship all**, and then, when you're prompted, select **Customer order**.</span></span>
6. <span data-ttu-id="c539d-276">En la página del método de envío, seleccione **Estándar nocturno** y después seleccione **Aceptar** para aceptar la fecha actual como fecha de envío.</span><span class="sxs-lookup"><span data-stu-id="c539d-276">In the shipping method page, select **Standard overnight**, and then select **OK** to accept today's date as the shipping date.</span></span> 
7. <span data-ttu-id="c539d-277">Seleccione **Aceptar** para aceptar la fecha actual como la fecha de la recogida.</span><span class="sxs-lookup"><span data-stu-id="c539d-277">Select **OK** to accept the current date as the date of pickup.</span></span>
8. <span data-ttu-id="c539d-278">Seleccionar **Pagar con tarjeta** para iniciar el pago.</span><span class="sxs-lookup"><span data-stu-id="c539d-278">Select **Pay card** to initiate the payment.</span></span>
9. <span data-ttu-id="c539d-279">Introduzca la cantidad del pago por tarjeta que se debe depositar.</span><span class="sxs-lookup"><span data-stu-id="c539d-279">Tender the card payment for the amount that is due for the deposit.</span></span> 
10. <span data-ttu-id="c539d-280">Complete el pago de depósito en el terminal de pago.</span><span class="sxs-lookup"><span data-stu-id="c539d-280">Complete the deposit payment on the payment terminal.</span></span> 
11. <span data-ttu-id="c539d-281">Una vez que el depósito se pague, seleccione la opción de usar la misma tarjeta para el cumplimiento, y espere a que el pedido esté completado.</span><span class="sxs-lookup"><span data-stu-id="c539d-281">After the deposit is paid, select the option to use the same card for fulfillment, and wait for the order to be completed.</span></span>

<span data-ttu-id="c539d-282">Cuando el pedido sea recogido, empaquetado y facturado en el área de operaciones,, los detalles de pago que se proporcionan en el sistema PDV se usarán para recuperar los fondos de mercancías que se envían al cliente.</span><span class="sxs-lookup"><span data-stu-id="c539d-282">When the order is picked, packed, and invoiced in the back office, the payment details that are provided at the POS will be used to capture the funds for the goods that are being shipped to the customer.</span></span> 

## <a name="scenario-details"></a><span data-ttu-id="c539d-283">Detalles del escenario</span><span class="sxs-lookup"><span data-stu-id="c539d-283">Scenario details</span></span>

<span data-ttu-id="c539d-284">Además de los escenarios básicas que se acaban de describir, se han realizado varios mejoras al SDK de pagos para admitir pagos de omnicanal.</span><span class="sxs-lookup"><span data-stu-id="c539d-284">In addition to the basic scenarios that were just described, several enhancements have been made to the Payments SDK to support omni-channel payments.</span></span> 

### <a name="pos"></a><span data-ttu-id="c539d-285">PDV</span><span class="sxs-lookup"><span data-stu-id="c539d-285">POS</span></span>

#### <a name="single-swipedip-for-customer-orders"></a><span data-ttu-id="c539d-286">Solos una pasada/toque por pedido del cliente</span><span class="sxs-lookup"><span data-stu-id="c539d-286">Single swipe/dip for customer orders</span></span>

<span data-ttu-id="c539d-287">Antes de que la característica de los pagos de omnicanal fuera implementada, cuando los pedidos de cliente que incluían depósitos se creaban en el PDV, requerían a la los clientes pasar (o tocar) su tarjeta dos veces: una vez para el pago del depósito y otra para crear el token de tarjeta para el cumplimiento posterior del pedido.</span><span class="sxs-lookup"><span data-stu-id="c539d-287">Before the omni-channel payments feature was implemented, when customer orders that included deposits were created at the POS, customers were required to swipe (or dip) their card two times: one time to pay the deposit and one time to tokenize the card for subsequent order fulfillment.</span></span> <span data-ttu-id="c539d-288">Cuando está activada la función de tokenization de omncanal, los clientes deben pasar la tarjeta sólo una vez al pagar el depósito y autorizar el importe debido por las mercancías que se entregarán posteriormente.</span><span class="sxs-lookup"><span data-stu-id="c539d-288">When the omni-channel tokenization feature is turned on, customers must swipe their card only one time to both pay the deposit and authorize the amount that is due for goods that will be fulfilled later.</span></span> <span data-ttu-id="c539d-289">En el momento del cumplimiento, se obtienen los fondos autorizados.</span><span class="sxs-lookup"><span data-stu-id="c539d-289">At the time of fulfillment, the authorized funds are captured.</span></span> <span data-ttu-id="c539d-290">Antes de que la función de tokenization de omnicanal fuera implementada, sólo un token recurrente de la tarjeta se creaba para el cumplimiento posterior del pedido.</span><span class="sxs-lookup"><span data-stu-id="c539d-290">Before the omni-channel tokenization feature was implemented, only a recurring card token was created for subsequent order fulfillment.</span></span> <span data-ttu-id="c539d-291">Por lo tanto, los fondos para el cumplimiento pendiente no se autorizaban, y ya que los fondos no eran retenidos para esa compra específica, era menos probable que pudieran se recuperarán posteriormente.</span><span class="sxs-lookup"><span data-stu-id="c539d-291">Therefore, the funds for the pending fulfillment weren't authorized, and because those funds weren't being held for that specific purchase, it was less likely that they could be captured later.</span></span>

> [!NOTE]
> <span data-ttu-id="c539d-292">Un único pase una tarjeta no se admite en la versión 8.1.3 comercial.</span><span class="sxs-lookup"><span data-stu-id="c539d-292">Single swipe isn't supported in Retail version 8.1.3.</span></span> <span data-ttu-id="c539d-293">Los pedidos de cliente en la versión 8.1.3 usan el mismo flujo usado antes de que la función de tokenization de omnicanal fuera implementada.</span><span class="sxs-lookup"><span data-stu-id="c539d-293">Customer orders in version 8.1.3 use the same flow that was used before the omni-channel tokenization feature was implemented.</span></span> 

### <a name="cards-that-cant-issue-recurring-card-tokens"></a><span data-ttu-id="c539d-294">Tarjetas que no pueden emitir tokens de tarjeta recurrentes</span><span class="sxs-lookup"><span data-stu-id="c539d-294">Cards that can't issue recurring card tokens</span></span>

<span data-ttu-id="c539d-295">Algunas tarjetas no se pueden usar para los pagos de omnicanal, ya que no admiten emitir tokens de tarjetas recurrentes.</span><span class="sxs-lookup"><span data-stu-id="c539d-295">Some cards can't be used for omni-channel payments, because they don't support issuing recurring card tokens.</span></span> <span data-ttu-id="c539d-296">Cuando un pedido se crea en el PDV, si el depósito se paga mediante una tarjeta que no soporte tokens de tarjeta recurrentes, se usa el flujo anterior de tokenización de tarjeta.</span><span class="sxs-lookup"><span data-stu-id="c539d-296">When an order is created at the POS, if the deposit is paid by using a card that doesn't support recurring card tokens, the previous card tokenization flow is used.</span></span> <span data-ttu-id="c539d-297">Por lo tanto, un cliente que desea proporcionar un pago que se usará para la posterior del pedido debe presentar una segunda tarjeta.</span><span class="sxs-lookup"><span data-stu-id="c539d-297">Therefore, a customer who wants to provide a payment that will be used for subsequent order fulfillment must present a second card.</span></span> <span data-ttu-id="c539d-298">Si la segunda tarjeta no admite a tokens de tarjeta recurrentes, la acción de tokenización se rechazará, y se le solicitará al cajero pedir al cliente que proporcione otra tarjeta.</span><span class="sxs-lookup"><span data-stu-id="c539d-298">If the second card doesn't support recurring card tokens, the tokenization action will be declined, and the cashier will be prompted to ask the customer to provide a different card.</span></span> 

### <a name="using-a-different-card"></a><span data-ttu-id="c539d-299">Usar una tarjeta distinta</span><span class="sxs-lookup"><span data-stu-id="c539d-299">Using a different card</span></span>

<span data-ttu-id="c539d-300">Un cliente que llega a la tienda para la recogida del pedido tiene la opción de usar otra tarjeta.</span><span class="sxs-lookup"><span data-stu-id="c539d-300">A customer who comes to the store for order pickup has the option to use a different card.</span></span> <span data-ttu-id="c539d-301">Cuando el cajero recibe la consulta **Usar método de pago disponible** en el momento de recogida del pedido, puede preguntar si el cliente desea usar la misma tarjeta.</span><span class="sxs-lookup"><span data-stu-id="c539d-301">When the cashier receives the **Use available payment method** prompt at the time of order pickup, he or she can ask whether the customer wants to use the same card.</span></span> <span data-ttu-id="c539d-302">Si el cliente ha perdido la tarjeta que se usó para crear el pedido y desea pagar la orden mediante otra tarjeta, el cajero puede seleccionar **Usar otro método de pago**.</span><span class="sxs-lookup"><span data-stu-id="c539d-302">If the customer has lost the card that was used to create the order and wants to pay for the order by using a different card, the cashier can select **Use a different payment method**.</span></span> <span data-ttu-id="c539d-303">Si el cliente vuelve después para recoger más elementos para el mismo pedido, si la autorización original de la tarjeta no es válida, el cajero puede preguntar de nuevo si el cliente desea usar esa tarjeta.</span><span class="sxs-lookup"><span data-stu-id="c539d-303">If the customer comes back later to pick up more items for the same order, if the original card authorization is still valid, the cashier can again ask whether the customer wants to use that card.</span></span>

### <a name="invalid-authorizations"></a><span data-ttu-id="c539d-304">Autorizaciones no válidas</span><span class="sxs-lookup"><span data-stu-id="c539d-304">Invalid authorizations</span></span>

<span data-ttu-id="c539d-305">Si la tarjeta que se usó para crear una orden ya no es válida, cuando los productos se seleccionan para la recogida la solicitud de captura de pago fracasará.</span><span class="sxs-lookup"><span data-stu-id="c539d-305">If the card that was used to create an order is no longer valid, when products are selected for pickup, the payment capture request will fail.</span></span> <span data-ttu-id="c539d-306">El conector de pago del PDV intentará entonces crear una nueva autorización y captura con los detalles de la misma tarjeta.</span><span class="sxs-lookup"><span data-stu-id="c539d-306">The POS payment connector will then try to create a new authorization and capture by using the same card details.</span></span> <span data-ttu-id="c539d-307">Si falla la nueva autorización o captura, el cajero será informado de que el pago no ha podido ser procesado.</span><span class="sxs-lookup"><span data-stu-id="c539d-307">If the new authorization or capture fails, the cashier will be informed that the payment could not be processed.</span></span> <span data-ttu-id="c539d-308">El cajero debe a continuación obtener un nuevo pago del cliente.</span><span class="sxs-lookup"><span data-stu-id="c539d-308">The cashier must then get a new payment from the customer.</span></span> 

### <a name="multiple-available-payments"></a><span data-ttu-id="c539d-309">Pagos múltiples disponibles</span><span class="sxs-lookup"><span data-stu-id="c539d-309">Multiple available payments</span></span>

<span data-ttu-id="c539d-310">Cuando un pedido que tenga varias líneas y formas de pago se recoge, primero el cajero recibe el mensaje **Usar método de pago disponible**.</span><span class="sxs-lookup"><span data-stu-id="c539d-310">When an order that has multiple tenders and multiple lines is picked up, the cashier first receives the **Use available payment method** prompt.</span></span> <span data-ttu-id="c539d-311">Si hay varios tarjetas, cuando el cajero selecciona **Usar método de pago disponible**, las líneas existentes de forma de pago con tarjeta se capturarán hasta que el saldo se cumpla para las mercancías que se están recogiendo.</span><span class="sxs-lookup"><span data-stu-id="c539d-311">If there are multiple cards, when the cashier selects **Use available payment method**, existing card tender lines will be captured until the balance is met for the goods that are currently being picked up.</span></span> <span data-ttu-id="c539d-312">El cajero no tendrá la opción de seleccionar la tarjeta que se debe usar para las mercancías que se están recogiendo.</span><span class="sxs-lookup"><span data-stu-id="c539d-312">The cashier won't have the option to select the card that should be used for the goods that are being picked up.</span></span> 

## <a name="related-topics"></a><span data-ttu-id="c539d-313">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="c539d-313">Related topics</span></span>

- [<span data-ttu-id="c539d-314">Preguntas frecuentes sobre pagos</span><span class="sxs-lookup"><span data-stu-id="c539d-314">Payments FAQ</span></span>](https://docs.microsoft.com/dynamics365/unified-operations/retail/dev-itpro/payments-retail)
- [<span data-ttu-id="c539d-315">Conector de pago de Dynamics 365 para Adyen</span><span class="sxs-lookup"><span data-stu-id="c539d-315">Dynamics 365 Payment Connector for Adyen</span></span>](https://docs.microsoft.com/dynamics365/unified-operations/retail/dev-itpro/adyen-connector?tabs=8-1-3)
- [<span data-ttu-id="c539d-316">Configurar BOPIS en un entorno de evaluación de Dynamics 365 Commerce</span><span class="sxs-lookup"><span data-stu-id="c539d-316">Configure BOPIS in a Dynamics 365 Commerce evaluation environment</span></span>](https://docs.microsoft.com/dynamics365/commerce/cpe-bopis)

