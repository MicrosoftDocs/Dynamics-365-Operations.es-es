---
title: Visión general de la integración fiscal para canales de Commerce
description: Este tema proporciona una visión general de las capacidades fiscales de integración disponibles en Dynamics 365 Commerce.
author: josaw
manager: annbe
ms.date: 02/01/2019
ms.topic: article
ms.prod: ''
ms.service: dynamics-365-retail
ms.technology: ''
ms.search.form: RetailFunctionalityProfile, RetailFormLayout, RetailParameters
audience: Application User
ms.reviewer: josaw
ms.search.scope: Core, Operations, Retail
ms.search.region: Global
ms.search.industry: Retail
ms.author: v-kikozl
ms.search.validFrom: 2019-1-16
ms.dyn365.ops.version: 10
ms.openlocfilehash: ff9d722640c86333cb1f9174c640adc2e76e9a5f
ms.sourcegitcommit: 81a647904dd305c4be2e4b683689f128548a872d
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 02/01/2020
ms.locfileid: "3024003"
---
# <a name="overview-of-fiscal-integration-for-commerce-channels"></a><span data-ttu-id="ea4be-103">Visión general de la integración fiscal para canales de Commerce</span><span class="sxs-lookup"><span data-stu-id="ea4be-103">Overview of fiscal integration for Commerce channels</span></span>

[!include [banner](../includes/banner.md)]

## <a name="introduction"></a><span data-ttu-id="ea4be-104">Introducción</span><span class="sxs-lookup"><span data-stu-id="ea4be-104">Introduction</span></span>

<span data-ttu-id="ea4be-105">Este tema es una visión general de las capacidades fiscales de integración disponibles en Dynamics 365 Commerce.</span><span class="sxs-lookup"><span data-stu-id="ea4be-105">This topic is an overview of the fiscal integration capabilities that are available in Dynamics 365 Commerce.</span></span> <span data-ttu-id="ea4be-106">La integración fiscal incluye la integración con distintos dispositivos fiscales y servicios que habilitan el registro fiscal de la venta de acuerdo con las leyes fiscales locales que se dirijan que impiden fraude fiscal en el sector minorista.</span><span class="sxs-lookup"><span data-stu-id="ea4be-106">Fiscal integration includes integration with various fiscal devices and services that enable fiscal registration of sales in accordance with local fiscal laws that are aimed at preventing tax fraud in the retail industry.</span></span> <span data-ttu-id="ea4be-107">A continuación aparecen varias situaciones de ejemplo habituales que se pueden cubrir mediante inclusión de la integración fiscal:</span><span class="sxs-lookup"><span data-stu-id="ea4be-107">Here are some typical scenarios that can be covered by using fiscal integration:</span></span>

- <span data-ttu-id="ea4be-108">Registrar una venta en un dispositivo fiscal que está conectado al punto de venta (PDV), como una impresora fiscal, e imprimir un recibo fiscal para el cliente.</span><span class="sxs-lookup"><span data-stu-id="ea4be-108">Register a sale on a fiscal device that is connected to point of sale (POS), such as a fiscal printer, and print a fiscal receipt for the customer.</span></span>
- <span data-ttu-id="ea4be-109">Enviar la información relacionada con las ventas y las devoluciones que se completan en Retail POS a un servicio Web externa que sea operado por la autoridad fiscal de forma segura.</span><span class="sxs-lookup"><span data-stu-id="ea4be-109">Securely submit information that is related to sales and returns that are completed in Retail POS to an external web-service that is operated by the tax authority.</span></span>
- <span data-ttu-id="ea4be-110">Ayudar a garantizar la inalterabilidad de los datos de transacción de ventas a través de firmas digitales.</span><span class="sxs-lookup"><span data-stu-id="ea4be-110">Help guarantee inalterability of sales transaction data through digital signatures.</span></span>

<span data-ttu-id="ea4be-111">La funcionalidad fiscal de la integración de ventas es un marco que ofrece una solución común para el desarrollo y la personalización adicionales de la integración entre Retail POS y dispositivos y servicios fiscales.</span><span class="sxs-lookup"><span data-stu-id="ea4be-111">The fiscal integration functionality is a framework that provides a common solution for further development and customization of the integration between Retail POS and fiscal devices and services.</span></span> <span data-ttu-id="ea4be-112">La funcionalidad también incluye los ejemplos fiscales de integración que admiten los escenarios de ventas al por menor básicas para los países o regiones específicos, y que funcionan con los dispositivos o servicios fiscales específicos.</span><span class="sxs-lookup"><span data-stu-id="ea4be-112">The functionality also includes fiscal integration samples that support basic retail scenarios for specific countries or regions, and that work with specific fiscal devices or services.</span></span> <span data-ttu-id="ea4be-113">Un ejemplo fiscal de la integración consta de varias extensiones de componentes de Commerce y se incluye en el kit de desarrollo de software (SDK).</span><span class="sxs-lookup"><span data-stu-id="ea4be-113">A fiscal integration sample consists of several extensions of Commerce components and is included in the software development kit (SDK).</span></span> <span data-ttu-id="ea4be-114">Para obtener más información acerca de los ejemplos de integración fiscal, consulte [Ejemplos de integración fiscal en el SDK de Retail](#fiscal-integration-samples-in-the-retail-sdk).</span><span class="sxs-lookup"><span data-stu-id="ea4be-114">For more information about the fiscal integration samples, see [Fiscal integration samples in the Retail SDK](#fiscal-integration-samples-in-the-retail-sdk).</span></span> <span data-ttu-id="ea4be-115">Para obtener información sobre cómo instalar y usar la ventas al por menor SDK, consulte [Kit de desarrollo de software (SDK) al por menor](../dev-itpro/retail-sdk/retail-sdk-overview.md).</span><span class="sxs-lookup"><span data-stu-id="ea4be-115">For information about how to install and use the Retail SDK, see [Retail software development kit (SDK) architecture](../dev-itpro/retail-sdk/retail-sdk-overview.md).</span></span>

<span data-ttu-id="ea4be-116">Para admitir otros escenarios que no son compatibles por un ejemplo fiscal de la integración, para integrar Retail POS con otros dispositivos o servicios fiscales, o cubrir los requisitos de otros países o regiones, debe remitir un ejemplo fiscal existente de integración o crear un nuevo ejemplo mediante un ejemplo existente como un ejemplo.</span><span class="sxs-lookup"><span data-stu-id="ea4be-116">To support other scenarios that aren't supported by a fiscal integration sample, to integrate Retail POS with other fiscal devices or services, or to cover requirements of other countries or regions, you must either extend an existing fiscal integration sample or create a new sample by using an existing sample as an example.</span></span>

## <a name="fiscal-registration-process-and-fiscal-integration-samples-for-fiscal-devices"></a><span data-ttu-id="ea4be-117">Proceso de registro fiscal y ejemplos fiscales de la integración de los dispositivos fiscales</span><span class="sxs-lookup"><span data-stu-id="ea4be-117">Fiscal registration process and fiscal integration samples for fiscal devices</span></span>

<span data-ttu-id="ea4be-118">Un proceso de registro fiscal en Retail POS puede estar formado por uno o más pasos.</span><span class="sxs-lookup"><span data-stu-id="ea4be-118">A fiscal registration process in Retail POS can consist of one or more steps.</span></span> <span data-ttu-id="ea4be-119">Cada paso implica el registro de transacciones fiscales o de eventos específicos en un dispositivo manual o servicio fiscal.</span><span class="sxs-lookup"><span data-stu-id="ea4be-119">Each step involves fiscal registration of specific transactions or events in one fiscal device or service.</span></span> <span data-ttu-id="ea4be-120">Los siguientes componentes de la solución participan en el registro fiscal en un dispositivo fiscal asociado a una estación de hardware:</span><span class="sxs-lookup"><span data-stu-id="ea4be-120">The following solution components participate in the fiscal registration in a fiscal device that is connected to a Hardware station:</span></span>

- <span data-ttu-id="ea4be-121">**Extensión de Commerce runtime (CRT)**: este componente serializa la transacción/datos de eventos en el formato que también se usa para la interacción con el dispositivo fiscal, analiza respuestas del dispositivo fiscal, y almacena las respuestas en la base de datos del canal.</span><span class="sxs-lookup"><span data-stu-id="ea4be-121">**Commerce runtime (CRT) extension** – This component serializes transaction/event data in the format that is also used for interaction with the fiscal device, parses responses from the fiscal device, and stores the responses in the channel database.</span></span> <span data-ttu-id="ea4be-122">La extensión también define las transacciones y los eventos específicos que deben estar registrados.</span><span class="sxs-lookup"><span data-stu-id="ea4be-122">The extension also defines the specific transactions and events that must be registered.</span></span> <span data-ttu-id="ea4be-123">Este componente suele denominarse como un *proveedor del documento fiscal*.</span><span class="sxs-lookup"><span data-stu-id="ea4be-123">This component is often referred to as a *fiscal document provider*.</span></span>
- <span data-ttu-id="ea4be-124">**Extensión de la estación de hardware** Este componente inicializa la comunicación con el dispositivo fiscal, envía solicitudes y comandos directos al dispositivo fiscal basado en la transacción/los datos de eventos de la información del documento fiscal y recibe respuestas del dispositivo fiscal.</span><span class="sxs-lookup"><span data-stu-id="ea4be-124">**Hardware station extension** – This component initializes the communication with the fiscal device, sends requests and direct commands to the fiscal device based on the transaction/event data that is extracted from the fiscal document, and receives responses from the fiscal device.</span></span> <span data-ttu-id="ea4be-125">Este componente suele denominarse como un *conector fiscal*.</span><span class="sxs-lookup"><span data-stu-id="ea4be-125">This component is often referred to as a *fiscal connector*.</span></span>

<span data-ttu-id="ea4be-126">Un ejemplo fiscal de integración para un dispositivo fiscal contiene el CRT y extensiones de la estación de hardware para un proveedor fiscal de documentos y conector fiscal, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="ea4be-126">A fiscal integration sample for a fiscal device contains the CRT and Hardware station extensions for a fiscal document provider and a fiscal connector, respectively.</span></span> <span data-ttu-id="ea4be-127">También contiene las siguientes configuraciones de componentes:</span><span class="sxs-lookup"><span data-stu-id="ea4be-127">It also contains the following component configurations:</span></span>

- <span data-ttu-id="ea4be-128">**Configuración del proveedor fiscal del documento** La configuración define un método de salida y el formato de los documentos fiscales.</span><span class="sxs-lookup"><span data-stu-id="ea4be-128">**Fiscal document provider configuration** – This configuration defines an output method and a format for fiscal documents.</span></span> <span data-ttu-id="ea4be-129">También contiene una asignación de datos para los impuestos y los métodos de pago, para hacer que los datos del Retail POS sean compatibles con los valores que están predefinidas en el firmware fiscal del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="ea4be-129">It also contains a data mapping for taxes and payment methods, to make data from Retail POS compatible with the values that are predefined in the fiscal device firmware.</span></span>
- <span data-ttu-id="ea4be-130">**Configuración de conector fiscal** La configuración define la comunicación con física el dispositivo fiscal específico.</span><span class="sxs-lookup"><span data-stu-id="ea4be-130">**Fiscal connector configuration** – This configuration defines the physical communication with the specific fiscal device.</span></span>

<span data-ttu-id="ea4be-131">Un proceso de registro fiscal para un registro de PDV específico se define mediante un valor correspondiente del perfil de funcionalidad del PDV.</span><span class="sxs-lookup"><span data-stu-id="ea4be-131">A fiscal registration process for a specific POS register is defined by a corresponding setting in the POS functionality profile.</span></span> <span data-ttu-id="ea4be-132">Para obtener más información acerca de cómo configurar un proceso de registro fiscal, cargar el proveedor fiscal de documento y las configuraciones de conector fiscales, y cambiar los parámetros, consulte [Configurar un proceso de registro fiscal](setting-up-fiscal-integration-for-retail-channel.md#set-up-a-fiscal-registration-process).</span><span class="sxs-lookup"><span data-stu-id="ea4be-132">For more details about how to configure a fiscal registration process, upload fiscal document provider and fiscal connector configurations, and change their parameters, see [Set up a fiscal registration process](setting-up-fiscal-integration-for-retail-channel.md#set-up-a-fiscal-registration-process).</span></span>

<span data-ttu-id="ea4be-133">El ejemplo siguiente muestra un flujo fiscal típico de la ejecución de registro para un dispositivo fiscal.</span><span class="sxs-lookup"><span data-stu-id="ea4be-133">The following example shows a typical fiscal registration execution flow for a fiscal device.</span></span> <span data-ttu-id="ea4be-134">El flujo empieza con un evento en PDV (por ejemplo, finalización de una transacción de ventas) e implementa la siguiente secuencia de pasos:</span><span class="sxs-lookup"><span data-stu-id="ea4be-134">The flow starts with an event in the POS (for example, finalization of a sales transaction) and implements the following sequence of steps:</span></span>

1. <span data-ttu-id="ea4be-135">El PDV solicita un documento fiscal del CRT.</span><span class="sxs-lookup"><span data-stu-id="ea4be-135">The POS requests a fiscal document from CRT.</span></span>
2. <span data-ttu-id="ea4be-136">El CRT determina si el evento actual requiere el registro fiscal.</span><span class="sxs-lookup"><span data-stu-id="ea4be-136">CRT determines whether the current event requires fiscal registration.</span></span>
3. <span data-ttu-id="ea4be-137">Según los valores fiscales del proceso de registro, CRT identifica un conector fiscal y un proveedor fiscal correspondiente del documento que desee utilizar para el registro fiscal.</span><span class="sxs-lookup"><span data-stu-id="ea4be-137">Based on the fiscal registration process settings, CRT identifies a fiscal connector and corresponding fiscal document provider to use for the fiscal registration.</span></span>
4. <span data-ttu-id="ea4be-138">CRT ejecuta el proveedor del documento fiscal que genera un documento fiscal (por ejemplo, un documento XML) que represente la transacción o el evento.</span><span class="sxs-lookup"><span data-stu-id="ea4be-138">CRT runs the fiscal document provider that generates a fiscal document (for example, an XML document) that represents the transaction or event.</span></span>
5. <span data-ttu-id="ea4be-139">El PDV envía el documento fiscal que el CRT prepara para una estación de hardware.</span><span class="sxs-lookup"><span data-stu-id="ea4be-139">The POS sends the fiscal document that CRT prepares to a Hardware station.</span></span>
6. <span data-ttu-id="ea4be-140">La estación de hardware ejecuta el conector fiscal que procesa el documento fiscal y lo comunica al dispositivo o servicio fiscal.</span><span class="sxs-lookup"><span data-stu-id="ea4be-140">The Hardware station runs the fiscal connector that processes the fiscal document and communicates it to the fiscal device or service.</span></span>
7. <span data-ttu-id="ea4be-141">El PDV analiza la respuesta del dispositivo o servicio fiscal para determinar si el registro fiscal ha tenido éxito.</span><span class="sxs-lookup"><span data-stu-id="ea4be-141">The POS analyzes the response from the fiscal device or service to determine whether the fiscal registration was successful.</span></span>
8. <span data-ttu-id="ea4be-142">El CRT guarda la respuesta en la base de datos del canal.</span><span class="sxs-lookup"><span data-stu-id="ea4be-142">CRT saves the response to the channel database.</span></span>

<span data-ttu-id="ea4be-143">![Esquema de la solución](media/emea-fiscal-integration-solution.png "Esquema de la solución")</span><span class="sxs-lookup"><span data-stu-id="ea4be-143">![Solution schema](media/emea-fiscal-integration-solution.png "Solution schema")</span></span>

## <a name="error-handling"></a><span data-ttu-id="ea4be-144">Control de errores</span><span class="sxs-lookup"><span data-stu-id="ea4be-144">Error handling</span></span>

<span data-ttu-id="ea4be-145">El marco fiscal de la integración proporciona las opciones siguientes para gestionar los errores durante el registro fiscal:</span><span class="sxs-lookup"><span data-stu-id="ea4be-145">The fiscal integration framework provides the following options to handle failures during fiscal registration:</span></span>

- <span data-ttu-id="ea4be-146">**Reintentar** – Los operadores pueden usar esta opción cuando el error puede resolver rápidamente, y el registro fiscal se puede volver a ejecutar.</span><span class="sxs-lookup"><span data-stu-id="ea4be-146">**Retry** – Operators can use this option when the failure can be resolved quickly, and the fiscal registration can be rerun.</span></span> <span data-ttu-id="ea4be-147">Por ejemplo, esta opción se puede usar cuando el dispositivo fiscal no está conectado, la impresora fiscal se encuentra sin papel, o hay un atasco de papel en la impresora fiscal.</span><span class="sxs-lookup"><span data-stu-id="ea4be-147">For example, this option can be used when the fiscal device isn't connected, the fiscal printer is out of paper, or there is a paper jam in the fiscal printer.</span></span>
- <span data-ttu-id="ea4be-148">**Cancelar** La opción permite operadores posponer el registro fiscal de la transacción actual o del evento si falla.</span><span class="sxs-lookup"><span data-stu-id="ea4be-148">**Cancel** – This option lets operators postpone the fiscal registration of the current transaction or event if it fails.</span></span> <span data-ttu-id="ea4be-149">Después de que se posponga el registro, el transportista puede continuar trabajando en el PDV y puede completar todas las operaciones para las que el registro fiscal no sea necesario.</span><span class="sxs-lookup"><span data-stu-id="ea4be-149">After the registration is postponed, the operator can continue to work on the POS and can complete any operation that the fiscal registration isn't required for.</span></span> <span data-ttu-id="ea4be-150">Cuando cualquier evento que requiera el registro fiscal aparece en el sistema PDV (por ejemplo, se abre una nueva transacción), el cuadro de diálogo de tratamiento de errores aparece automáticamente para notificar el operador que la transacción anterior no se registró correctamente y para proporcionar las opciones de procesamiento de errores.</span><span class="sxs-lookup"><span data-stu-id="ea4be-150">When any event that requires the fiscal registration occurs in the POS (for example, a new transaction is opened), the error handling dialog box automatically appears to notify the operator that the previous transaction wasn't correctly registered and to provide the error handling options.</span></span>
- <span data-ttu-id="ea4be-151">**Omitir** – Los operadores pueden usar esta opción cuando el registro fiscal se puede omitir bajo condiciones específicas y las operaciones regulares se pueden continuar en el PDV.</span><span class="sxs-lookup"><span data-stu-id="ea4be-151">**Skip** – Operators can use this option when the fiscal registration can be omitted under specific conditions and regular operations can be continued on the POS.</span></span> <span data-ttu-id="ea4be-152">Por ejemplo, esta opción se puede usar cuando una transacción de ventas que no se registró se puede registrar en un diario de papel especial.</span><span class="sxs-lookup"><span data-stu-id="ea4be-152">For example, this option can be used when a sales transaction that the fiscal registration failed for can be registered in a special paper journal.</span></span>
- <span data-ttu-id="ea4be-153">**Marcar como registrado** – Los operadores pueden usar esta opción cuando se registró la transacción realmente en el dispositivo fiscal (por ejemplo, un recibo fiscal se imprimió), pero se produjo un error cuando la respuesta fiscal se guardada en la base de datos de canal.</span><span class="sxs-lookup"><span data-stu-id="ea4be-153">**Mark as registered** – Operators can use this option when the transaction was actually registered in the fiscal device (for example, a fiscal receipt was printed), but a failure occurred when the fiscal response was being saved to the channel database.</span></span>

> [!NOTE]
> <span data-ttu-id="ea4be-154">Las opciones **Omitir** y **Marcar como registrado** se deben activar en el proceso de registro fiscal antes usarse.</span><span class="sxs-lookup"><span data-stu-id="ea4be-154">The **Skip** and **Mark as registered** options must be activated in the fiscal registration process before they are used.</span></span> <span data-ttu-id="ea4be-155">Además, los permisos correspondientes se deben conceder a los operadores.</span><span class="sxs-lookup"><span data-stu-id="ea4be-155">In addition, corresponding permissions must be granted to operators.</span></span>

<span data-ttu-id="ea4be-156">Las opciones **Omitir** y **Marcar como registrado** activan códigos de información para capturar cierta información específica acerca del error, como el motivo del error o de una justificación para saltarse el registro fiscal o marcar la transacción como registrada.</span><span class="sxs-lookup"><span data-stu-id="ea4be-156">The **Skip** and **Mark as registered** options enable info codes to capture some specific information about the failure, such as the reason for the failure or a justification for skipping the fiscal registration or marking the transaction as registered.</span></span> <span data-ttu-id="ea4be-157">Para obtener más información sobre cómo gestionar los parámetros de gestión de errores, consulte [Establecer valores de gestión de errores](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span><span class="sxs-lookup"><span data-stu-id="ea4be-157">For more details about how to set up error handling parameters, see [Set error handling settings](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span></span>

### <a name="optional-fiscal-registration"></a><span data-ttu-id="ea4be-158">Registro fiscal opcional</span><span class="sxs-lookup"><span data-stu-id="ea4be-158">Optional fiscal registration</span></span>

<span data-ttu-id="ea4be-159">El registro fiscal puede ser obligatorio para algunas operaciones pero opcional para otras.</span><span class="sxs-lookup"><span data-stu-id="ea4be-159">Fiscal registration might be mandatory for some operations but optional for others.</span></span> <span data-ttu-id="ea4be-160">Por ejemplo, el registro fiscal de ventas y de devolución regulares puede ser obligatorio, pero el registro fiscal de las operaciones relacionadas con los depósitos de cliente puede ser opcional.</span><span class="sxs-lookup"><span data-stu-id="ea4be-160">For example, the fiscal registration of regular sales and returns might be mandatory, but the fiscal registration of operations that are related to customer deposits might be optional.</span></span> <span data-ttu-id="ea4be-161">En este caso, no finalizar el registro fiscal de una venta puede bloquear otras ventas, pero no finalizar el registro fiscal de un depósito de cliente no debe bloquear otras ventas.</span><span class="sxs-lookup"><span data-stu-id="ea4be-161">In this case, failure to complete the fiscal registration of a sale should block further sales, but failure to complete the fiscal registration of a customer deposit should not block further sales.</span></span> <span data-ttu-id="ea4be-162">Para distinguir operaciones obligatorias y opcionales, se recomienda que las gestione a través de distintos proveedores de documentos distintos, y que configure los pasos individuales para el proceso de registro fiscal para dichos proveedores.</span><span class="sxs-lookup"><span data-stu-id="ea4be-162">To distinguish mandatory and optional operations, we recommend that you handle them through different document providers, and that you set up separate steps in the fiscal registration process for those providers.</span></span> <span data-ttu-id="ea4be-163">El parámetro **Continuar con errores** debe estar habilitado para cualquier paso relacionada con el registro fiscal opcional.</span><span class="sxs-lookup"><span data-stu-id="ea4be-163">The **Continue on error** parameter should be enabled for any step that is related to optional fiscal registration.</span></span> <span data-ttu-id="ea4be-164">Para obtener más información sobre cómo gestionar los parámetros de gestión de errores, consulte [Establecer valores de gestión de errores](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span><span class="sxs-lookup"><span data-stu-id="ea4be-164">For more details about how to set up error handling parameters, see [Set error handling settings](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span></span>

### <a name="manually-running-fiscal-registration"></a><span data-ttu-id="ea4be-165">Ejecutar el registro fiscal de forma manual</span><span class="sxs-lookup"><span data-stu-id="ea4be-165">Manually running fiscal registration</span></span>

<span data-ttu-id="ea4be-166">Si el registro fiscal de una transacción o de un evento se ha aplazado después de un error (por ejemplo, si el transportista ha seleccionado **Cancelar** en el cuadro de diálogo de tratamiento de errores), puede volver a ejecutar manualmente el registro fiscal invocando una operación correspondiente.</span><span class="sxs-lookup"><span data-stu-id="ea4be-166">If the fiscal registration of a transaction or event has been postponed after a failure (for example, if the operator selected **Cancel** in the error handling dialog box), you can manually rerun the fiscal registration by invoking a corresponding operation.</span></span> <span data-ttu-id="ea4be-167">Para más información, consulte [Habilitar la ejecución manual del registro fisca postpuesto](setting-up-fiscal-integration-for-retail-channel.md#enable-manual-execution-of-postponed-fiscal-registration).</span><span class="sxs-lookup"><span data-stu-id="ea4be-167">For more details, see [Enable manual execution of postponed fiscal registration](setting-up-fiscal-integration-for-retail-channel.md#enable-manual-execution-of-postponed-fiscal-registration).</span></span>

### <a name="fiscal-registration-health-check"></a><span data-ttu-id="ea4be-168">Comprobación del registro fiscal</span><span class="sxs-lookup"><span data-stu-id="ea4be-168">Fiscal registration health check</span></span>

<span data-ttu-id="ea4be-169">El procedimiento de comprobación de estado de los registros fiscales verifica la disponibilidad del dispositivo fiscal o el servicio cuando se produzcan eventos específicos.</span><span class="sxs-lookup"><span data-stu-id="ea4be-169">The health check procedure for fiscal registrations verifies the availability of the fiscal device or service when specific events occur.</span></span> <span data-ttu-id="ea4be-170">Si el registro fiscal no se puede completar actualmente, se notifica al operador por adelantado.</span><span class="sxs-lookup"><span data-stu-id="ea4be-170">If the fiscal registration can't currently be completed, the operator is notified in advance.</span></span>

<span data-ttu-id="ea4be-171">El PDV ejecuta la comprobación de estado cuando se producen los siguientes eventos:</span><span class="sxs-lookup"><span data-stu-id="ea4be-171">The POS runs the health check when the following events occur:</span></span>

- <span data-ttu-id="ea4be-172">Se abre una nueva transacción.</span><span class="sxs-lookup"><span data-stu-id="ea4be-172">A new transaction is opened.</span></span>
- <span data-ttu-id="ea4be-173">Se recupera una transacción suspendida.</span><span class="sxs-lookup"><span data-stu-id="ea4be-173">A suspended transaction is recalled.</span></span>
- <span data-ttu-id="ea4be-174">Se concluye una transacción de ventas o devolución.</span><span class="sxs-lookup"><span data-stu-id="ea4be-174">A sales or return transaction is finalized.</span></span>

<span data-ttu-id="ea4be-175">Si la comprobación de estado falla, el sistema PDV muestra el cuadro de diálogo de comprobación de estado.</span><span class="sxs-lookup"><span data-stu-id="ea4be-175">If the health check fails, the POS shows the health check dialog box.</span></span> <span data-ttu-id="ea4be-176">Este cuadro de diálogo proporciona los siguientes botones:</span><span class="sxs-lookup"><span data-stu-id="ea4be-176">This dialog box provides the following buttons:</span></span>

- <span data-ttu-id="ea4be-177">**Aceptar** Este botón permite omitir el operador un error comprobación de estado y continuar procesando la operación.</span><span class="sxs-lookup"><span data-stu-id="ea4be-177">**OK** – This button lets the operator ignore a health check error and continue to process the operation.</span></span> <span data-ttu-id="ea4be-178">Los operadores pueden seleccionar este botón si el permiso **Permite omitir error de comprobaciónde estado** está habilitado para ellos.</span><span class="sxs-lookup"><span data-stu-id="ea4be-178">Operators can select this button only if the **Allow skip health check error** permission is enabled for them.</span></span>
- <span data-ttu-id="ea4be-179">**Cancelar** Si el operador selecciona este botón, el sistema PDV cancela la última acción (por ejemplo, un artículo no se agrega a una nueva transacción).</span><span class="sxs-lookup"><span data-stu-id="ea4be-179">**Cancel** – If the operator selects this button, the POS cancels the last action (for example, an item isn't added to a new transaction).</span></span>

> [!NOTE]
> <span data-ttu-id="ea4be-180">La comprobaciónde estado solo se ejecuta si la operación actual requiere el registro fiscal, y si el parámetro **Continuar con errores** se deshabilita para el paso actual del proceso de registro fiscal.</span><span class="sxs-lookup"><span data-stu-id="ea4be-180">The health check is run only if the current operation requires fiscal registration, and if  the **Continue on error** parameter is disabled for the current step of the fiscal registration process.</span></span> <span data-ttu-id="ea4be-181">Para más información, consulte [Establecer configuraciónde tratamiento de errores](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span><span class="sxs-lookup"><span data-stu-id="ea4be-181">For more details, see [Set error handling settings](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span></span>

## <a name="storing-fiscal-response-in-fiscal-transaction"></a><span data-ttu-id="ea4be-182">Almacenar respuesta fiscal en la transacción fiscal</span><span class="sxs-lookup"><span data-stu-id="ea4be-182">Storing fiscal response in fiscal transaction</span></span>

<span data-ttu-id="ea4be-183">Cuando el registro fiscal de una transacción o de un evento se ha realizado correctamente, una transacción fiscal se crea en la base de datos del canal y se vincula a la transacción o el evento original.</span><span class="sxs-lookup"><span data-stu-id="ea4be-183">When fiscal registration of a transaction or event is successful, a fiscal transaction is created in the channel database and linked to the original transaction or event.</span></span> <span data-ttu-id="ea4be-184">De forma similar, si **Omitir** o la opción **Marcar como registrado** se selecciona para un registro fiscal defectuoso, esta información se almacena en una transacción fiscal.</span><span class="sxs-lookup"><span data-stu-id="ea4be-184">Similarly, if the **Skip** or **Mark as registered** option is selected for a failed fiscal registration, this information is stored in a fiscal transaction.</span></span> <span data-ttu-id="ea4be-185">Una transacción fiscal conserva la respuesta fiscal del dispositivo o servicio fiscal.</span><span class="sxs-lookup"><span data-stu-id="ea4be-185">A fiscal transaction holds the fiscal response of the fiscal device or service.</span></span> <span data-ttu-id="ea4be-186">Si el proceso de registro fiscal consta de varios pasos, una transacción fiscal se crea para cada paso del proceso que ha provocado un registro correcto o error.</span><span class="sxs-lookup"><span data-stu-id="ea4be-186">If the fiscal registration process consists of several steps, a fiscal transaction is created for each step of the process that resulted in a successful or failed registration.</span></span>

<span data-ttu-id="ea4be-187">Las transacciones fiscales son transferidas a la sede central por *P-trabajo*, junto con las transacciones.</span><span class="sxs-lookup"><span data-stu-id="ea4be-187">Fiscal transactions are transferred to Headquarters by the *P-job*, together with transactions.</span></span> <span data-ttu-id="ea4be-188">En el FastTab **Transacciones fiscales** de la página **Transacciones de la tienda** , puede ver las transacciones fiscales que se vinculan a las transacciones.</span><span class="sxs-lookup"><span data-stu-id="ea4be-188">On the **Fiscal transactions** FastTab of the **Store transactions** page, you can view the fiscal transactions that are linked to transactions.</span></span>

<span data-ttu-id="ea4be-189">Una transacción fiscal almacena los siguientes datos:</span><span class="sxs-lookup"><span data-stu-id="ea4be-189">A fiscal transaction stores the following details:</span></span>

- <span data-ttu-id="ea4be-190">Detalles fiscales del proceso de registro (proceso, grupo conector, conector, etc.).</span><span class="sxs-lookup"><span data-stu-id="ea4be-190">Fiscal registration process details (process, connector group, connector, and so on).</span></span> <span data-ttu-id="ea4be-191">También guarda el número de serie del dispositivo fiscal en el campo **Número de registro** , si esta información se incluye en la respuesta fiscal.</span><span class="sxs-lookup"><span data-stu-id="ea4be-191">It also stores the serial number of the fiscal device in the **Register number** field, if this information is included in the fiscal response.</span></span>
- <span data-ttu-id="ea4be-192">El estado del registro fiscal: **Completado** para registros correctos, **Omitido** si el operador ha seleccionado la opción **Omitir** para un registro defectuoso, o **Marcado como registrado** si el operador ha seleccionado la opción **Marcar como registrado** .</span><span class="sxs-lookup"><span data-stu-id="ea4be-192">The status of the fiscal registration: **Completed** for successful registration, **Skipped** if the operator selected the **Skip** option for a failed registration, or **Marked as registered** if the operator selected the **Mark as registered** option.</span></span>
- <span data-ttu-id="ea4be-193">Código de información de las transacciones relacionadas con una transacción fiscal seleccionada.</span><span class="sxs-lookup"><span data-stu-id="ea4be-193">Info code transactions that are related to a selected fiscal transaction.</span></span> <span data-ttu-id="ea4be-194">Para ver las transacciones de código de información en el FastTab **Transacciones fiscales** , seleccione una transacción fiscal que tiene un estado **Omitido** o **Marcado como registrado**, y después seleccione **Código de información de transacciones**.</span><span class="sxs-lookup"><span data-stu-id="ea4be-194">To view the info code transactions, on the **Fiscal transactions** FastTab, select a fiscal transaction that has a status of **Skipped** or **Marked as registered**, and then select **Info code transactions**.</span></span>

## <a name="fiscal-texts-for-discounts"></a><span data-ttu-id="ea4be-195">Textos fiscales para descuentos</span><span class="sxs-lookup"><span data-stu-id="ea4be-195">Fiscal texts for discounts</span></span>

<span data-ttu-id="ea4be-196">Algunos países o regiones tienen requisitos especiales sobre los textos adicionales que se deben imprimir en recibos fiscales cuando se aplican los diferentes tipos de descuentos.</span><span class="sxs-lookup"><span data-stu-id="ea4be-196">Some countries or regions have special requirements about additional texts that must be printed on fiscal receipts when different kinds of discounts are applied.</span></span> <span data-ttu-id="ea4be-197">La funcionalidad fiscal de la integración permite configurar un texto especial para un descuento que se imprime después de una línea de descuento en un recibo fiscal.</span><span class="sxs-lookup"><span data-stu-id="ea4be-197">The fiscal integration functionality lets you set up a special text for a discount that is printed after a discount line on a fiscal receipt.</span></span> <span data-ttu-id="ea4be-198">Para descuentos manuales, puede configurar un texto fiscal para la información codificada especificado como la **Descuento del producto** codificada en el perfil de funcionalidad del PDV.</span><span class="sxs-lookup"><span data-stu-id="ea4be-198">For manual discounts, you can configure a fiscal text for the info code that is specified as the **Product discount** info code in the POS functionality profile.</span></span> <span data-ttu-id="ea4be-199">Para obtener más información acerca de cómo configurar los textos fiscales para descuentos, consulte [Instalación de textos fiscales para descuentos](setting-up-fiscal-integration-for-retail-channel.md#set-up-fiscal-texts-for-discounts).</span><span class="sxs-lookup"><span data-stu-id="ea4be-199">For more details about how to set up fiscal texts for discounts, see [Set up fiscal texts for discounts](setting-up-fiscal-integration-for-retail-channel.md#set-up-fiscal-texts-for-discounts).</span></span>

## <a name="printing-fiscal-x-and-fiscal-z-reports"></a><span data-ttu-id="ea4be-200">Imprimir X y Z informes fiscales</span><span class="sxs-lookup"><span data-stu-id="ea4be-200">Printing fiscal X and fiscal Z reports</span></span>

<span data-ttu-id="ea4be-201">La funcionalidad fiscal de la integración admite la generación de informes de final del día que son específicas para el dispositivo o servicio fiscal integrado:</span><span class="sxs-lookup"><span data-stu-id="ea4be-201">Fiscal integration functionality supports generation of end-of-day statements that are specific to the integrated fiscal device or service:</span></span>

- <span data-ttu-id="ea4be-202">Los nuevos botones que funcionan con las operaciones correspondientes se deben agregar al diseño de pantalla del PDV.</span><span class="sxs-lookup"><span data-stu-id="ea4be-202">New buttons that run corresponding operations should be added to the POS screen layout.</span></span> <span data-ttu-id="ea4be-203">Para obtener más información, consulte [Configurar informes fiscales X/Z de PDV](setting-up-fiscal-integration-for-retail-channel.md#set-up-fiscal-xz-reports-from-the-pos).</span><span class="sxs-lookup"><span data-stu-id="ea4be-203">For more details, see [Set up fiscal X/Z reports from the POS](setting-up-fiscal-integration-for-retail-channel.md#set-up-fiscal-xz-reports-from-the-pos).</span></span>
- <span data-ttu-id="ea4be-204">En el ejemplo fiscal de la integración, estas operaciones deben coincidir a las operaciones correspondientes del dispositivo fiscal.</span><span class="sxs-lookup"><span data-stu-id="ea4be-204">In the fiscal integration sample, these operations should be matched to the corresponding operations of the fiscal device.</span></span>

## <a name="fiscal-integration-samples-in-the-retail-sdk"></a><span data-ttu-id="ea4be-205">Ejemplos fiscales de integración en el SDK al por menor</span><span class="sxs-lookup"><span data-stu-id="ea4be-205">Fiscal integration samples in the Retail SDK</span></span>

<span data-ttu-id="ea4be-206">Los ejemplos siguientes fiscales de integración están disponibles actualmente en el SDK de Retail:</span><span class="sxs-lookup"><span data-stu-id="ea4be-206">The following fiscal integration samples are currently available in the Retail SDK:</span></span>

- [<span data-ttu-id="ea4be-207">Ejemplo de integración de impresora fiscal para Italia</span><span class="sxs-lookup"><span data-stu-id="ea4be-207">Fiscal printer integration sample for Italy</span></span>](emea-ita-fpi-sample.md)
- [<span data-ttu-id="ea4be-208">Ejemplo de integración de impresora fiscal para Polonia</span><span class="sxs-lookup"><span data-stu-id="ea4be-208">Fiscal printer integration sample for Poland</span></span>](emea-pol-fpi-sample.md)
- [<span data-ttu-id="ea4be-209">Ejemplo de integración de servicio de registro para Austria</span><span class="sxs-lookup"><span data-stu-id="ea4be-209">Fiscal registration service integration sample for Austria</span></span>](emea-aut-fi-sample.md)
- [<span data-ttu-id="ea4be-210">Ejemplo de integración de servicio de registro fiscal para la República Checa</span><span class="sxs-lookup"><span data-stu-id="ea4be-210">Fiscal registration service integration sample for Czech Republic</span></span>](emea-cze-fi-sample.md)
- [<span data-ttu-id="ea4be-211">Ejemplo de integración de unidad de control para Suecia</span><span class="sxs-lookup"><span data-stu-id="ea4be-211">Control unit integration sample for Sweden</span></span>](./emea-swe-fi-sample.md)

<span data-ttu-id="ea4be-212">La siguiente funcionalidad fiscal de integración también está disponible en el SDK al por menor pero no se aprovecha actualmente del marco fiscal de integración.</span><span class="sxs-lookup"><span data-stu-id="ea4be-212">The following fiscal integration functionality is also available in the Retail SDK but doesn't currently take advantage of the fiscal integration framework.</span></span> <span data-ttu-id="ea4be-213">La migración de esta funcionalidad fiscal al marco de integración está prevista para actualizaciones posteriores.</span><span class="sxs-lookup"><span data-stu-id="ea4be-213">Migration of this functionality to the fiscal integration framework is planned for later updates.</span></span>


- [<span data-ttu-id="ea4be-214">Firma digital para Francia</span><span class="sxs-lookup"><span data-stu-id="ea4be-214">Digital signature for France</span></span>](emea-fra-cash-registers.md)
- [<span data-ttu-id="ea4be-215">Firma digital para Noruega</span><span class="sxs-lookup"><span data-stu-id="ea4be-215">Digital signature for Norway</span></span>](emea-nor-cash-registers.md)

<span data-ttu-id="ea4be-216">La siguiente funcionalidad de integración fiscal heredada que está disponible en el SDK de Retail no utiliza el marco de integración fiscal y quedará en desuso en actualizaciones posteriores:</span><span class="sxs-lookup"><span data-stu-id="ea4be-216">The following legacy fiscal integration functionality that is available in Retail SDK does not use the fiscal integration framework and will be deprecated in later updates:</span></span>

- [<span data-ttu-id="ea4be-217">Muestra de integración de unidad de control para Suecia (heredada)</span><span class="sxs-lookup"><span data-stu-id="ea4be-217">Control unit integration sample for Sweden (legacy)</span></span>](./retail-sdk-control-unit-sample.md)
