---
title: Comprobador de coherencia de transacción comercial
description: Este tema describe la funcionalidad del comprobador de coherencia de transacción en Dynamics 365 Commerce.
author: josaw1
ms.date: 10/07/2020
ms.topic: index-page
ms.prod: ''
ms.technology: ''
audience: Application User
ms.reviewer: josaw
ms.custom: ''
ms.assetid: ed0f77f7-3609-4330-bebd-ca3134575216
ms.search.region: global
ms.search.industry: Retail
ms.author: josaw
ms.search.validFrom: 2019-01-15
ms.dyn365.ops.version: 10
ms.openlocfilehash: 9a4f03d8cf6696b7e449448704e5360f2ef585b7
ms.sourcegitcommit: 3cdc42346bb653c13ab33a7142dbb7969f1f6dda
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 03/31/2021
ms.locfileid: "5803714"
---
# <a name="retail-transaction-consistency-checker"></a><span data-ttu-id="0e60c-103">Comprobador de coherencia de transacción comercial</span><span class="sxs-lookup"><span data-stu-id="0e60c-103">Retail transaction consistency checker</span></span>

[!include [banner](includes/banner.md)]

<span data-ttu-id="0e60c-104">Este tema describe la funcionalidad del comprobador de coherencia de transacción en Microsoft Dynamics 365 Commerce.</span><span class="sxs-lookup"><span data-stu-id="0e60c-104">This topic describes the transaction consistency checker functionality in Microsoft Dynamics 365 Commerce.</span></span> <span data-ttu-id="0e60c-105">El comprobador de coherencia identifica y aísla transacciones incoherentes antes de que las recoja el proceso de registro de extractos.</span><span class="sxs-lookup"><span data-stu-id="0e60c-105">The consistency checker identifies and isolates inconsistent transactions before they are picked up by the statement posting process.</span></span>

<span data-ttu-id="0e60c-106">Cuando se registra un extracto, el registro puede fallar debido a datos incoherentes en las tablas de transacción de Commerce.</span><span class="sxs-lookup"><span data-stu-id="0e60c-106">When a statement is posted, posting can fail due to inconsistent data in the commerce transaction tables.</span></span> <span data-ttu-id="0e60c-107">El problema de los datos puede deberse a problemas imprevistos en la aplicación de punto de venta (PDV) o si las transacciones se importaron incorrectamente de sistemas PDV de terceros.</span><span class="sxs-lookup"><span data-stu-id="0e60c-107">The data issue may be caused by unforeseen issues in the point of sale (POS) application, or if transactions were incorrectly imported from third-party POS systems.</span></span> <span data-ttu-id="0e60c-108">Entre los ejemplos de cómo estas incoherencias pueden aparecer se incluyen:</span><span class="sxs-lookup"><span data-stu-id="0e60c-108">Examples of how these inconsistencies may appear include:</span></span> 

- <span data-ttu-id="0e60c-109">El total de la transacción en la tabla de encabezado no coincide con el total de la transacción en las líneas.</span><span class="sxs-lookup"><span data-stu-id="0e60c-109">The transaction total on the header table does not match the transaction total on the lines.</span></span>
- <span data-ttu-id="0e60c-110">El recuento de líneas en la tabla de encabezado no coincide con el número de líneas en la tabla de transacción.</span><span class="sxs-lookup"><span data-stu-id="0e60c-110">The line count on the header table does not match with the number of lines in the transaction table.</span></span>
- <span data-ttu-id="0e60c-111">Los impuestos de la tabla de encabezado no coinciden con el importe de impuestos en las líneas.</span><span class="sxs-lookup"><span data-stu-id="0e60c-111">Taxes on the header table do not match the tax amount on the lines.</span></span> 

<span data-ttu-id="0e60c-112">Cuando las transacciones incoherentes son recogidas por el proceso de registro de extractos, se crean facturas de ventas y diarios de pagos incoherentes y, como resultado, el proceso completo de registro de extractos da error.</span><span class="sxs-lookup"><span data-stu-id="0e60c-112">When inconsistent transactions are picked up by the statement posting process, inconsistent sales invoices and payment journals are created, and the entire statement posting process fails as a result.</span></span> <span data-ttu-id="0e60c-113">Recuperar los extractos de ese estado implica correcciones de datos complejos en varias tablas de transacción.</span><span class="sxs-lookup"><span data-stu-id="0e60c-113">Recovering the statements from such a state involves complex data fixes across multiple transaction tables.</span></span> <span data-ttu-id="0e60c-114">El comprobador de coherencia de transacción evita estos problemas.</span><span class="sxs-lookup"><span data-stu-id="0e60c-114">The transaction consistency checker prevents such issues.</span></span>

<span data-ttu-id="0e60c-115">El siguiente gráfico ilustra el proceso de registro con el comprobador de coherencia de transacción.</span><span class="sxs-lookup"><span data-stu-id="0e60c-115">The following chart illustrates the posting process with the transaction consistency checker.</span></span>

<span data-ttu-id="0e60c-116">![Proceso de registro de extractos con comprobador de coherencia para transacciones](./media/validchecker.png "Proceso de registro de extractos con comprobador de coherencia para transacciones comerciales")</span><span class="sxs-lookup"><span data-stu-id="0e60c-116">![Statement posting process with transaction consistency checker](./media/validchecker.png "Statement posting process with retail transaction consistency checker")</span></span>

<span data-ttu-id="0e60c-117">El proceso por lotes **Validar transacciones de la tienda** comprueba la coherencia de las tablas de transacción de Commerce para los siguientes escenarios.</span><span class="sxs-lookup"><span data-stu-id="0e60c-117">The **Validate store transactions** batch process checks the consistency of the commerce transaction tables for the following scenarios.</span></span>

- <span data-ttu-id="0e60c-118">**Cuenta de cliente**: valida que existe la cuenta de cliente en las tablas de transacción en el maestro de clientes de la sede.</span><span class="sxs-lookup"><span data-stu-id="0e60c-118">**Customer account** – Validates that the customer account in the transaction tables exists in the HQ customer master.</span></span>
- <span data-ttu-id="0e60c-119">**Recuento de líneas**: valida que el número de líneas, como se recoge en la tabla de encabezado de transacción, coincide con el número de líneas en las tablas de transacción de ventas.</span><span class="sxs-lookup"><span data-stu-id="0e60c-119">**Line count** – Validates that the number of lines, as captured on the transaction header table, matches the number of lines in the sales transaction tables.</span></span>
- <span data-ttu-id="0e60c-120">**El precio incluye impuestos**: valida que el parámetro **El precio incluye impuestos** sea coherente en todas las líneas de transacción y que el precio de la línea de ventas sea conforme a la configuración de El precio incluye impuestos y de exención de impuestos.</span><span class="sxs-lookup"><span data-stu-id="0e60c-120">**Price includes tax** – Validates that the **Price includes tax** parameter is consistent across transaction lines and the price on the sales line is in accordance with price includes tax and tax exempt configuration.</span></span>
- <span data-ttu-id="0e60c-121">**Importe del pago**: valida que los registros de pago coincidan con el importe del pago del encabezado, a la vez que se factoriza en la configuración de decimales en la contabilidad general.</span><span class="sxs-lookup"><span data-stu-id="0e60c-121">**Payment amount** - Validates that the payment records match the payment amount on the header, while also factoring in the configuration for penny rounding in General Ledger.</span></span>
- <span data-ttu-id="0e60c-122">**Importe bruto**: valida que el importe bruto del encabezado sea la suma de los importes netos de las líneas más el importe del impuesto, a la vez que se factoriza en la configuración del redondeo de decimales en la contabilidad general.</span><span class="sxs-lookup"><span data-stu-id="0e60c-122">**Gross amount** – Validates that the gross amount on the header is the sum of the net amounts on the lines plus the tax amount, while also factoring in the configuration for penny rounding in General Ledger.</span></span>
- <span data-ttu-id="0e60c-123">**Importe bruto**: valida que el importe neto del encabezado sea la suma de los importes netos de las líneas, a la vez que se factoriza en la configuración del redondeo de decimales en la contabilidad general.</span><span class="sxs-lookup"><span data-stu-id="0e60c-123">**Net amount** – Validates that the net amount on the header is the sum of the net amounts on the lines, while also factoring in the configuration for penny rounding in General Ledger.</span></span>
- <span data-ttu-id="0e60c-124">**Sobrepago o pago insuficiente**: valida que la diferencia entre el importe bruto del encabezado y el importe de pago no supera la configuración máxima de sobrepago o pago insuficiente, a la vez que se factoriza en la configuración de decimales en la contabilidad general.</span><span class="sxs-lookup"><span data-stu-id="0e60c-124">**Under / Over payment** – Validates that the difference between the gross amount on the header and the payment amount doesn't exceed the maximum underpayment/overpayment configuration, while also factoring in the configuration for penny rounding in General Ledger.</span></span>
- <span data-ttu-id="0e60c-125">**Importe de descuento**: valida que el importe de descuento de las tablas de descuento y el importe de descuento de las tablas de líneas de transacciones comerciales son coherentes y que el importe de descuento del encabezado es la suma de los importes de descuentos de las líneas, a la vez que se factoriza en la configuración de decimales en la contabilidad general.</span><span class="sxs-lookup"><span data-stu-id="0e60c-125">**Discount amount** – Validates that the discount amount on the discount tables and the discount amount on the transaction line tables are consistent, and that the discount amount on the header is the sum of the discount amounts on the lines, while also factoring in the configuration for penny rounding in General Ledger.</span></span>
- <span data-ttu-id="0e60c-126">**Descuento de línea**: valida que el descuento de línea de la línea de transacción es la suma de todas las líneas de la tabla de descuentos correspondiente a la línea de transacción.</span><span class="sxs-lookup"><span data-stu-id="0e60c-126">**Line discount** – Validates that the line discount on the transaction line is the sum of all the lines in the discount table that corresponds to the transaction line.</span></span>
- <span data-ttu-id="0e60c-127">**Artículo de tarjeta regalo**: Commerce no admite la devolución de artículos de tarjeta regalo.</span><span class="sxs-lookup"><span data-stu-id="0e60c-127">**Gift card item** – Commerce doesn't support the return of gift card items.</span></span> <span data-ttu-id="0e60c-128">Sin embargo, el saldo de una tarjeta regalo se puede cobrar. Cualquier artículo de tarjeta regalo que se procese como línea de devolución en lugar de una línea de cobro en efectivo produce un error en el proceso de registro de extractos.</span><span class="sxs-lookup"><span data-stu-id="0e60c-128">However, the balance on a gift card can be cashed out. Any gift card item that is processed as a return line instead of a cash-out line fails the statement posting process.</span></span> <span data-ttu-id="0e60c-129">El proceso de validación para artículos de tarjeta regalo ayuda a garantizar que los únicos artículos de línea de tarjeta regalo de devolución en las tablas de transacciones son líneas de cobro en efectivo de tarjetas regalo.</span><span class="sxs-lookup"><span data-stu-id="0e60c-129">The validation process for gift card items helps guarantee that the only return gift card line items on the transaction tables are gift card cash-out lines.</span></span>
- <span data-ttu-id="0e60c-130">**Precio negativo**: valida que no hay líneas de transacción de precio negativo.</span><span class="sxs-lookup"><span data-stu-id="0e60c-130">**Negative price** – Validates that there are no negative price transaction lines.</span></span>
- <span data-ttu-id="0e60c-131">**Artículo y variante**: valida que los artículos y variantes de las líneas de transacción existen en el archivo maestro de variante y artículo.</span><span class="sxs-lookup"><span data-stu-id="0e60c-131">**Item & Variant** – Validates that items and variants on the transaction lines exist in the item and variant master file.</span></span>
- <span data-ttu-id="0e60c-132">**Importe de impuestos**: valida que los registros de impuestos coinciden con los importes de impuestos en las líneas.</span><span class="sxs-lookup"><span data-stu-id="0e60c-132">**Tax amount** - Validates that tax records match the tax amounts on the lines.</span></span>
- <span data-ttu-id="0e60c-133">**Número de serie**: comprueba que el número de serie está presente en las líneas de transacción para artículos controlados por el número de serie.</span><span class="sxs-lookup"><span data-stu-id="0e60c-133">**Serial number** - Validates that the serial number is present in the transaction lines for items that are controlled by serial number.</span></span>
- <span data-ttu-id="0e60c-134">**Signo**: comprueba que el signo de la cantidad y el importe neto son los mismos en todas las líneas de transacción.</span><span class="sxs-lookup"><span data-stu-id="0e60c-134">**Sign** - Validates that the sign on the quantity and the net amount are the same in all the transaction lines.</span></span>
- <span data-ttu-id="0e60c-135">**Fecha de negocio**: valida que los períodos financieros para todas las fechas de negocio para las transacciones están abiertos.</span><span class="sxs-lookup"><span data-stu-id="0e60c-135">**Business date** - Validates that the financial periods for all the business dates for the transactions are open.</span></span>
- <span data-ttu-id="0e60c-136">**Cargos**: valida que el importe del cargo de línea y de encabezado es conforme al precio, incluida la configuración de impuestos y de exención de impuestos.</span><span class="sxs-lookup"><span data-stu-id="0e60c-136">**Charges** - Validates that the header and line charge amount is in accordance with price, including tax and tax exempt configuration.</span></span>

## <a name="set-up-the-consistency-checker"></a><span data-ttu-id="0e60c-137">Configurar el comprobador de coherencia</span><span class="sxs-lookup"><span data-stu-id="0e60c-137">Set up the consistency checker</span></span>

<span data-ttu-id="0e60c-138">Configure el proceso por lotes "Validar transacciones de la tienda", en **Retail y Commerce \> TI de Retail y Commerce \> Registro de PDV**, para ejecuciones periódicas.</span><span class="sxs-lookup"><span data-stu-id="0e60c-138">Configure the "Validate store transactions" batch process, at **Retail and Commerce \> Retail and Commerce IT \> POS posting**, for periodic runs.</span></span> <span data-ttu-id="0e60c-139">El trabajo por lotes se puede programar según la jerarquía organizativa de la tienda, similar a cómo se configuran los procesos "Calcular extracto en lote" y "Registrar extracto en lote".</span><span class="sxs-lookup"><span data-stu-id="0e60c-139">The batch job can be scheduled based on store organization hierarchy, similar to how the "Calculate statement in batch" and "Post statement in batch" processes are set up.</span></span> <span data-ttu-id="0e60c-140">Es recomendable que configure este proceso por lotes para ejecutar varias veces en un día y programarlo de modo que se ejecute al final de cada ejecución de trabajo P.</span><span class="sxs-lookup"><span data-stu-id="0e60c-140">We recommend that you configure this batch process to run multiple times in a day and schedule it so that it runs at the end of every P-job execution.</span></span>

## <a name="results-of-validation-process"></a><span data-ttu-id="0e60c-141">Resultados del proceso de validación</span><span class="sxs-lookup"><span data-stu-id="0e60c-141">Results of validation process</span></span>

<span data-ttu-id="0e60c-142">Los resultados de la comprobación de validación por el proceso por lotes se etiquetan en la transacción adecuada.</span><span class="sxs-lookup"><span data-stu-id="0e60c-142">The results of the validation check by the batch process are tagged on the appropriate transaction.</span></span> <span data-ttu-id="0e60c-143">El campo **Estado de validación** en el registro de transacción se establece en **Correcto** o **Error** y la fecha de la última ejecución de validación aparece en el campo **Hora de la última validación**.</span><span class="sxs-lookup"><span data-stu-id="0e60c-143">The **Validation status** field on the transaction record is either set to **Successful** or **Error**, and the date of the last validation run appears on the **Last validation time** field.</span></span>

<span data-ttu-id="0e60c-144">Para ver un texto de error más descriptivo relativo a un error de validación, seleccione el registro de transacción de tienda relevante y haga clic en el botón **Errores de validación**.</span><span class="sxs-lookup"><span data-stu-id="0e60c-144">To view more descriptive error text relating to a validation failure, select the relevant store transaction record and click the **Validation errors** button.</span></span>

<span data-ttu-id="0e60c-145">Las transacciones que producen un error en la comprobación de validación y las transacciones que aún no se han validado no se incluirán en los extractos.</span><span class="sxs-lookup"><span data-stu-id="0e60c-145">Transactions that fail the validation check and transactions that have not yet been validated will not be pulled into statements.</span></span> <span data-ttu-id="0e60c-146">Durante el proceso "Calcule extracto", se notificará a los usuarios si hay transacciones que se habrían podido incluir en el extracto pero no se incluyeron.</span><span class="sxs-lookup"><span data-stu-id="0e60c-146">During the "Calculate statement" process, users will be notified if there are transactions that could have been included in the statement but weren't.</span></span>

<span data-ttu-id="0e60c-147">Si se encuentra un error de validación, la única forma de corregir el error es contactar el Soporte técnico de Microsoft.</span><span class="sxs-lookup"><span data-stu-id="0e60c-147">If a validation error is found, the only way to fix the error is to contact Microsoft Support.</span></span> <span data-ttu-id="0e60c-148">En una versión futura, se agregará una capacidad para que los usuarios puedan corregir los registros que produjeron error a través de la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="0e60c-148">In a future release, capability will be added so that users can fix the records that failed through the user interface.</span></span> <span data-ttu-id="0e60c-149">Las capacidades de registro y auditoría también estarán disponibles para realizar un seguimiento del historial de las modificaciones.</span><span class="sxs-lookup"><span data-stu-id="0e60c-149">Logging and auditing capabilities will also be made available to trace the history of the modifications.</span></span>

> [!NOTE]
> <span data-ttu-id="0e60c-150">En una versión futura se agregarán reglas de validación adicionales para admitir más escenarios.</span><span class="sxs-lookup"><span data-stu-id="0e60c-150">Additional validation rules to support more scenarios will be added in a future release.</span></span>


[!INCLUDE[footer-include](../includes/footer-banner.md)]